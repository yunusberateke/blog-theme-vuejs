{"remainingRequest":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js?{}!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-widget/src/utils.js","dependencies":[{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-widget/src/utils.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoqCiAqIEBsaWNlbnNlIENvcHlyaWdodCAoYykgMjAwMy0yMDIxLCBDS1NvdXJjZSAtIEZyZWRlcmljbyBLbmFiYmVuLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiBGb3IgbGljZW5zaW5nLCBzZWUgTElDRU5TRS5tZCBvciBodHRwczovL2NrZWRpdG9yLmNvbS9sZWdhbC9ja2VkaXRvci1vc3MtbGljZW5zZQogKi8KCi8qKgogKiBAbW9kdWxlIHdpZGdldC91dGlscwogKi8KaW1wb3J0IEJhbGxvb25QYW5lbFZpZXcgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11aS9zcmMvcGFuZWwvYmFsbG9vbi9iYWxsb29ucGFuZWx2aWV3JzsKaW1wb3J0IGdsb2JhbCBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LXV0aWxzL3NyYy9kb20vZ2xvYmFsJzsKaW1wb3J0IFJlY3QgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvZG9tL3JlY3QnOwppbXBvcnQgQ0tFZGl0b3JFcnJvciBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LXV0aWxzL3NyYy9ja2VkaXRvcmVycm9yJzsKaW1wb3J0IHRvQXJyYXkgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvdG9hcnJheSc7CmltcG9ydCBIaWdobGlnaHRTdGFjayBmcm9tICcuL2hpZ2hsaWdodHN0YWNrJzsKaW1wb3J0IHsgZ2V0VHlwZUFyb3VuZEZha2VDYXJldFBvc2l0aW9uIH0gZnJvbSAnLi93aWRnZXR0eXBlYXJvdW5kL3V0aWxzJzsKaW1wb3J0IEljb25WaWV3IGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtdWkvc3JjL2ljb24vaWNvbnZpZXcnOwppbXBvcnQgZHJhZ0hhbmRsZUljb24gZnJvbSAnLi4vdGhlbWUvaWNvbnMvZHJhZy1oYW5kbGUuc3ZnJzsKLyoqCiAqIENTUyBjbGFzcyBhZGRlZCB0byBlYWNoIHdpZGdldCBlbGVtZW50LgogKgogKiBAY29uc3Qge1N0cmluZ30KICovCgpleHBvcnQgdmFyIFdJREdFVF9DTEFTU19OQU1FID0gJ2NrLXdpZGdldCc7Ci8qKgogKiBDU1MgY2xhc3MgYWRkZWQgdG8gY3VycmVudGx5IHNlbGVjdGVkIHdpZGdldCBlbGVtZW50LgogKgogKiBAY29uc3Qge1N0cmluZ30KICovCgpleHBvcnQgdmFyIFdJREdFVF9TRUxFQ1RFRF9DTEFTU19OQU1FID0gJ2NrLXdpZGdldF9zZWxlY3RlZCc7Ci8qKgogKiBSZXR1cm5zIGB0cnVlYCBpZiBnaXZlbiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZX0gaXMgYW4ge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IGFuZCBhIHdpZGdldC4KICoKICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlfSBub2RlCiAqIEByZXR1cm5zIHtCb29sZWFufQogKi8KCmV4cG9ydCBmdW5jdGlvbiBpc1dpZGdldChub2RlKSB7CiAgaWYgKCFub2RlLmlzKCdlbGVtZW50JykpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHJldHVybiAhIW5vZGUuZ2V0Q3VzdG9tUHJvcGVydHkoJ3dpZGdldCcpOwp9Ci8qKgogKiBDb252ZXJ0cyB0aGUgZ2l2ZW4ge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IHRvIGEgd2lkZ2V0IGluIHRoZSBmb2xsb3dpbmcgd2F5OgogKgogKiAqIHNldHMgdGhlIGBjb250ZW50ZWRpdGFibGVgIGF0dHJpYnV0ZSB0byBgImZhbHNlImAsCiAqICogYWRkcyB0aGUgYGNrLXdpZGdldGAgQ1NTIGNsYXNzLAogKiAqIGFkZHMgYSBjdXN0b20ge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnQjZ2V0RmlsbGVyT2Zmc2V0IGBnZXRGaWxsZXJPZmZzZXQoKWB9IG1ldGhvZCByZXR1cm5pbmcgYG51bGxgLAogKiAqIGFkZHMgYSBjdXN0b20gcHJvcGVydHkgYWxsb3dpbmcgdG8gcmVjb2duaXplIHdpZGdldCBlbGVtZW50cyBieSB1c2luZyB7QGxpbmsgfmlzV2lkZ2V0IGBpc1dpZGdldCgpYH0sCiAqICogaW1wbGVtZW50cyB0aGUge0BsaW5rIH5zZXRIaWdobGlnaHRIYW5kbGluZyB2aWV3IGhpZ2hsaWdodCBvbiB3aWRnZXRzfS4KICoKICogVGhpcyBmdW5jdGlvbiBuZWVkcyB0byBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGgKICoge0BsaW5rIG1vZHVsZTplbmdpbmUvY29udmVyc2lvbi9kb3duY2FzdGhlbHBlcnN+RG93bmNhc3RIZWxwZXJzIGRvd25jYXN0IGNvbnZlcnNpb24gaGVscGVyc30KICogbGlrZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS9jb252ZXJzaW9uL2Rvd25jYXN0aGVscGVyc35Eb3duY2FzdEhlbHBlcnMjZWxlbWVudFRvRWxlbWVudCBgZWxlbWVudFRvRWxlbWVudCgpYH0uCiAqIE1vcmVvdmVyLCB0eXBpY2FsbHkgeW91IHdpbGwgd2FudCB0byB1c2UgYHRvV2lkZ2V0KClgIG9ubHkgZm9yIGBlZGl0aW5nRG93bmNhc3RgLCB3aGlsZSBrZWVwaW5nIHRoZSBgZGF0YURvd25jYXN0YCBjbGVhbi4KICoKICogRm9yIGV4YW1wbGUsIGluIG9yZGVyIHRvIGNvbnZlcnQgYSBgPHdpZGdldD5gIG1vZGVsIGVsZW1lbnQgdG8gYDxkaXYgY2xhc3M9IndpZGdldCI+YCBpbiB0aGUgdmlldywgeW91IGNhbiBkZWZpbmUKICogc3VjaCBjb252ZXJ0ZXJzOgogKgogKgkJZWRpdG9yLmNvbnZlcnNpb24uZm9yKCAnZWRpdGluZ0Rvd25jYXN0JyApCiAqCQkJLmVsZW1lbnRUb0VsZW1lbnQoIHsKICoJCQkJbW9kZWw6ICd3aWRnZXQnLAogKgkJCQl2aWV3OiAoIG1vZGVsSXRlbSwgeyB3cml0ZXIgfSApID0+IHsKICoJCQkJCWNvbnN0IGRpdiA9IHdyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KCAnZGl2JywgeyBjbGFzczogJ3dpZGdldCcgfSApOwogKgogKgkJCQkJcmV0dXJuIHRvV2lkZ2V0KCBkaXYsIHdyaXRlciwgeyBsYWJlbDogJ3NvbWUgd2lkZ2V0JyB9ICk7CiAqCQkJCX0KICoJCQl9ICk7CiAqCiAqCQllZGl0b3IuY29udmVyc2lvbi5mb3IoICdkYXRhRG93bmNhc3QnICkKICoJCQkuZWxlbWVudFRvRWxlbWVudCggewogKgkJCQltb2RlbDogJ3dpZGdldCcsCiAqCQkJCXZpZXc6ICggbW9kZWxJdGVtLCB7IHdyaXRlciB9ICkgPT4gewogKgkJCQkJcmV0dXJuIHdyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KCAnZGl2JywgeyBjbGFzczogJ3dpZGdldCcgfSApOwogKgkJCQl9CiAqCQkJfSApOwogKgogKiBTZWUgdGhlIGZ1bGwgc291cmNlIGNvZGUgb2YgdGhlIHdpZGdldCAod2l0aCBhIG5lc3RlZCBlZGl0YWJsZSkgc2NoZW1hIGRlZmluaXRpb24gYW5kIGNvbnZlcnRlcnMgaW4KICogW3RoaXMgc2FtcGxlXShodHRwczovL2dpdGh1Yi5jb20vY2tlZGl0b3IvY2tlZGl0b3I1LXdpZGdldC9ibG9iL21hc3Rlci90ZXN0cy9tYW51YWwvd2lkZ2V0LXdpdGgtbmVzdGVkZWRpdGFibGUuanMpLgogKgogKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IGVsZW1lbnQKICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXJ9IHdyaXRlcgogKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnM9e31dCiAqIEBwYXJhbSB7U3RyaW5nfEZ1bmN0aW9ufSBbb3B0aW9ucy5sYWJlbF0gRWxlbWVudCdzIGxhYmVsIHByb3ZpZGVkIHRvIHRoZSB7QGxpbmsgfnNldExhYmVsfSBmdW5jdGlvbi4gSXQgY2FuIGJlIHBhc3NlZCBhcwogKiBhIHBsYWluIHN0cmluZyBvciBhIGZ1bmN0aW9uIHJldHVybmluZyBhIHN0cmluZy4gSXQgcmVwcmVzZW50cyB0aGUgd2lkZ2V0IGZvciBhc3Npc3RpdmUgdGVjaG5vbG9naWVzIChsaWtlIHNjcmVlbiByZWFkZXJzKS4KICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5oYXNTZWxlY3Rpb25IYW5kbGU9ZmFsc2VdIElmIGB0cnVlYCwgdGhlIHdpZGdldCB3aWxsIGhhdmUgYSBzZWxlY3Rpb24gaGFuZGxlIGFkZGVkLgogKiBAcmV0dXJucyB7bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudH0gUmV0dXJucyB0aGUgc2FtZSBlbGVtZW50LgogKi8KCmV4cG9ydCBmdW5jdGlvbiB0b1dpZGdldChlbGVtZW50LCB3cml0ZXIpIHsKICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307CgogIGlmICghZWxlbWVudC5pcygnY29udGFpbmVyRWxlbWVudCcpKSB7CiAgICAvKioKICAgICAqIFRoZSBlbGVtZW50IHBhc3NlZCB0byBgdG9XaWRnZXQoKWAgbXVzdCBiZSBhIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvY29udGFpbmVyZWxlbWVudH5Db250YWluZXJFbGVtZW50fQogICAgICogaW5zdGFuY2UuCiAgICAgKgogICAgICogQGVycm9yIHdpZGdldC10by13aWRnZXQtd3JvbmctZWxlbWVudC10eXBlCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZWxlbWVudCBUaGUgdmlldyBlbGVtZW50IHBhc3NlZCB0byBgdG9XaWRnZXQoKWAuCiAgICAgKi8KICAgIHRocm93IG5ldyBDS0VkaXRvckVycm9yKCd3aWRnZXQtdG8td2lkZ2V0LXdyb25nLWVsZW1lbnQtdHlwZScsIG51bGwsIHsKICAgICAgZWxlbWVudDogZWxlbWVudAogICAgfSk7CiAgfQoKICB3cml0ZXIuc2V0QXR0cmlidXRlKCdjb250ZW50ZWRpdGFibGUnLCAnZmFsc2UnLCBlbGVtZW50KTsKICB3cml0ZXIuYWRkQ2xhc3MoV0lER0VUX0NMQVNTX05BTUUsIGVsZW1lbnQpOwogIHdyaXRlci5zZXRDdXN0b21Qcm9wZXJ0eSgnd2lkZ2V0JywgdHJ1ZSwgZWxlbWVudCk7CiAgZWxlbWVudC5nZXRGaWxsZXJPZmZzZXQgPSBnZXRGaWxsZXJPZmZzZXQ7CgogIGlmIChvcHRpb25zLmxhYmVsKSB7CiAgICBzZXRMYWJlbChlbGVtZW50LCBvcHRpb25zLmxhYmVsLCB3cml0ZXIpOwogIH0KCiAgaWYgKG9wdGlvbnMuaGFzU2VsZWN0aW9uSGFuZGxlKSB7CiAgICBhZGRTZWxlY3Rpb25IYW5kbGUoZWxlbWVudCwgd3JpdGVyKTsKICB9CgogIHNldEhpZ2hsaWdodEhhbmRsaW5nKGVsZW1lbnQsIHdyaXRlciwgYWRkSGlnaGxpZ2h0LCByZW1vdmVIaWdobGlnaHQpOwogIHJldHVybiBlbGVtZW50Owp9IC8vIERlZmF1bHQgaGFuZGxlciBmb3IgYWRkaW5nIGEgaGlnaGxpZ2h0IG9uIGEgd2lkZ2V0LgovLyBJdCBhZGRzIENTUyBjbGFzcyBhbmQgYXR0cmlidXRlcyBiYXNpbmcgb24gdGhlIGdpdmVuIGhpZ2hsaWdodCBkZXNjcmlwdG9yLgovLwovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IGVsZW1lbnQKLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL2NvbnZlcnNpb24vZG93bmNhc3RoZWxwZXJzfkhpZ2hsaWdodERlc2NyaXB0b3J9IGRlc2NyaXB0b3IKLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXJ9IHdyaXRlcgoKZnVuY3Rpb24gYWRkSGlnaGxpZ2h0KGVsZW1lbnQsIGRlc2NyaXB0b3IsIHdyaXRlcikgewogIGlmIChkZXNjcmlwdG9yLmNsYXNzZXMpIHsKICAgIHdyaXRlci5hZGRDbGFzcyh0b0FycmF5KGRlc2NyaXB0b3IuY2xhc3NlcyksIGVsZW1lbnQpOwogIH0KCiAgaWYgKGRlc2NyaXB0b3IuYXR0cmlidXRlcykgewogICAgZm9yICh2YXIga2V5IGluIGRlc2NyaXB0b3IuYXR0cmlidXRlcykgewogICAgICB3cml0ZXIuc2V0QXR0cmlidXRlKGtleSwgZGVzY3JpcHRvci5hdHRyaWJ1dGVzW2tleV0sIGVsZW1lbnQpOwogICAgfQogIH0KfSAvLyBEZWZhdWx0IGhhbmRsZXIgZm9yIHJlbW92aW5nIGEgaGlnaGxpZ2h0IGZyb20gYSB3aWRnZXQuCi8vIEl0IHJlbW92ZXMgQ1NTIGNsYXNzIGFuZCBhdHRyaWJ1dGVzIGJhc2luZyBvbiB0aGUgZ2l2ZW4gaGlnaGxpZ2h0IGRlc2NyaXB0b3IuCi8vCi8vIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudH0gZWxlbWVudAovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvY29udmVyc2lvbi9kb3duY2FzdGhlbHBlcnN+SGlnaGxpZ2h0RGVzY3JpcHRvcn0gZGVzY3JpcHRvcgovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlcn0gd3JpdGVyCgoKZnVuY3Rpb24gcmVtb3ZlSGlnaGxpZ2h0KGVsZW1lbnQsIGRlc2NyaXB0b3IsIHdyaXRlcikgewogIGlmIChkZXNjcmlwdG9yLmNsYXNzZXMpIHsKICAgIHdyaXRlci5yZW1vdmVDbGFzcyh0b0FycmF5KGRlc2NyaXB0b3IuY2xhc3NlcyksIGVsZW1lbnQpOwogIH0KCiAgaWYgKGRlc2NyaXB0b3IuYXR0cmlidXRlcykgewogICAgZm9yICh2YXIga2V5IGluIGRlc2NyaXB0b3IuYXR0cmlidXRlcykgewogICAgICB3cml0ZXIucmVtb3ZlQXR0cmlidXRlKGtleSwgZWxlbWVudCk7CiAgICB9CiAgfQp9Ci8qKgogKiBTZXRzIGhpZ2hsaWdodCBoYW5kbGluZyBtZXRob2RzLiBVc2VzIHtAbGluayBtb2R1bGU6d2lkZ2V0L2hpZ2hsaWdodHN0YWNrfkhpZ2hsaWdodFN0YWNrfSB0bwogKiBwcm9wZXJseSBkZXRlcm1pbmUgd2hpY2ggaGlnaGxpZ2h0IGRlc2NyaXB0b3Igc2hvdWxkIGJlIHVzZWQgYXQgZ2l2ZW4gdGltZS4KICoKICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50fSBlbGVtZW50CiAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyfSB3cml0ZXIKICogQHBhcmFtIHtGdW5jdGlvbn0gYWRkCiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlbW92ZQogKi8KCgpleHBvcnQgZnVuY3Rpb24gc2V0SGlnaGxpZ2h0SGFuZGxpbmcoZWxlbWVudCwgd3JpdGVyLCBhZGQsIHJlbW92ZSkgewogIHZhciBzdGFjayA9IG5ldyBIaWdobGlnaHRTdGFjaygpOwogIHN0YWNrLm9uKCdjaGFuZ2U6dG9wJywgZnVuY3Rpb24gKGV2dCwgZGF0YSkgewogICAgaWYgKGRhdGEub2xkRGVzY3JpcHRvcikgewogICAgICByZW1vdmUoZWxlbWVudCwgZGF0YS5vbGREZXNjcmlwdG9yLCBkYXRhLndyaXRlcik7CiAgICB9CgogICAgaWYgKGRhdGEubmV3RGVzY3JpcHRvcikgewogICAgICBhZGQoZWxlbWVudCwgZGF0YS5uZXdEZXNjcmlwdG9yLCBkYXRhLndyaXRlcik7CiAgICB9CiAgfSk7CiAgd3JpdGVyLnNldEN1c3RvbVByb3BlcnR5KCdhZGRIaWdobGlnaHQnLCBmdW5jdGlvbiAoZWxlbWVudCwgZGVzY3JpcHRvciwgd3JpdGVyKSB7CiAgICByZXR1cm4gc3RhY2suYWRkKGRlc2NyaXB0b3IsIHdyaXRlcik7CiAgfSwgZWxlbWVudCk7CiAgd3JpdGVyLnNldEN1c3RvbVByb3BlcnR5KCdyZW1vdmVIaWdobGlnaHQnLCBmdW5jdGlvbiAoZWxlbWVudCwgaWQsIHdyaXRlcikgewogICAgcmV0dXJuIHN0YWNrLnJlbW92ZShpZCwgd3JpdGVyKTsKICB9LCBlbGVtZW50KTsKfQovKioKICogU2V0cyBsYWJlbCBmb3IgZ2l2ZW4gZWxlbWVudC4KICogSXQgY2FuIGJlIHBhc3NlZCBhcyBhIHBsYWluIHN0cmluZyBvciBhIGZ1bmN0aW9uIHJldHVybmluZyBhIHN0cmluZy4gRnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgZWFjaCB0aW1lIGxhYmVsIGlzIHJldHJpZXZlZCBieQogKiB7QGxpbmsgfmdldExhYmVsIGBnZXRMYWJlbCgpYH0uCiAqCiAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudH0gZWxlbWVudAogKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gbGFiZWxPckNyZWF0b3IKICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXJ9IHdyaXRlcgogKi8KCmV4cG9ydCBmdW5jdGlvbiBzZXRMYWJlbChlbGVtZW50LCBsYWJlbE9yQ3JlYXRvciwgd3JpdGVyKSB7CiAgd3JpdGVyLnNldEN1c3RvbVByb3BlcnR5KCd3aWRnZXRMYWJlbCcsIGxhYmVsT3JDcmVhdG9yLCBlbGVtZW50KTsKfQovKioKICogUmV0dXJucyB0aGUgbGFiZWwgb2YgdGhlIHByb3ZpZGVkIGVsZW1lbnQuCiAqCiAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudH0gZWxlbWVudAogKiBAcmV0dXJucyB7U3RyaW5nfQogKi8KCmV4cG9ydCBmdW5jdGlvbiBnZXRMYWJlbChlbGVtZW50KSB7CiAgdmFyIGxhYmVsQ3JlYXRvciA9IGVsZW1lbnQuZ2V0Q3VzdG9tUHJvcGVydHkoJ3dpZGdldExhYmVsJyk7CgogIGlmICghbGFiZWxDcmVhdG9yKSB7CiAgICByZXR1cm4gJyc7CiAgfQoKICByZXR1cm4gdHlwZW9mIGxhYmVsQ3JlYXRvciA9PSAnZnVuY3Rpb24nID8gbGFiZWxDcmVhdG9yKCkgOiBsYWJlbENyZWF0b3I7Cn0KLyoqCiAqIEFkZHMgZnVuY3Rpb25hbGl0eSB0byB0aGUgcHJvdmlkZWQge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9lZGl0YWJsZWVsZW1lbnR+RWRpdGFibGVFbGVtZW50fSB0byBhY3QgYXMgYSB3aWRnZXQncyBlZGl0YWJsZToKICoKICogKiBzZXRzIHRoZSBgY29udGVudGVkaXRhYmxlYCBhdHRyaWJ1dGUgdG8gYHRydWVgIHdoZW4ge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9lZGl0YWJsZWVsZW1lbnR+RWRpdGFibGVFbGVtZW50I2lzUmVhZE9ubHl9IGlzIGBmYWxzZWAsCiAqIG90aGVyd2lzZSBzZXRzIGl0IHRvIGBmYWxzZWAsCiAqICogYWRkcyB0aGUgYGNrLWVkaXRvcl9fZWRpdGFibGVgIGFuZCBgY2stZWRpdG9yX19uZXN0ZWQtZWRpdGFibGVgIENTUyBjbGFzc2VzLAogKiAqIGFkZHMgdGhlIGBjay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZV9mb2N1c2VkYCBDU1MgY2xhc3Mgd2hlbiB0aGUgZWRpdGFibGUgaXMgZm9jdXNlZCBhbmQgcmVtb3ZlcyBpdCB3aGVuIGl0IGlzIGJsdXJyZWQuCiAqCiAqIFNpbWlsYXJseSB0byB7QGxpbmsgfnRvV2lkZ2V0IGB0b1dpZGdldCgpYH0gdGhpcyBmdW5jdGlvbiBzaG91bGQgYmUgdXNlZCBpbiBgZWRpdGluZ0Rvd25jYXN0YCBvbmx5IGFuZCBpdCBpcyB1c3VhbGx5CiAqIHVzZWQgdG9nZXRoZXIgd2l0aCB7QGxpbmsgbW9kdWxlOmVuZ2luZS9jb252ZXJzaW9uL2Rvd25jYXN0aGVscGVyc35Eb3duY2FzdEhlbHBlcnMjZWxlbWVudFRvRWxlbWVudCBgZWxlbWVudFRvRWxlbWVudCgpYH0uCiAqCiAqIEZvciBleGFtcGxlLCBpbiBvcmRlciB0byBjb252ZXJ0IGEgYDxuZXN0ZWQ+YCBtb2RlbCBlbGVtZW50IHRvIGA8ZGl2IGNsYXNzPSJuZXN0ZWQiPmAgaW4gdGhlIHZpZXcsIHlvdSBjYW4gZGVmaW5lCiAqIHN1Y2ggY29udmVydGVyczoKICoKICoJCWVkaXRvci5jb252ZXJzaW9uLmZvciggJ2VkaXRpbmdEb3duY2FzdCcgKQogKgkJCS5lbGVtZW50VG9FbGVtZW50KCB7CiAqCQkJCW1vZGVsOiAnbmVzdGVkJywKICoJCQkJdmlldzogKCBtb2RlbEl0ZW0sIHsgd3JpdGVyIH0gKSA9PiB7CiAqCQkJCQljb25zdCBkaXYgPSB3cml0ZXIuY3JlYXRlRWRpdGFibGVFbGVtZW50KCAnZGl2JywgeyBjbGFzczogJ25lc3RlZCcgfSApOwogKgogKgkJCQkJcmV0dXJuIHRvV2lkZ2V0RWRpdGFibGUoIG5lc3RlZCwgd3JpdGVyICk7CiAqCQkJCX0KICoJCQl9ICk7CiAqCiAqCQllZGl0b3IuY29udmVyc2lvbi5mb3IoICdkYXRhRG93bmNhc3QnICkKICoJCQkuZWxlbWVudFRvRWxlbWVudCggewogKgkJCQltb2RlbDogJ25lc3RlZCcsCiAqCQkJCXZpZXc6ICggbW9kZWxJdGVtLCB7IHdyaXRlciB9ICkgPT4gewogKgkJCQkJcmV0dXJuIHdyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KCAnZGl2JywgeyBjbGFzczogJ25lc3RlZCcgfSApOwogKgkJCQl9CiAqCQkJfSApOwogKgogKiBTZWUgdGhlIGZ1bGwgc291cmNlIGNvZGUgb2YgdGhlIHdpZGdldCAod2l0aCBuZXN0ZWQgZWRpdGFibGUpIHNjaGVtYSBkZWZpbml0aW9uIGFuZCBjb252ZXJ0ZXJzIGluCiAqIFt0aGlzIHNhbXBsZV0oaHR0cHM6Ly9naXRodWIuY29tL2NrZWRpdG9yL2NrZWRpdG9yNS13aWRnZXQvYmxvYi9tYXN0ZXIvdGVzdHMvbWFudWFsL3dpZGdldC13aXRoLW5lc3RlZGVkaXRhYmxlLmpzKS4KICoKICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvZWRpdGFibGVlbGVtZW50fkVkaXRhYmxlRWxlbWVudH0gZWRpdGFibGUKICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXJ9IHdyaXRlcgogKiBAcmV0dXJucyB7bW9kdWxlOmVuZ2luZS92aWV3L2VkaXRhYmxlZWxlbWVudH5FZGl0YWJsZUVsZW1lbnR9IFJldHVybnMgdGhlIHNhbWUgZWxlbWVudCB0aGF0IHdhcyBwcm92aWRlZCBpbiB0aGUgYGVkaXRhYmxlYCBwYXJhbWV0ZXIKICovCgpleHBvcnQgZnVuY3Rpb24gdG9XaWRnZXRFZGl0YWJsZShlZGl0YWJsZSwgd3JpdGVyKSB7CiAgd3JpdGVyLmFkZENsYXNzKFsnY2stZWRpdG9yX19lZGl0YWJsZScsICdjay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZSddLCBlZGl0YWJsZSk7IC8vIFNldCBpbml0aWFsIGNvbnRlbnRlZGl0YWJsZSB2YWx1ZS4KCiAgd3JpdGVyLnNldEF0dHJpYnV0ZSgnY29udGVudGVkaXRhYmxlJywgZWRpdGFibGUuaXNSZWFkT25seSA/ICdmYWxzZScgOiAndHJ1ZScsIGVkaXRhYmxlKTsgLy8gQmluZCB0aGUgY29udGVudGVkaXRhYmxlIHByb3BlcnR5IHRvIGVsZW1lbnQjaXNSZWFkT25seS4KCiAgZWRpdGFibGUub24oJ2NoYW5nZTppc1JlYWRPbmx5JywgZnVuY3Rpb24gKGV2dCwgcHJvcGVydHksIGlzKSB7CiAgICB3cml0ZXIuc2V0QXR0cmlidXRlKCdjb250ZW50ZWRpdGFibGUnLCBpcyA/ICdmYWxzZScgOiAndHJ1ZScsIGVkaXRhYmxlKTsKICB9KTsKICBlZGl0YWJsZS5vbignY2hhbmdlOmlzRm9jdXNlZCcsIGZ1bmN0aW9uIChldnQsIHByb3BlcnR5LCBpcykgewogICAgaWYgKGlzKSB7CiAgICAgIHdyaXRlci5hZGRDbGFzcygnY2stZWRpdG9yX19uZXN0ZWQtZWRpdGFibGVfZm9jdXNlZCcsIGVkaXRhYmxlKTsKICAgIH0gZWxzZSB7CiAgICAgIHdyaXRlci5yZW1vdmVDbGFzcygnY2stZWRpdG9yX19uZXN0ZWQtZWRpdGFibGVfZm9jdXNlZCcsIGVkaXRhYmxlKTsKICAgIH0KICB9KTsKICByZXR1cm4gZWRpdGFibGU7Cn0KLyoqCiAqIFJldHVybnMgYSBtb2RlbCBwb3NpdGlvbiB3aGljaCBpcyBvcHRpbWFsIChpbiB0ZXJtcyBvZiBVWCkgZm9yIGluc2VydGluZyBhIHdpZGdldCBibG9jay4KICoKICogRm9yIGluc3RhbmNlLCBpZiBhIHNlbGVjdGlvbiBpcyBpbiB0aGUgbWlkZGxlIG9mIGEgcGFyYWdyYXBoLCB0aGUgcG9zaXRpb24gYmVmb3JlIHRoaXMgcGFyYWdyYXBoCiAqIHdpbGwgYmUgcmV0dXJuZWQgc28gdGhhdCBpdCBpcyBub3Qgc3BsaXQuIElmIHRoZSBzZWxlY3Rpb24gaXMgYXQgdGhlIGVuZCBvZiBhIHBhcmFncmFwaCwKICogdGhlIHBvc2l0aW9uIGFmdGVyIHRoaXMgcGFyYWdyYXBoIHdpbGwgYmUgcmV0dXJuZWQuCiAqCiAqIE5vdGU6IElmIHRoZSBzZWxlY3Rpb24gaXMgcGxhY2VkIGluIGFuIGVtcHR5IGJsb2NrLCB0aGF0IGJsb2NrIHdpbGwgYmUgcmV0dXJuZWQuIElmIHRoYXQgcG9zaXRpb24KICogaXMgdGhlbiBwYXNzZWQgdG8ge0BsaW5rIG1vZHVsZTplbmdpbmUvbW9kZWwvbW9kZWx+TW9kZWwjaW5zZXJ0Q29udGVudH0sCiAqIHRoZSBibG9jayB3aWxsIGJlIGZ1bGx5IHJlcGxhY2VkIGJ5IHRoZSBpbWFnZS4KICoKICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL3NlbGVjdGlvbn5TZWxlY3Rpb258bW9kdWxlOmVuZ2luZS9tb2RlbC9kb2N1bWVudHNlbGVjdGlvbn5Eb2N1bWVudFNlbGVjdGlvbn0gc2VsZWN0aW9uCiAqIFRoZSBzZWxlY3Rpb24gYmFzZWQgb24gd2hpY2ggdGhlIGluc2VydGlvbiBwb3NpdGlvbiBzaG91bGQgYmUgY2FsY3VsYXRlZC4KICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL21vZGVsfk1vZGVsfSBtb2RlbCBNb2RlbCBpbnN0YW5jZS4KICogQHJldHVybnMge21vZHVsZTplbmdpbmUvbW9kZWwvcG9zaXRpb25+UG9zaXRpb259IFRoZSBvcHRpbWFsIHBvc2l0aW9uLgogKi8KCmV4cG9ydCBmdW5jdGlvbiBmaW5kT3B0aW1hbEluc2VydGlvblBvc2l0aW9uKHNlbGVjdGlvbiwgbW9kZWwpIHsKICB2YXIgc2VsZWN0ZWRFbGVtZW50ID0gc2VsZWN0aW9uLmdldFNlbGVjdGVkRWxlbWVudCgpOwoKICBpZiAoc2VsZWN0ZWRFbGVtZW50KSB7CiAgICB2YXIgdHlwZUFyb3VuZEZha2VDYXJldFBvc2l0aW9uID0gZ2V0VHlwZUFyb3VuZEZha2VDYXJldFBvc2l0aW9uKHNlbGVjdGlvbik7IC8vIElmIHRoZSBXaWRnZXRUeXBlQXJvdW5kICJmYWtlIGNhcmV0IiBpcyBkaXNwbGF5ZWQsIHVzZSBpdHMgcG9zaXRpb24gZm9yIHRoZSBpbnNlcnRpb24KICAgIC8vIHRvIHByb3ZpZGUgdGhlIG1vc3QgcHJlZGljdGFibGUgVVggKGh0dHBzOi8vZ2l0aHViLmNvbS9ja2VkaXRvci9ja2VkaXRvcjUvaXNzdWVzLzc0MzgpLgoKICAgIGlmICh0eXBlQXJvdW5kRmFrZUNhcmV0UG9zaXRpb24pIHsKICAgICAgcmV0dXJuIG1vZGVsLmNyZWF0ZVBvc2l0aW9uQXQoc2VsZWN0ZWRFbGVtZW50LCB0eXBlQXJvdW5kRmFrZUNhcmV0UG9zaXRpb24pOwogICAgfQoKICAgIGlmIChtb2RlbC5zY2hlbWEuaXNCbG9jayhzZWxlY3RlZEVsZW1lbnQpKSB7CiAgICAgIHJldHVybiBtb2RlbC5jcmVhdGVQb3NpdGlvbkFmdGVyKHNlbGVjdGVkRWxlbWVudCk7CiAgICB9CiAgfQoKICB2YXIgZmlyc3RCbG9jayA9IHNlbGVjdGlvbi5nZXRTZWxlY3RlZEJsb2NrcygpLm5leHQoKS52YWx1ZTsKCiAgaWYgKGZpcnN0QmxvY2spIHsKICAgIC8vIElmIGluc2VydGluZyBpbnRvIGFuIGVtcHR5IGJsb2NrIOKAkyByZXR1cm4gcG9zaXRpb24gaW4gdGhhdCBibG9jay4gSXQgd2lsbCBnZXQKICAgIC8vIHJlcGxhY2VkIHdpdGggdGhlIGltYWdlIGJ5IGluc2VydENvbnRlbnQoKS4gIzQyLgogICAgaWYgKGZpcnN0QmxvY2suaXNFbXB0eSkgewogICAgICByZXR1cm4gbW9kZWwuY3JlYXRlUG9zaXRpb25BdChmaXJzdEJsb2NrLCAwKTsKICAgIH0KCiAgICB2YXIgcG9zaXRpb25BZnRlciA9IG1vZGVsLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIoZmlyc3RCbG9jayk7IC8vIElmIHNlbGVjdGlvbiBpcyBhdCB0aGUgZW5kIG9mIHRoZSBibG9jayAtIHJldHVybiBwb3NpdGlvbiBhZnRlciB0aGUgYmxvY2suCgogICAgaWYgKHNlbGVjdGlvbi5mb2N1cy5pc1RvdWNoaW5nKHBvc2l0aW9uQWZ0ZXIpKSB7CiAgICAgIHJldHVybiBwb3NpdGlvbkFmdGVyOwogICAgfSAvLyBPdGhlcndpc2UgcmV0dXJuIHBvc2l0aW9uIGJlZm9yZSB0aGUgYmxvY2suCgoKICAgIHJldHVybiBtb2RlbC5jcmVhdGVQb3NpdGlvbkJlZm9yZShmaXJzdEJsb2NrKTsKICB9CgogIHJldHVybiBzZWxlY3Rpb24uZm9jdXM7Cn0KLyoqCiAqIENoZWNrcyBpZiB0aGUgc2VsZWN0aW9uIGlzIG9uIGFuIG9iamVjdC4KICoKICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL3NlbGVjdGlvbn5TZWxlY3Rpb258bW9kdWxlOmVuZ2luZS9tb2RlbC9kb2N1bWVudHNlbGVjdGlvbn5Eb2N1bWVudFNlbGVjdGlvbn0gc2VsZWN0aW9uCiAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS9tb2RlbC9zY2hlbWF+U2NoZW1hfSBzY2hlbWEKICogQHJldHVybnMge0Jvb2xlYW59CiovCgpleHBvcnQgZnVuY3Rpb24gY2hlY2tTZWxlY3Rpb25Pbk9iamVjdChzZWxlY3Rpb24sIHNjaGVtYSkgewogIHZhciBzZWxlY3RlZEVsZW1lbnQgPSBzZWxlY3Rpb24uZ2V0U2VsZWN0ZWRFbGVtZW50KCk7CiAgcmV0dXJuICEhc2VsZWN0ZWRFbGVtZW50ICYmIHNjaGVtYS5pc09iamVjdChzZWxlY3RlZEVsZW1lbnQpOwp9Ci8qKgogKiBBIHV0aWwgdG8gYmUgdXNlZCBpbiBvcmRlciB0byBtYXAgdmlldyBwb3NpdGlvbnMgdG8gY29ycmVjdCBtb2RlbCBwb3NpdGlvbnMgd2hlbiBpbXBsZW1lbnRpbmcgYSB3aWRnZXQKICogd2hpY2ggcmVuZGVycyBub24tZW1wdHkgdmlldyBlbGVtZW50IGZvciBhbiBlbXB0eSBtb2RlbCBlbGVtZW50LgogKgogKiBGb3IgZXhhbXBsZToKICoKICoJCS8vIE1vZGVsOgogKgkJPHBsYWNlaG9sZGVyIHR5cGU9Im5hbWUiPjwvcGxhY2Vob2xkZXI+CiAqCiAqCQkvLyBWaWV3OgogKgkJPHNwYW4gY2xhc3M9InBsYWNlaG9sZGVyIj5uYW1lPC9zcGFuPgogKgogKiBJbiBzdWNoIGNhc2UsIHZpZXcgcG9zaXRpb25zIGluc2lkZSBgPHNwYW4+YCBjYW5ub3QgYmUgY29ycmVjdCBtYXBwZWQgdG8gdGhlIG1vZGVsIChiZWNhdXNlIHRoZSBtb2RlbCBlbGVtZW50IGlzIGVtcHR5KS4KICogVG8gaGFuZGxlIG1hcHBpbmcgcG9zaXRpb25zIGluc2lkZSBgPHNwYW4gY2xhc3M9InBsYWNlaG9sZGVyIj5gIHRvIHRoZSBtb2RlbCB1c2UgdGhpcyB1dGlsIGFzIGZvbGxvd3M6CiAqCiAqCQllZGl0b3IuZWRpdGluZy5tYXBwZXIub24oCiAqCQkJJ3ZpZXdUb01vZGVsUG9zaXRpb24nLAogKgkJCXZpZXdUb01vZGVsUG9zaXRpb25PdXRzaWRlTW9kZWxFbGVtZW50KCBtb2RlbCwgdmlld0VsZW1lbnQgPT4gdmlld0VsZW1lbnQuaGFzQ2xhc3MoICdwbGFjZWhvbGRlcicgKSApCiAqCQkpOwogKgogKiBUaGUgY2FsbGJhY2sgd2lsbCB0cnkgdG8gbWFwIHRoZSB2aWV3IG9mZnNldCBvZiBzZWxlY3Rpb24gdG8gYW4gZXhwZWN0ZWQgbW9kZWwgcG9zaXRpb24uCiAqCiAqIDEuIFdoZW4gdGhlIHBvc2l0aW9uIGlzIGF0IHRoZSBlbmQgKG9yIGluIHRoZSBtaWRkbGUpIG9mIHRoZSBpbmxpbmUgd2lkZ2V0OgogKgogKgkJLy8gVmlldzoKICoJCTxwPmZvbyA8c3BhbiBjbGFzcz0icGxhY2Vob2xkZXIiPm5hbWV8PC9zcGFuPiBiYXI8L3A+CiAqCiAqCQkvLyBNb2RlbDoKICoJCTxwYXJhZ3JhcGg+Zm9vIDxwbGFjZWhvbGRlciB0eXBlPSJuYW1lIj48L3BsYWNlaG9sZGVyPnwgYmFyPC9wYXJhZ3JhcGg+CiAqCiAqIDIuIFdoZW4gdGhlIHBvc2l0aW9uIGlzIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGlubGluZSB3aWRnZXQ6CiAqCiAqCQkvLyBWaWV3OgogKgkJPHA+Zm9vIDxzcGFuIGNsYXNzPSJwbGFjZWhvbGRlciI+fG5hbWU8L3NwYW4+IGJhcjwvcD4KICoKICoJCS8vIE1vZGVsOgogKgkJPHBhcmFncmFwaD5mb28gfDxwbGFjZWhvbGRlciB0eXBlPSJuYW1lIj48L3BsYWNlaG9sZGVyPiBiYXI8L3BhcmFncmFwaD4KICoKICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL21vZGVsfk1vZGVsfSBtb2RlbCBNb2RlbCBpbnN0YW5jZSBvbiB3aGljaCB0aGUgY2FsbGJhY2sgb3BlcmF0ZXMuCiAqIEBwYXJhbSB7RnVuY3Rpb259IHZpZXdFbGVtZW50TWF0Y2hlciBGdW5jdGlvbiB0aGF0IGlzIHBhc3NlZCBhIHZpZXcgZWxlbWVudCBhbmQgc2hvdWxkIHJldHVybiBgdHJ1ZWAgaWYgdGhlIGN1c3RvbSBtYXBwaW5nCiAqIHNob3VsZCBiZSBhcHBsaWVkIHRvIHRoZSBnaXZlbiB2aWV3IGVsZW1lbnQuCiAqIEByZXR1cm4ge0Z1bmN0aW9ufQogKi8KCmV4cG9ydCBmdW5jdGlvbiB2aWV3VG9Nb2RlbFBvc2l0aW9uT3V0c2lkZU1vZGVsRWxlbWVudChtb2RlbCwgdmlld0VsZW1lbnRNYXRjaGVyKSB7CiAgcmV0dXJuIGZ1bmN0aW9uIChldnQsIGRhdGEpIHsKICAgIHZhciBtYXBwZXIgPSBkYXRhLm1hcHBlciwKICAgICAgICB2aWV3UG9zaXRpb24gPSBkYXRhLnZpZXdQb3NpdGlvbjsKICAgIHZhciB2aWV3UGFyZW50ID0gbWFwcGVyLmZpbmRNYXBwZWRWaWV3QW5jZXN0b3Iodmlld1Bvc2l0aW9uKTsKCiAgICBpZiAoIXZpZXdFbGVtZW50TWF0Y2hlcih2aWV3UGFyZW50KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIG1vZGVsUGFyZW50ID0gbWFwcGVyLnRvTW9kZWxFbGVtZW50KHZpZXdQYXJlbnQpOwogICAgZGF0YS5tb2RlbFBvc2l0aW9uID0gbW9kZWwuY3JlYXRlUG9zaXRpb25BdChtb2RlbFBhcmVudCwgdmlld1Bvc2l0aW9uLmlzQXRTdGFydCA/ICdiZWZvcmUnIDogJ2FmdGVyJyk7CiAgfTsKfQovKioKICogQSBwb3NpdGlvbmluZyBmdW5jdGlvbiBwYXNzZWQgdG8gdGhlIHtAbGluayBtb2R1bGU6dXRpbHMvZG9tL3Bvc2l0aW9ufmdldE9wdGltYWxQb3NpdGlvbn0gaGVscGVyIGFzIGEgbGFzdCByZXNvcnQKICogd2hlbiBhdHRhY2hpbmcge0BsaW5rICBtb2R1bGU6dWkvcGFuZWwvYmFsbG9vbi9iYWxsb29ucGFuZWx2aWV3fkJhbGxvb25QYW5lbFZpZXcgYmFsbG9vbiBVSX0gdG8gd2lkZ2V0cy4KICogSXQgY29tZXMgaW4gaGFuZHkgd2hlbiBhIHdpZGdldCBpcyBsb25nZXIgdGhhbiB0aGUgdmlzdWFsIHZpZXdwb3J0IG9mIHRoZSB3ZWIgYnJvd3NlciBhbmQvb3IgdXBwZXIvbG93ZXIgYm91bmRhcmllcwogKiBvZiBhIHdpZGdldCBhcmUgb2ZmIHNjcmVlbiBiZWNhdXNlIG9mIHRoZSB3ZWIgcGFnZSBzY3JvbGwuCiAqCiAqCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKUjOKUgOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhFdpZGdldOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUhOKUkAogKgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilIogICAgICAgICAgICAgICAgICAgICAgICAg4pSKCiAqCeKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFZpZXdwb3J04pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQICAg4pSM4pSA4pSA4pWB4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAVmlld3BvcnTilIDilIDilIDilIDilIDilIDilIDilIDilYHilIDilIDilJAKICoJ4pSCICDilI/ilIHilIHilIHilIHilIHilIHilIHilIHilIHilIFXaWRnZXTilIHilIHilIHilIHilIHilIHilIHilIHilIHilJMgIOKUgiAgIOKUgiAg4pSDICAgICAgICAgICAgXiAgICAgICAgICAgIOKUgyAg4pSCCiAqCeKUgiAg4pSDICAgICAgICAgICAgXiAgICAgICAgICAgIOKUgyAg4pSCICAg4pSCICDilIMgICDila3ilIDilIDilIDilIDilIDilIDilIAvIFzilIDilIDilIDilIDilIDilIDilIDila4gICDilIMgIOKUggogKgnilIIgIOKUgyAgIOKVreKUgOKUgOKUgOKUgOKUgOKUgOKUgC8gXOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKVriAgIOKUgyAg4pSCICAg4pSCICDilIMgICDilIIgICAgIEJhbGxvb24gICAgIOKUgiAgIOKUgyAg4pSCCiAqCeKUgiAg4pSDICAg4pSCICAgICBCYWxsb29uICAgICDilIIgICDilIMgIOKUgiAgIOKUgiAg4pSDICAg4pWw4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pWvICAg4pSDICDilIIKICoJ4pSCICDilIMgICDilbDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDila8gICDilIMgIOKUgiAgIOKUgiAg4pSDICAgICAgICAgICAgICAgICAgICAgICAgIOKUgyAg4pSCCiAqCeKUgiAg4pSDICAgICAgICAgICAgICAgICAgICAgICAgIOKUgyAg4pSCICAg4pSCICDilIMgICAgICAgICAgICAgICAgICAgICAgICAg4pSDICDilIIKICoJ4pSCICDilIMgICAgICAgICAgICAgICAgICAgICAgICAg4pSDICDilIIgICDilIIgIOKUgyAgICAgICAgICAgICAgICAgICAgICAgICDilIMgIOKUggogKgnilIIgIOKUgyAgICAgICAgICAgICAgICAgICAgICAgICDilIMgIOKUgiAgIOKUgiAg4pSDICAgICAgICAgICAgICAgICAgICAgICAgIOKUgyAg4pSCCiAqCeKUgiAg4pSDICAgICAgICAgICAgICAgICAgICAgICAgIOKUgyAg4pSCICAg4pSCICDilIMgICAgICAgICAgICAgICAgICAgICAgICAg4pSDICDilIIKICoJ4pSCICDilIMgICAgICAgICAgICAgICAgICAgICAgICAg4pSDICDilIIgICDilIIgIOKUgyAgICAgICAgICAgICAgICAgICAgICAgICDilIMgIOKUggogKgnilIIgIOKUgyAgICAgICAgICAgICAgICAgICAgICAgICDilIMgIOKUgiAgIOKUgiAg4pSDICAgICAgICAgICAgICAgICAgICAgICAgIOKUgyAg4pSCCiAqCeKUlOKUgOKUgOKVgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKVgOKUgOKUgOKUmCAgIOKUlOKUgOKUgOKVgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKVgOKUgOKUgOKUmAogKgkgICDilIogICAgICAgICAgICAgICAgICAgICAgICAg4pSKICAgICAgICAg4pSKICAgICAgICAgICAgICAgICAgICAgICAgIOKUigogKgkgICDilIogICAgICAgICAgICAgICAgICAgICAgICAg4pSKICAgICAgICAg4pSU4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSYCiAqCSAgIOKUiiAgICAgICAgICAgICAgICAgICAgICAgICDilIoKICoJICAg4pSU4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSE4pSYCiAqCiAqICoqTm90ZSoqOiBXb3JrcyBiZXN0IGlmIHVzZWQgdG9nZXRoZXIgd2l0aAogKiB7QGxpbmsgbW9kdWxlOnVpL3BhbmVsL2JhbGxvb24vYmFsbG9vbnBhbmVsdmlld35CYWxsb29uUGFuZWxWaWV3LmRlZmF1bHRQb3NpdGlvbnMgZGVmYXVsdCBgQmFsbG9vblBhbmVsVmlld2AgcG9zaXRpb25zfQogKiBsaWtlIGBub3J0aEFycm93U291dGhgIGFuZCBgc291dGhBcnJvd05vcnRoYDsgdGhlIHRyYW5zaXRpb24gYmV0d2VlbiB0aGVzZSB0d28gYW5kIHRoaXMgcG9zaXRpb24gaXMgc21vb3RoLgogKgogKiBAcGFyYW0ge21vZHVsZTp1dGlscy9kb20vcmVjdH5SZWN0fSB3aWRnZXRSZWN0IEEgcmVjdCBvZiB0aGUgd2lkZ2V0LgogKiBAcGFyYW0ge21vZHVsZTp1dGlscy9kb20vcmVjdH5SZWN0fSBiYWxsb29uUmVjdCBBIHJlY3Qgb2YgdGhlIGJhbGxvb24uCiAqIEByZXR1cm5zIHttb2R1bGU6dXRpbHMvZG9tL3Bvc2l0aW9uflBvc2l0aW9ufG51bGx9CiAqLwoKZXhwb3J0IGZ1bmN0aW9uIGNlbnRlcmVkQmFsbG9vblBvc2l0aW9uRm9yTG9uZ1dpZGdldHMod2lkZ2V0UmVjdCwgYmFsbG9vblJlY3QpIHsKICB2YXIgdmlld3BvcnRSZWN0ID0gbmV3IFJlY3QoZ2xvYmFsLndpbmRvdyk7CiAgdmFyIHZpZXdwb3J0V2lkZ2V0SW5zZXJzZWN0aW9uUmVjdCA9IHZpZXdwb3J0UmVjdC5nZXRJbnRlcnNlY3Rpb24od2lkZ2V0UmVjdCk7CiAgdmFyIGJhbGxvb25Ub3RhbEhlaWdodCA9IGJhbGxvb25SZWN0LmhlaWdodCArIEJhbGxvb25QYW5lbFZpZXcuYXJyb3dWZXJ0aWNhbE9mZnNldDsgLy8gSWYgdGhlcmUgaXMgZW5vdWdoIHNwYWNlIGFib3ZlIG9yIGJlbG93IHRoZSB3aWRnZXQgdGhlbiB0aGlzIHBvc2l0aW9uIHNob3VsZCBub3QgYmUgdXNlZC4KCiAgaWYgKHdpZGdldFJlY3QudG9wIC0gYmFsbG9vblRvdGFsSGVpZ2h0ID4gdmlld3BvcnRSZWN0LnRvcCB8fCB3aWRnZXRSZWN0LmJvdHRvbSArIGJhbGxvb25Ub3RhbEhlaWdodCA8IHZpZXdwb3J0UmVjdC5ib3R0b20pIHsKICAgIHJldHVybiBudWxsOwogIH0gLy8gQmVjYXVzZSB0aGlzIGlzIGEgbGFzdCByZXNvcnQgcG9zaXRpb25pbmcsIHRvIGtlZXAgdGhpbmdzIHNpbXBsZSB3ZSdyZSBub3QgcGxheWluZyB3aXRoIHBvc2l0aW9ucyBvZiB0aGUgYXJyb3cKICAvLyBsaWtlLCBmb3IgaW5zdGFuY2UsICJzb3V0aCB3ZXN0IiBvciB3aGF0ZXZlci4gSnVzdCB0cnkgdG8ga2VlcCB0aGUgYmFsbG9vbiBpbiB0aGUgbWlkZGxlIG9mIHRoZSB2aXNpYmxlIGFyZWEgb2YKICAvLyB0aGUgd2lkZ2V0IGZvciBhcyBsb25nIGFzIGl0IGlzIHBvc3NpYmxlLiBJZiB0aGUgd2lkZ2V0cyBiZWNvbWVzIGludmlzaWJsZSAoYmVjYXVzZSBjcm9wcGVkIGJ5IHRoZSB2aWV3cG9ydCksCiAgLy8ganVzdC4uLiBwbGFjZSB0aGUgYmFsbG9vbiBpbiB0aGUgbWlkZGxlIG9mIGl0IChiZWNhdXNlIHdoeSBub3Q/KS4KCgogIHZhciB0YXJnZXRSZWN0ID0gdmlld3BvcnRXaWRnZXRJbnNlcnNlY3Rpb25SZWN0IHx8IHdpZGdldFJlY3Q7CiAgdmFyIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgKyB0YXJnZXRSZWN0LndpZHRoIC8gMiAtIGJhbGxvb25SZWN0LndpZHRoIC8gMjsKICByZXR1cm4gewogICAgdG9wOiBNYXRoLm1heCh3aWRnZXRSZWN0LnRvcCwgMCkgKyBCYWxsb29uUGFuZWxWaWV3LmFycm93VmVydGljYWxPZmZzZXQsCiAgICBsZWZ0OiBsZWZ0LAogICAgbmFtZTogJ2Fycm93X24nCiAgfTsKfSAvLyBEZWZhdWx0IGZpbGxlciBvZmZzZXQgZnVuY3Rpb24gYXBwbGllZCB0byBhbGwgd2lkZ2V0IGVsZW1lbnRzLgovLwovLyBAcmV0dXJucyB7bnVsbH0KCmZ1bmN0aW9uIGdldEZpbGxlck9mZnNldCgpIHsKICByZXR1cm4gbnVsbDsKfSAvLyBBZGRzIGEgZHJhZyBoYW5kbGUgdG8gdGhlIHdpZGdldC4KLy8KLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvY29udGFpbmVyZWxlbWVudH5Db250YWluZXJFbGVtZW50fQovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlcn0gd3JpdGVyCgoKZnVuY3Rpb24gYWRkU2VsZWN0aW9uSGFuZGxlKHdpZGdldEVsZW1lbnQsIHdyaXRlcikgewogIHZhciBzZWxlY3Rpb25IYW5kbGUgPSB3cml0ZXIuY3JlYXRlVUlFbGVtZW50KCdkaXYnLCB7CiAgICBjbGFzczogJ2NrIGNrLXdpZGdldF9fc2VsZWN0aW9uLWhhbmRsZScKICB9LCBmdW5jdGlvbiAoZG9tRG9jdW1lbnQpIHsKICAgIHZhciBkb21FbGVtZW50ID0gdGhpcy50b0RvbUVsZW1lbnQoZG9tRG9jdW1lbnQpOyAvLyBVc2UgdGhlIEljb25WaWV3IGZyb20gdGhlIHVpIGxpYnJhcnkuCgogICAgdmFyIGljb24gPSBuZXcgSWNvblZpZXcoKTsKICAgIGljb24uc2V0KCdjb250ZW50JywgZHJhZ0hhbmRsZUljb24pOyAvLyBSZW5kZXIgdGhlIGljb24gdmlldyByaWdodCBhd2F5IHRvIGFwcGVuZCBpdHMgI2VsZW1lbnQgdG8gdGhlIHNlbGVjdGlvbkhhbmRsZSBET00gZWxlbWVudC4KCiAgICBpY29uLnJlbmRlcigpOwogICAgZG9tRWxlbWVudC5hcHBlbmRDaGlsZChpY29uLmVsZW1lbnQpOwogICAgcmV0dXJuIGRvbUVsZW1lbnQ7CiAgfSk7IC8vIEFwcGVuZCB0aGUgc2VsZWN0aW9uIGhhbmRsZSBpbnRvIHRoZSB3aWRnZXQgd3JhcHBlci4KCiAgd3JpdGVyLmluc2VydCh3cml0ZXIuY3JlYXRlUG9zaXRpb25BdCh3aWRnZXRFbGVtZW50LCAwKSwgc2VsZWN0aW9uSGFuZGxlKTsKICB3cml0ZXIuYWRkQ2xhc3MoWydjay13aWRnZXRfd2l0aC1zZWxlY3Rpb24taGFuZGxlJ10sIHdpZGdldEVsZW1lbnQpOwp9"},{"version":3,"sources":["/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-widget/src/utils.js"],"names":["BalloonPanelView","global","Rect","CKEditorError","toArray","HighlightStack","getTypeAroundFakeCaretPosition","IconView","dragHandleIcon","WIDGET_CLASS_NAME","WIDGET_SELECTED_CLASS_NAME","isWidget","node","is","getCustomProperty","toWidget","element","writer","options","setAttribute","addClass","setCustomProperty","getFillerOffset","label","setLabel","hasSelectionHandle","addSelectionHandle","setHighlightHandling","addHighlight","removeHighlight","descriptor","classes","attributes","key","removeClass","removeAttribute","add","remove","stack","on","evt","data","oldDescriptor","newDescriptor","id","labelOrCreator","getLabel","labelCreator","toWidgetEditable","editable","isReadOnly","property","findOptimalInsertionPosition","selection","model","selectedElement","getSelectedElement","typeAroundFakeCaretPosition","createPositionAt","schema","isBlock","createPositionAfter","firstBlock","getSelectedBlocks","next","value","isEmpty","positionAfter","focus","isTouching","createPositionBefore","checkSelectionOnObject","isObject","viewToModelPositionOutsideModelElement","viewElementMatcher","mapper","viewPosition","viewParent","findMappedViewAncestor","modelParent","toModelElement","modelPosition","isAtStart","centeredBalloonPositionForLongWidgets","widgetRect","balloonRect","viewportRect","window","viewportWidgetInsersectionRect","getIntersection","balloonTotalHeight","height","arrowVerticalOffset","top","bottom","targetRect","left","width","Math","max","name","widgetElement","selectionHandle","createUIElement","class","domDocument","domElement","toDomElement","icon","set","render","appendChild","insert"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module widget/utils\n */\n\nimport BalloonPanelView from '@ckeditor/ckeditor5-ui/src/panel/balloon/balloonpanelview';\n\nimport global from '@ckeditor/ckeditor5-utils/src/dom/global';\nimport Rect from '@ckeditor/ckeditor5-utils/src/dom/rect';\nimport CKEditorError from '@ckeditor/ckeditor5-utils/src/ckeditorerror';\nimport toArray from '@ckeditor/ckeditor5-utils/src/toarray';\n\nimport HighlightStack from './highlightstack';\nimport { getTypeAroundFakeCaretPosition } from './widgettypearound/utils';\n\nimport IconView from '@ckeditor/ckeditor5-ui/src/icon/iconview';\nimport dragHandleIcon from '../theme/icons/drag-handle.svg';\n\n/**\n * CSS class added to each widget element.\n *\n * @const {String}\n */\nexport const WIDGET_CLASS_NAME = 'ck-widget';\n\n/**\n * CSS class added to currently selected widget element.\n *\n * @const {String}\n */\nexport const WIDGET_SELECTED_CLASS_NAME = 'ck-widget_selected';\n\n/**\n * Returns `true` if given {@link module:engine/view/node~Node} is an {@link module:engine/view/element~Element} and a widget.\n *\n * @param {module:engine/view/node~Node} node\n * @returns {Boolean}\n */\nexport function isWidget( node ) {\n\tif ( !node.is( 'element' ) ) {\n\t\treturn false;\n\t}\n\n\treturn !!node.getCustomProperty( 'widget' );\n}\n\n/**\n * Converts the given {@link module:engine/view/element~Element} to a widget in the following way:\n *\n * * sets the `contenteditable` attribute to `\"false\"`,\n * * adds the `ck-widget` CSS class,\n * * adds a custom {@link module:engine/view/element~Element#getFillerOffset `getFillerOffset()`} method returning `null`,\n * * adds a custom property allowing to recognize widget elements by using {@link ~isWidget `isWidget()`},\n * * implements the {@link ~setHighlightHandling view highlight on widgets}.\n *\n * This function needs to be used in conjunction with\n * {@link module:engine/conversion/downcasthelpers~DowncastHelpers downcast conversion helpers}\n * like {@link module:engine/conversion/downcasthelpers~DowncastHelpers#elementToElement `elementToElement()`}.\n * Moreover, typically you will want to use `toWidget()` only for `editingDowncast`, while keeping the `dataDowncast` clean.\n *\n * For example, in order to convert a `<widget>` model element to `<div class=\"widget\">` in the view, you can define\n * such converters:\n *\n *\t\teditor.conversion.for( 'editingDowncast' )\n *\t\t\t.elementToElement( {\n *\t\t\t\tmodel: 'widget',\n *\t\t\t\tview: ( modelItem, { writer } ) => {\n *\t\t\t\t\tconst div = writer.createContainerElement( 'div', { class: 'widget' } );\n *\n *\t\t\t\t\treturn toWidget( div, writer, { label: 'some widget' } );\n *\t\t\t\t}\n *\t\t\t} );\n *\n *\t\teditor.conversion.for( 'dataDowncast' )\n *\t\t\t.elementToElement( {\n *\t\t\t\tmodel: 'widget',\n *\t\t\t\tview: ( modelItem, { writer } ) => {\n *\t\t\t\t\treturn writer.createContainerElement( 'div', { class: 'widget' } );\n *\t\t\t\t}\n *\t\t\t} );\n *\n * See the full source code of the widget (with a nested editable) schema definition and converters in\n * [this sample](https://github.com/ckeditor/ckeditor5-widget/blob/master/tests/manual/widget-with-nestededitable.js).\n *\n * @param {module:engine/view/element~Element} element\n * @param {module:engine/view/downcastwriter~DowncastWriter} writer\n * @param {Object} [options={}]\n * @param {String|Function} [options.label] Element's label provided to the {@link ~setLabel} function. It can be passed as\n * a plain string or a function returning a string. It represents the widget for assistive technologies (like screen readers).\n * @param {Boolean} [options.hasSelectionHandle=false] If `true`, the widget will have a selection handle added.\n * @returns {module:engine/view/element~Element} Returns the same element.\n */\nexport function toWidget( element, writer, options = {} ) {\n\tif ( !element.is( 'containerElement' ) ) {\n\t\t/**\n\t\t * The element passed to `toWidget()` must be a {@link module:engine/view/containerelement~ContainerElement}\n\t\t * instance.\n\t\t *\n\t\t * @error widget-to-widget-wrong-element-type\n\t\t * @param {String} element The view element passed to `toWidget()`.\n\t\t */\n\t\tthrow new CKEditorError(\n\t\t\t'widget-to-widget-wrong-element-type',\n\t\t\tnull,\n\t\t\t{ element }\n\t\t);\n\t}\n\n\twriter.setAttribute( 'contenteditable', 'false', element );\n\n\twriter.addClass( WIDGET_CLASS_NAME, element );\n\twriter.setCustomProperty( 'widget', true, element );\n\telement.getFillerOffset = getFillerOffset;\n\n\tif ( options.label ) {\n\t\tsetLabel( element, options.label, writer );\n\t}\n\n\tif ( options.hasSelectionHandle ) {\n\t\taddSelectionHandle( element, writer );\n\t}\n\n\tsetHighlightHandling( element, writer, addHighlight, removeHighlight );\n\n\treturn element;\n}\n\n// Default handler for adding a highlight on a widget.\n// It adds CSS class and attributes basing on the given highlight descriptor.\n//\n// @param {module:engine/view/element~Element} element\n// @param {module:engine/conversion/downcasthelpers~HighlightDescriptor} descriptor\n// @param {module:engine/view/downcastwriter~DowncastWriter} writer\nfunction addHighlight( element, descriptor, writer ) {\n\tif ( descriptor.classes ) {\n\t\twriter.addClass( toArray( descriptor.classes ), element );\n\t}\n\n\tif ( descriptor.attributes ) {\n\t\tfor ( const key in descriptor.attributes ) {\n\t\t\twriter.setAttribute( key, descriptor.attributes[ key ], element );\n\t\t}\n\t}\n}\n\n// Default handler for removing a highlight from a widget.\n// It removes CSS class and attributes basing on the given highlight descriptor.\n//\n// @param {module:engine/view/element~Element} element\n// @param {module:engine/conversion/downcasthelpers~HighlightDescriptor} descriptor\n// @param {module:engine/view/downcastwriter~DowncastWriter} writer\nfunction removeHighlight( element, descriptor, writer ) {\n\tif ( descriptor.classes ) {\n\t\twriter.removeClass( toArray( descriptor.classes ), element );\n\t}\n\n\tif ( descriptor.attributes ) {\n\t\tfor ( const key in descriptor.attributes ) {\n\t\t\twriter.removeAttribute( key, element );\n\t\t}\n\t}\n}\n\n/**\n * Sets highlight handling methods. Uses {@link module:widget/highlightstack~HighlightStack} to\n * properly determine which highlight descriptor should be used at given time.\n *\n * @param {module:engine/view/element~Element} element\n * @param {module:engine/view/downcastwriter~DowncastWriter} writer\n * @param {Function} add\n * @param {Function} remove\n */\nexport function setHighlightHandling( element, writer, add, remove ) {\n\tconst stack = new HighlightStack();\n\n\tstack.on( 'change:top', ( evt, data ) => {\n\t\tif ( data.oldDescriptor ) {\n\t\t\tremove( element, data.oldDescriptor, data.writer );\n\t\t}\n\n\t\tif ( data.newDescriptor ) {\n\t\t\tadd( element, data.newDescriptor, data.writer );\n\t\t}\n\t} );\n\n\twriter.setCustomProperty( 'addHighlight', ( element, descriptor, writer ) => stack.add( descriptor, writer ), element );\n\twriter.setCustomProperty( 'removeHighlight', ( element, id, writer ) => stack.remove( id, writer ), element );\n}\n\n/**\n * Sets label for given element.\n * It can be passed as a plain string or a function returning a string. Function will be called each time label is retrieved by\n * {@link ~getLabel `getLabel()`}.\n *\n * @param {module:engine/view/element~Element} element\n * @param {String|Function} labelOrCreator\n * @param {module:engine/view/downcastwriter~DowncastWriter} writer\n */\nexport function setLabel( element, labelOrCreator, writer ) {\n\twriter.setCustomProperty( 'widgetLabel', labelOrCreator, element );\n}\n\n/**\n * Returns the label of the provided element.\n *\n * @param {module:engine/view/element~Element} element\n * @returns {String}\n */\nexport function getLabel( element ) {\n\tconst labelCreator = element.getCustomProperty( 'widgetLabel' );\n\n\tif ( !labelCreator ) {\n\t\treturn '';\n\t}\n\n\treturn typeof labelCreator == 'function' ? labelCreator() : labelCreator;\n}\n\n/**\n * Adds functionality to the provided {@link module:engine/view/editableelement~EditableElement} to act as a widget's editable:\n *\n * * sets the `contenteditable` attribute to `true` when {@link module:engine/view/editableelement~EditableElement#isReadOnly} is `false`,\n * otherwise sets it to `false`,\n * * adds the `ck-editor__editable` and `ck-editor__nested-editable` CSS classes,\n * * adds the `ck-editor__nested-editable_focused` CSS class when the editable is focused and removes it when it is blurred.\n *\n * Similarly to {@link ~toWidget `toWidget()`} this function should be used in `editingDowncast` only and it is usually\n * used together with {@link module:engine/conversion/downcasthelpers~DowncastHelpers#elementToElement `elementToElement()`}.\n *\n * For example, in order to convert a `<nested>` model element to `<div class=\"nested\">` in the view, you can define\n * such converters:\n *\n *\t\teditor.conversion.for( 'editingDowncast' )\n *\t\t\t.elementToElement( {\n *\t\t\t\tmodel: 'nested',\n *\t\t\t\tview: ( modelItem, { writer } ) => {\n *\t\t\t\t\tconst div = writer.createEditableElement( 'div', { class: 'nested' } );\n *\n *\t\t\t\t\treturn toWidgetEditable( nested, writer );\n *\t\t\t\t}\n *\t\t\t} );\n *\n *\t\teditor.conversion.for( 'dataDowncast' )\n *\t\t\t.elementToElement( {\n *\t\t\t\tmodel: 'nested',\n *\t\t\t\tview: ( modelItem, { writer } ) => {\n *\t\t\t\t\treturn writer.createContainerElement( 'div', { class: 'nested' } );\n *\t\t\t\t}\n *\t\t\t} );\n *\n * See the full source code of the widget (with nested editable) schema definition and converters in\n * [this sample](https://github.com/ckeditor/ckeditor5-widget/blob/master/tests/manual/widget-with-nestededitable.js).\n *\n * @param {module:engine/view/editableelement~EditableElement} editable\n * @param {module:engine/view/downcastwriter~DowncastWriter} writer\n * @returns {module:engine/view/editableelement~EditableElement} Returns the same element that was provided in the `editable` parameter\n */\nexport function toWidgetEditable( editable, writer ) {\n\twriter.addClass( [ 'ck-editor__editable', 'ck-editor__nested-editable' ], editable );\n\n\t// Set initial contenteditable value.\n\twriter.setAttribute( 'contenteditable', editable.isReadOnly ? 'false' : 'true', editable );\n\n\t// Bind the contenteditable property to element#isReadOnly.\n\teditable.on( 'change:isReadOnly', ( evt, property, is ) => {\n\t\twriter.setAttribute( 'contenteditable', is ? 'false' : 'true', editable );\n\t} );\n\n\teditable.on( 'change:isFocused', ( evt, property, is ) => {\n\t\tif ( is ) {\n\t\t\twriter.addClass( 'ck-editor__nested-editable_focused', editable );\n\t\t} else {\n\t\t\twriter.removeClass( 'ck-editor__nested-editable_focused', editable );\n\t\t}\n\t} );\n\n\treturn editable;\n}\n\n/**\n * Returns a model position which is optimal (in terms of UX) for inserting a widget block.\n *\n * For instance, if a selection is in the middle of a paragraph, the position before this paragraph\n * will be returned so that it is not split. If the selection is at the end of a paragraph,\n * the position after this paragraph will be returned.\n *\n * Note: If the selection is placed in an empty block, that block will be returned. If that position\n * is then passed to {@link module:engine/model/model~Model#insertContent},\n * the block will be fully replaced by the image.\n *\n * @param {module:engine/model/selection~Selection|module:engine/model/documentselection~DocumentSelection} selection\n * The selection based on which the insertion position should be calculated.\n * @param {module:engine/model/model~Model} model Model instance.\n * @returns {module:engine/model/position~Position} The optimal position.\n */\nexport function findOptimalInsertionPosition( selection, model ) {\n\tconst selectedElement = selection.getSelectedElement();\n\n\tif ( selectedElement ) {\n\t\tconst typeAroundFakeCaretPosition = getTypeAroundFakeCaretPosition( selection );\n\n\t\t// If the WidgetTypeAround \"fake caret\" is displayed, use its position for the insertion\n\t\t// to provide the most predictable UX (https://github.com/ckeditor/ckeditor5/issues/7438).\n\t\tif ( typeAroundFakeCaretPosition ) {\n\t\t\treturn model.createPositionAt( selectedElement, typeAroundFakeCaretPosition );\n\t\t}\n\n\t\tif ( model.schema.isBlock( selectedElement ) ) {\n\t\t\treturn model.createPositionAfter( selectedElement );\n\t\t}\n\t}\n\n\tconst firstBlock = selection.getSelectedBlocks().next().value;\n\n\tif ( firstBlock ) {\n\t\t// If inserting into an empty block  return position in that block. It will get\n\t\t// replaced with the image by insertContent(). #42.\n\t\tif ( firstBlock.isEmpty ) {\n\t\t\treturn model.createPositionAt( firstBlock, 0 );\n\t\t}\n\n\t\tconst positionAfter = model.createPositionAfter( firstBlock );\n\n\t\t// If selection is at the end of the block - return position after the block.\n\t\tif ( selection.focus.isTouching( positionAfter ) ) {\n\t\t\treturn positionAfter;\n\t\t}\n\n\t\t// Otherwise return position before the block.\n\t\treturn model.createPositionBefore( firstBlock );\n\t}\n\n\treturn selection.focus;\n}\n\n/**\n * Checks if the selection is on an object.\n *\n * @param {module:engine/model/selection~Selection|module:engine/model/documentselection~DocumentSelection} selection\n * @param {module:engine/model/schema~Schema} schema\n * @returns {Boolean}\n*/\nexport function checkSelectionOnObject( selection, schema ) {\n\tconst selectedElement = selection.getSelectedElement();\n\n\treturn !!selectedElement && schema.isObject( selectedElement );\n}\n\n/**\n * A util to be used in order to map view positions to correct model positions when implementing a widget\n * which renders non-empty view element for an empty model element.\n *\n * For example:\n *\n *\t\t// Model:\n *\t\t<placeholder type=\"name\"></placeholder>\n *\n *\t\t// View:\n *\t\t<span class=\"placeholder\">name</span>\n *\n * In such case, view positions inside `<span>` cannot be correct mapped to the model (because the model element is empty).\n * To handle mapping positions inside `<span class=\"placeholder\">` to the model use this util as follows:\n *\n *\t\teditor.editing.mapper.on(\n *\t\t\t'viewToModelPosition',\n *\t\t\tviewToModelPositionOutsideModelElement( model, viewElement => viewElement.hasClass( 'placeholder' ) )\n *\t\t);\n *\n * The callback will try to map the view offset of selection to an expected model position.\n *\n * 1. When the position is at the end (or in the middle) of the inline widget:\n *\n *\t\t// View:\n *\t\t<p>foo <span class=\"placeholder\">name|</span> bar</p>\n *\n *\t\t// Model:\n *\t\t<paragraph>foo <placeholder type=\"name\"></placeholder>| bar</paragraph>\n *\n * 2. When the position is at the beginning of the inline widget:\n *\n *\t\t// View:\n *\t\t<p>foo <span class=\"placeholder\">|name</span> bar</p>\n *\n *\t\t// Model:\n *\t\t<paragraph>foo |<placeholder type=\"name\"></placeholder> bar</paragraph>\n *\n * @param {module:engine/model/model~Model} model Model instance on which the callback operates.\n * @param {Function} viewElementMatcher Function that is passed a view element and should return `true` if the custom mapping\n * should be applied to the given view element.\n * @return {Function}\n */\nexport function viewToModelPositionOutsideModelElement( model, viewElementMatcher ) {\n\treturn ( evt, data ) => {\n\t\tconst { mapper, viewPosition } = data;\n\n\t\tconst viewParent = mapper.findMappedViewAncestor( viewPosition );\n\n\t\tif ( !viewElementMatcher( viewParent ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst modelParent = mapper.toModelElement( viewParent );\n\n\t\tdata.modelPosition = model.createPositionAt( modelParent, viewPosition.isAtStart ? 'before' : 'after' );\n\t};\n}\n\n/**\n * A positioning function passed to the {@link module:utils/dom/position~getOptimalPosition} helper as a last resort\n * when attaching {@link  module:ui/panel/balloon/balloonpanelview~BalloonPanelView balloon UI} to widgets.\n * It comes in handy when a widget is longer than the visual viewport of the web browser and/or upper/lower boundaries\n * of a widget are off screen because of the web page scroll.\n *\n *\t                                       Widget\n *\t                                                                \n *\tViewport   Viewport\n *\t  Widget                   ^              \n *\t              ^                      / \\     \n *\t     / \\                  Balloon          \n *\t          Balloon                       \n *\t                                          \n *\t                                                             \n *\t                                                             \n *\t                                                             \n *\t                                                             \n *\t                                                             \n *\t                                                             \n *\t   \n *\t                                                              \n *\t                                     \n *\t                            \n *\t   \n *\n * **Note**: Works best if used together with\n * {@link module:ui/panel/balloon/balloonpanelview~BalloonPanelView.defaultPositions default `BalloonPanelView` positions}\n * like `northArrowSouth` and `southArrowNorth`; the transition between these two and this position is smooth.\n *\n * @param {module:utils/dom/rect~Rect} widgetRect A rect of the widget.\n * @param {module:utils/dom/rect~Rect} balloonRect A rect of the balloon.\n * @returns {module:utils/dom/position~Position|null}\n */\nexport function centeredBalloonPositionForLongWidgets( widgetRect, balloonRect ) {\n\tconst viewportRect = new Rect( global.window );\n\tconst viewportWidgetInsersectionRect = viewportRect.getIntersection( widgetRect );\n\n\tconst balloonTotalHeight = balloonRect.height + BalloonPanelView.arrowVerticalOffset;\n\n\t// If there is enough space above or below the widget then this position should not be used.\n\tif ( widgetRect.top - balloonTotalHeight > viewportRect.top || widgetRect.bottom + balloonTotalHeight < viewportRect.bottom ) {\n\t\treturn null;\n\t}\n\n\t// Because this is a last resort positioning, to keep things simple we're not playing with positions of the arrow\n\t// like, for instance, \"south west\" or whatever. Just try to keep the balloon in the middle of the visible area of\n\t// the widget for as long as it is possible. If the widgets becomes invisible (because cropped by the viewport),\n\t// just... place the balloon in the middle of it (because why not?).\n\tconst targetRect = viewportWidgetInsersectionRect || widgetRect;\n\tconst left = targetRect.left + targetRect.width / 2 - balloonRect.width / 2;\n\n\treturn {\n\t\ttop: Math.max( widgetRect.top, 0 ) + BalloonPanelView.arrowVerticalOffset,\n\t\tleft,\n\t\tname: 'arrow_n'\n\t};\n}\n\n// Default filler offset function applied to all widget elements.\n//\n// @returns {null}\nfunction getFillerOffset() {\n\treturn null;\n}\n\n// Adds a drag handle to the widget.\n//\n// @param {module:engine/view/containerelement~ContainerElement}\n// @param {module:engine/view/downcastwriter~DowncastWriter} writer\nfunction addSelectionHandle( widgetElement, writer ) {\n\tconst selectionHandle = writer.createUIElement( 'div', { class: 'ck ck-widget__selection-handle' }, function( domDocument ) {\n\t\tconst domElement = this.toDomElement( domDocument );\n\n\t\t// Use the IconView from the ui library.\n\t\tconst icon = new IconView();\n\t\ticon.set( 'content', dragHandleIcon );\n\n\t\t// Render the icon view right away to append its #element to the selectionHandle DOM element.\n\t\ticon.render();\n\n\t\tdomElement.appendChild( icon.element );\n\n\t\treturn domElement;\n\t} );\n\n\t// Append the selection handle into the widget wrapper.\n\twriter.insert( writer.createPositionAt( widgetElement, 0 ), selectionHandle );\n\twriter.addClass( [ 'ck-widget_with-selection-handle' ], widgetElement );\n}\n"]}]}