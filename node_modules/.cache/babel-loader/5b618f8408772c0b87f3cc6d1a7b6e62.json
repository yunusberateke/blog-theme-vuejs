{"remainingRequest":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js?{}!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-utils/src/emittermixin.js","dependencies":[{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-utils/src/emittermixin.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvaG9tZS9la2ViZXJhdC9ZYW5kZXguRGlzay9Qcm9qZWxlcmltL0JlbmltUHJvamVsZXJpbS93ZWJzaXRlbS93ZWJzaXRlbS13ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9ob21lL2VrZWJlcmF0L1lhbmRleC5EaXNrL1Byb2plbGVyaW0vQmVuaW1Qcm9qZWxlcmltL3dlYnNpdGVtL3dlYnNpdGVtLXdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICIvaG9tZS9la2ViZXJhdC9ZYW5kZXguRGlzay9Qcm9qZWxlcmltL0JlbmltUHJvamVsZXJpbS93ZWJzaXRlbS93ZWJzaXRlbS13ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuZGVzY3JpcHRpb24uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZyb20uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKCi8qKgogKiBAbGljZW5zZSBDb3B5cmlnaHQgKGMpIDIwMDMtMjAyMSwgQ0tTb3VyY2UgLSBGcmVkZXJpY28gS25hYmJlbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogRm9yIGxpY2Vuc2luZywgc2VlIExJQ0VOU0UubWQgb3IgaHR0cHM6Ly9ja2VkaXRvci5jb20vbGVnYWwvY2tlZGl0b3Itb3NzLWxpY2Vuc2UKICovCgovKioKICogQG1vZHVsZSB1dGlscy9lbWl0dGVybWl4aW4KICovCmltcG9ydCBFdmVudEluZm8gZnJvbSAnLi9ldmVudGluZm8nOwppbXBvcnQgdWlkIGZyb20gJy4vdWlkJzsKaW1wb3J0IHByaW9yaXRpZXMgZnJvbSAnLi9wcmlvcml0aWVzJzsgLy8gVG8gY2hlY2sgaWYgY29tcG9uZW50IGlzIGxvYWRlZCBtb3JlIHRoYW4gb25jZS4KCmltcG9ydCAnLi92ZXJzaW9uJzsKaW1wb3J0IENLRWRpdG9yRXJyb3IgZnJvbSAnLi9ja2VkaXRvcmVycm9yJzsKCnZhciBfbGlzdGVuaW5nVG8gPSBTeW1ib2woJ2xpc3RlbmluZ1RvJyk7Cgp2YXIgX2VtaXR0ZXJJZCA9IFN5bWJvbCgnZW1pdHRlcklkJyk7Ci8qKgogKiBNaXhpbiB0aGF0IGluamVjdHMgdGhlIHtAbGluayB+RW1pdHRlciBldmVudHMgQVBJfSBpbnRvIGl0cyBob3N0LgogKgogKiBSZWFkIG1vcmUgYWJvdXQgdGhlIGNvbmNlcHQgb2YgZW1pdHRlcnMgaW4gdGhlOgogKiAqIHtAZ2xpbmsgZnJhbWV3b3JrL2d1aWRlcy9hcmNoaXRlY3R1cmUvY29yZS1lZGl0b3ItYXJjaGl0ZWN0dXJlI2V2ZW50LXN5c3RlbS1hbmQtb2JzZXJ2YWJsZXMgRXZlbnQgc3lzdGVtIGFuZCBvYnNlcnZhYmxlc30KICogc2VjdGlvbiBvZiB0aGUge0BnbGluayBmcmFtZXdvcmsvZ3VpZGVzL2FyY2hpdGVjdHVyZS9jb3JlLWVkaXRvci1hcmNoaXRlY3R1cmUgQ29yZSBlZGl0b3IgYXJjaGl0ZWN0dXJlfSBndWlkZS4KICogKiB7QGdsaW5rIGZyYW1ld29yay9ndWlkZXMvZGVlcC1kaXZlL2V2ZW50LXN5c3RlbSBFdmVudCBzeXN0ZW19IGRlZXAgZGl2ZSBndWlkZS4KICoKICogQG1peGluIEVtaXR0ZXJNaXhpbgogKiBAaW1wbGVtZW50cyBtb2R1bGU6dXRpbHMvZW1pdHRlcm1peGlufkVtaXR0ZXIKICovCgoKdmFyIEVtaXR0ZXJNaXhpbiA9IHsKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogIG9uOiBmdW5jdGlvbiBvbihldmVudCwgY2FsbGJhY2spIHsKICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTsKICAgIHRoaXMubGlzdGVuVG8odGhpcywgZXZlbnQsIGNhbGxiYWNrLCBvcHRpb25zKTsKICB9LAoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogIG9uY2U6IGZ1bmN0aW9uIG9uY2UoZXZlbnQsIGNhbGxiYWNrLCBvcHRpb25zKSB7CiAgICB2YXIgd2FzRmlyZWQgPSBmYWxzZTsKCiAgICB2YXIgb25jZUNhbGxiYWNrID0gZnVuY3Rpb24gb25jZUNhbGxiYWNrKGV2ZW50KSB7CiAgICAgIC8vIEVuc3VyZSB0aGUgY2FsbGJhY2sgaXMgY2FsbGVkIG9ubHkgb25jZSBldmVuIGlmIHRoZSBjYWxsYmFjayBpdHNlbGYgbGVhZHMgdG8gcmUtZmlyaW5nIHRoZSBldmVudAogICAgICAvLyAod2hpY2ggd291bGQgY2FsbCB0aGUgY2FsbGJhY2sgYWdhaW4pLgogICAgICBpZiAoIXdhc0ZpcmVkKSB7CiAgICAgICAgd2FzRmlyZWQgPSB0cnVlOyAvLyBHbyBvZmYoKSBhdCB0aGUgZmlyc3QgY2FsbC4KCiAgICAgICAgZXZlbnQub2ZmKCk7IC8vIEdvIHdpdGggdGhlIG9yaWdpbmFsIGNhbGxiYWNrLgoKICAgICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgICB9CgogICAgICAgIGNhbGxiYWNrLmNhbGwuYXBwbHkoY2FsbGJhY2ssIFt0aGlzLCBldmVudF0uY29uY2F0KGFyZ3MpKTsKICAgICAgfQogICAgfTsgLy8gTWFrZSBhIHNpbWlsYXIgb24oKSBjYWxsLCBzaW1wbHkgcmVwbGFjaW5nIHRoZSBjYWxsYmFjay4KCgogICAgdGhpcy5saXN0ZW5Ubyh0aGlzLCBldmVudCwgb25jZUNhbGxiYWNrLCBvcHRpb25zKTsKICB9LAoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogIG9mZjogZnVuY3Rpb24gb2ZmKGV2ZW50LCBjYWxsYmFjaykgewogICAgdGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMsIGV2ZW50LCBjYWxsYmFjayk7CiAgfSwKCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICBsaXN0ZW5UbzogZnVuY3Rpb24gbGlzdGVuVG8oZW1pdHRlciwgZXZlbnQsIGNhbGxiYWNrKSB7CiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDoge307CiAgICB2YXIgZW1pdHRlckluZm8sIGV2ZW50Q2FsbGJhY2tzOyAvLyBfbGlzdGVuaW5nVG8gY29udGFpbnMgYSBsaXN0IG9mIGVtaXR0ZXJzIHRoYXQgdGhpcyBvYmplY3QgaXMgbGlzdGVuaW5nIHRvLgogICAgLy8gVGhpcyBsaXN0IGhhcyB0aGUgZm9sbG93aW5nIGZvcm1hdDoKICAgIC8vCiAgICAvLyBfbGlzdGVuaW5nVG86IHsKICAgIC8vICAgICBlbWl0dGVySWQ6IHsKICAgIC8vICAgICAgICAgZW1pdHRlcjogZW1pdHRlciwKICAgIC8vICAgICAgICAgY2FsbGJhY2tzOiB7CiAgICAvLyAgICAgICAgICAgICBldmVudDE6IFsgY2FsbGJhY2sxLCBjYWxsYmFjazIsIC4uLiBdCiAgICAvLyAgICAgICAgICAgICAuLi4uCiAgICAvLyAgICAgICAgIH0KICAgIC8vICAgICB9LAogICAgLy8gICAgIC4uLgogICAgLy8gfQoKICAgIGlmICghdGhpc1tfbGlzdGVuaW5nVG9dKSB7CiAgICAgIHRoaXNbX2xpc3RlbmluZ1RvXSA9IHt9OwogICAgfQoKICAgIHZhciBlbWl0dGVycyA9IHRoaXNbX2xpc3RlbmluZ1RvXTsKCiAgICBpZiAoIV9nZXRFbWl0dGVySWQoZW1pdHRlcikpIHsKICAgICAgX3NldEVtaXR0ZXJJZChlbWl0dGVyKTsKICAgIH0KCiAgICB2YXIgZW1pdHRlcklkID0gX2dldEVtaXR0ZXJJZChlbWl0dGVyKTsKCiAgICBpZiAoIShlbWl0dGVySW5mbyA9IGVtaXR0ZXJzW2VtaXR0ZXJJZF0pKSB7CiAgICAgIGVtaXR0ZXJJbmZvID0gZW1pdHRlcnNbZW1pdHRlcklkXSA9IHsKICAgICAgICBlbWl0dGVyOiBlbWl0dGVyLAogICAgICAgIGNhbGxiYWNrczoge30KICAgICAgfTsKICAgIH0KCiAgICBpZiAoIShldmVudENhbGxiYWNrcyA9IGVtaXR0ZXJJbmZvLmNhbGxiYWNrc1tldmVudF0pKSB7CiAgICAgIGV2ZW50Q2FsbGJhY2tzID0gZW1pdHRlckluZm8uY2FsbGJhY2tzW2V2ZW50XSA9IFtdOwogICAgfQoKICAgIGV2ZW50Q2FsbGJhY2tzLnB1c2goY2FsbGJhY2spOyAvLyBGaW5hbGx5IHJlZ2lzdGVyIHRoZSBjYWxsYmFjayB0byB0aGUgZXZlbnQuCgogICAgYWRkRXZlbnRMaXN0ZW5lcih0aGlzLCBlbWl0dGVyLCBldmVudCwgY2FsbGJhY2ssIG9wdGlvbnMpOwogIH0sCgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgc3RvcExpc3RlbmluZzogZnVuY3Rpb24gc3RvcExpc3RlbmluZyhlbWl0dGVyLCBldmVudCwgY2FsbGJhY2spIHsKICAgIHZhciBlbWl0dGVycyA9IHRoaXNbX2xpc3RlbmluZ1RvXTsKCiAgICB2YXIgZW1pdHRlcklkID0gZW1pdHRlciAmJiBfZ2V0RW1pdHRlcklkKGVtaXR0ZXIpOwoKICAgIHZhciBlbWl0dGVySW5mbyA9IGVtaXR0ZXJzICYmIGVtaXR0ZXJJZCAmJiBlbWl0dGVyc1tlbWl0dGVySWRdOwogICAgdmFyIGV2ZW50Q2FsbGJhY2tzID0gZW1pdHRlckluZm8gJiYgZXZlbnQgJiYgZW1pdHRlckluZm8uY2FsbGJhY2tzW2V2ZW50XTsgLy8gU3RvcCBpZiBub3RoaW5nIGhhcyBiZWVuIGxpc3RlbmVkLgoKICAgIGlmICghZW1pdHRlcnMgfHwgZW1pdHRlciAmJiAhZW1pdHRlckluZm8gfHwgZXZlbnQgJiYgIWV2ZW50Q2FsbGJhY2tzKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8gQWxsIHBhcmFtcyBwcm92aWRlZC4gb2ZmKCkgdGhhdCBzaW5nbGUgY2FsbGJhY2suCgoKICAgIGlmIChjYWxsYmFjaykgewogICAgICByZW1vdmVFdmVudExpc3RlbmVyKHRoaXMsIGVtaXR0ZXIsIGV2ZW50LCBjYWxsYmFjayk7IC8vIFdlIG11c3QgcmVtb3ZlIGNhbGxiYWNrcyBhcyB3ZWxsIGluIG9yZGVyIHRvIHByZXZlbnQgbWVtb3J5IGxlYWtzLgogICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2NrZWRpdG9yL2NrZWRpdG9yNS9wdWxsLzg0ODAKCiAgICAgIHZhciBpbmRleCA9IGV2ZW50Q2FsbGJhY2tzLmluZGV4T2YoY2FsbGJhY2spOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIGlmIChldmVudENhbGxiYWNrcy5sZW5ndGggPT09IDEpIHsKICAgICAgICAgIGRlbGV0ZSBlbWl0dGVySW5mby5jYWxsYmFja3NbZXZlbnRdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZW1vdmVFdmVudExpc3RlbmVyKHRoaXMsIGVtaXR0ZXIsIGV2ZW50LCBjYWxsYmFjayk7CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vIE9ubHkgYGVtaXR0ZXJgIGFuZCBgZXZlbnRgIHByb3ZpZGVkLiBvZmYoKSBhbGwgY2FsbGJhY2tzIGZvciB0aGF0IGV2ZW50LgogICAgZWxzZSBpZiAoZXZlbnRDYWxsYmFja3MpIHsKICAgICAgICB3aGlsZSAoY2FsbGJhY2sgPSBldmVudENhbGxiYWNrcy5wb3AoKSkgewogICAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLCBlbWl0dGVyLCBldmVudCwgY2FsbGJhY2spOwogICAgICAgIH0KCiAgICAgICAgZGVsZXRlIGVtaXR0ZXJJbmZvLmNhbGxiYWNrc1tldmVudF07CiAgICAgIH0gLy8gT25seSBgZW1pdHRlcmAgcHJvdmlkZWQuIG9mZigpIGFsbCBldmVudHMgZm9yIHRoYXQgZW1pdHRlci4KICAgICAgZWxzZSBpZiAoZW1pdHRlckluZm8pIHsKICAgICAgICAgIGZvciAoZXZlbnQgaW4gZW1pdHRlckluZm8uY2FsbGJhY2tzKSB7CiAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZyhlbWl0dGVyLCBldmVudCk7CiAgICAgICAgICB9CgogICAgICAgICAgZGVsZXRlIGVtaXR0ZXJzW2VtaXR0ZXJJZF07CiAgICAgICAgfSAvLyBObyBwYXJhbXMgcHJvdmlkZWQuIG9mZigpIGFsbCBlbWl0dGVycy4KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZm9yIChlbWl0dGVySWQgaW4gZW1pdHRlcnMpIHsKICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoZW1pdHRlcnNbZW1pdHRlcklkXS5lbWl0dGVyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGVsZXRlIHRoaXNbX2xpc3RlbmluZ1RvXTsKICAgICAgICAgIH0KICB9LAoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogIGZpcmU6IGZ1bmN0aW9uIGZpcmUoZXZlbnRPckluZm8pIHsKICAgIHRyeSB7CiAgICAgIHZhciBldmVudEluZm8gPSBldmVudE9ySW5mbyBpbnN0YW5jZW9mIEV2ZW50SW5mbyA/IGV2ZW50T3JJbmZvIDogbmV3IEV2ZW50SW5mbyh0aGlzLCBldmVudE9ySW5mbyk7CiAgICAgIHZhciBldmVudCA9IGV2ZW50SW5mby5uYW1lOwogICAgICB2YXIgY2FsbGJhY2tzID0gZ2V0Q2FsbGJhY2tzRm9yRXZlbnQodGhpcywgZXZlbnQpOyAvLyBSZWNvcmQgdGhhdCB0aGUgZXZlbnQgcGFzc2VkIHRoaXMgZW1pdHRlciBvbiBpdHMgcGF0aC4KCiAgICAgIGV2ZW50SW5mby5wYXRoLnB1c2godGhpcyk7IC8vIEhhbmRsZSBldmVudCBsaXN0ZW5lciBjYWxsYmFja3MgZmlyc3QuCgogICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjIgPiAxID8gX2xlbjIgLSAxIDogMCksIF9rZXkyID0gMTsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykgewogICAgICAgIGFyZ3NbX2tleTIgLSAxXSA9IGFyZ3VtZW50c1tfa2V5Ml07CiAgICAgIH0KCiAgICAgIGlmIChjYWxsYmFja3MpIHsKICAgICAgICAvLyBBcmd1bWVudHMgcGFzc2VkIHRvIGVhY2ggY2FsbGJhY2suCiAgICAgICAgdmFyIGNhbGxiYWNrQXJncyA9IFtldmVudEluZm9dLmNvbmNhdChhcmdzKTsgLy8gQ29weWluZyBjYWxsYmFja3MgYXJyYXkgaXMgdGhlIGVhc2llc3QgYW5kIG1vc3Qgc2VjdXJlIHdheSBvZiBwcmV2ZW50aW5nIGluZmluaXRlIGxvb3BzLCB3aGVuIGV2ZW50IGNhbGxiYWNrcwogICAgICAgIC8vIGFyZSBhZGRlZCB3aGlsZSBwcm9jZXNzaW5nIG90aGVyIGNhbGxiYWNrcy4gUHJldmlvdXMgc29sdXRpb24gaW52b2x2ZWQgYWRkaW5nIGNvdW50ZXJzICh1bmlxdWUgaWRzKSBidXQKICAgICAgICAvLyBmYWlsZWQgaWYgY2FsbGJhY2tzIHdlcmUgYWRkZWQgdG8gdGhlIHF1ZXVlIGJlZm9yZSBjdXJyZW50bHkgcHJvY2Vzc2VkIGNhbGxiYWNrLgogICAgICAgIC8vIElmIHRoaXMgcHJvdmVzIHRvIGJlIHRvbyBpbmVmZmljaWVudCwgYW5vdGhlciBtZXRob2QgaXMgdG8gY2hhbmdlIGAub24oKWAgc28gY2FsbGJhY2tzIGFyZSBzdG9yZWQgaWYgc2FtZQogICAgICAgIC8vIGV2ZW50IGlzIGN1cnJlbnRseSBwcm9jZXNzZWQuIFRoZW4sIGAuZmlyZSgpYCBhdCB0aGUgZW5kLCB3b3VsZCBoYXZlIHRvIGFkZCBhbGwgc3RvcmVkIGV2ZW50cy4KCiAgICAgICAgY2FsbGJhY2tzID0gQXJyYXkuZnJvbShjYWxsYmFja3MpOwoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhbGxiYWNrcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY2FsbGJhY2tzW2ldLmNhbGxiYWNrLmFwcGx5KHRoaXMsIGNhbGxiYWNrQXJncyk7IC8vIFJlbW92ZSB0aGUgY2FsbGJhY2sgZnJvbSBmdXR1cmUgcmVxdWVzdHMgaWYgb2ZmKCkgaGFzIGJlZW4gY2FsbGVkLgoKICAgICAgICAgIGlmIChldmVudEluZm8ub2ZmLmNhbGxlZCkgewogICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGNhbGxlZCBtYXJrIGZvciB0aGUgbmV4dCBjYWxscy4KICAgICAgICAgICAgZGVsZXRlIGV2ZW50SW5mby5vZmYuY2FsbGVkOwoKICAgICAgICAgICAgdGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgY2FsbGJhY2tzW2ldLmNhbGxiYWNrKTsKICAgICAgICAgIH0gLy8gRG8gbm90IGV4ZWN1dGUgbmV4dCBjYWxsYmFja3MgaWYgc3RvcCgpIHdhcyBjYWxsZWQuCgoKICAgICAgICAgIGlmIChldmVudEluZm8uc3RvcC5jYWxsZWQpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIERlbGVnYXRlIGV2ZW50IHRvIG90aGVyIGVtaXR0ZXJzIGlmIG5lZWRlZC4KCgogICAgICBpZiAodGhpcy5fZGVsZWdhdGlvbnMpIHsKICAgICAgICB2YXIgZGVzdGluYXRpb25zID0gdGhpcy5fZGVsZWdhdGlvbnMuZ2V0KGV2ZW50KTsKCiAgICAgICAgdmFyIHBhc3NBbGxEZXN0aW5hdGlvbnMgPSB0aGlzLl9kZWxlZ2F0aW9ucy5nZXQoJyonKTsKCiAgICAgICAgaWYgKGRlc3RpbmF0aW9ucykgewogICAgICAgICAgZmlyZURlbGVnYXRlZEV2ZW50cyhkZXN0aW5hdGlvbnMsIGV2ZW50SW5mbywgYXJncyk7CiAgICAgICAgfQoKICAgICAgICBpZiAocGFzc0FsbERlc3RpbmF0aW9ucykgewogICAgICAgICAgZmlyZURlbGVnYXRlZEV2ZW50cyhwYXNzQWxsRGVzdGluYXRpb25zLCBldmVudEluZm8sIGFyZ3MpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGV2ZW50SW5mby5yZXR1cm47CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgLy8gQGlmIENLX0RFQlVHIC8vIHRocm93IGVycjsKCiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICAgIENLRWRpdG9yRXJyb3IucmV0aHJvd1VuZXhwZWN0ZWRFcnJvcihlcnIsIHRoaXMpOwogICAgfQogIH0sCgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgZGVsZWdhdGU6IGZ1bmN0aW9uIGRlbGVnYXRlKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGV2ZW50cyA9IG5ldyBBcnJheShfbGVuMyksIF9rZXkzID0gMDsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykgewogICAgICBldmVudHNbX2tleTNdID0gYXJndW1lbnRzW19rZXkzXTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICB0bzogZnVuY3Rpb24gdG8oZW1pdHRlciwgbmFtZU9yRnVuY3Rpb24pIHsKICAgICAgICBpZiAoIV90aGlzLl9kZWxlZ2F0aW9ucykgewogICAgICAgICAgX3RoaXMuX2RlbGVnYXRpb25zID0gbmV3IE1hcCgpOwogICAgICAgIH0gLy8gT3JpZ2luYWxseSB0aGVyZSB3YXMgYSBmb3IuLm9mIGxvb3Agd2hpY2ggdW5mb3J0dW5hdGVseSBjYXVzZWQgYW4gZXJyb3IgaW4gQmFiZWwgdGhhdCBkaWRuJ3QgYWxsb3cKICAgICAgICAvLyBidWlsZCBhbiBhcHBsaWNhdGlvbi4gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vY2tlZGl0b3IvY2tlZGl0b3I1LXJlYWN0L2lzc3Vlcy80MC4KCgogICAgICAgIGV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChldmVudE5hbWUpIHsKICAgICAgICAgIHZhciBkZXN0aW5hdGlvbnMgPSBfdGhpcy5fZGVsZWdhdGlvbnMuZ2V0KGV2ZW50TmFtZSk7CgogICAgICAgICAgaWYgKCFkZXN0aW5hdGlvbnMpIHsKICAgICAgICAgICAgX3RoaXMuX2RlbGVnYXRpb25zLnNldChldmVudE5hbWUsIG5ldyBNYXAoW1tlbWl0dGVyLCBuYW1lT3JGdW5jdGlvbl1dKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZXN0aW5hdGlvbnMuc2V0KGVtaXR0ZXIsIG5hbWVPckZ1bmN0aW9uKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfTsKICB9LAoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogIHN0b3BEZWxlZ2F0aW5nOiBmdW5jdGlvbiBzdG9wRGVsZWdhdGluZyhldmVudCwgZW1pdHRlcikgewogICAgaWYgKCF0aGlzLl9kZWxlZ2F0aW9ucykgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKCFldmVudCkgewogICAgICB0aGlzLl9kZWxlZ2F0aW9ucy5jbGVhcigpOwogICAgfSBlbHNlIGlmICghZW1pdHRlcikgewogICAgICB0aGlzLl9kZWxlZ2F0aW9ucy5kZWxldGUoZXZlbnQpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGRlc3RpbmF0aW9ucyA9IHRoaXMuX2RlbGVnYXRpb25zLmdldChldmVudCk7CgogICAgICBpZiAoZGVzdGluYXRpb25zKSB7CiAgICAgICAgZGVzdGluYXRpb25zLmRlbGV0ZShlbWl0dGVyKTsKICAgICAgfQogICAgfQogIH0sCgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgX2FkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uIF9hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBjYWxsYmFjaywgb3B0aW9ucykgewogICAgY3JlYXRlRXZlbnROYW1lc3BhY2UodGhpcywgZXZlbnQpOwogICAgdmFyIGxpc3RzID0gZ2V0Q2FsbGJhY2tzTGlzdHNGb3JOYW1lc3BhY2UodGhpcywgZXZlbnQpOwogICAgdmFyIHByaW9yaXR5ID0gcHJpb3JpdGllcy5nZXQob3B0aW9ucy5wcmlvcml0eSk7CiAgICB2YXIgY2FsbGJhY2tEZWZpbml0aW9uID0gewogICAgICBjYWxsYmFjazogY2FsbGJhY2ssCiAgICAgIHByaW9yaXR5OiBwcmlvcml0eQogICAgfTsgLy8gQWRkIHRoZSBjYWxsYmFjayB0byBhbGwgY2FsbGJhY2tzIGxpc3QuCgogICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGxpc3RzKSwKICAgICAgICBfc3RlcDsKCiAgICB0cnkgewogICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgIHZhciBjYWxsYmFja3MgPSBfc3RlcC52YWx1ZTsKICAgICAgICAvLyBBZGQgdGhlIGNhbGxiYWNrIHRvIHRoZSBsaXN0IGluIHRoZSByaWdodCBwcmlvcml0eSBwb3NpdGlvbi4KICAgICAgICB2YXIgYWRkZWQgPSBmYWxzZTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChjYWxsYmFja3NbaV0ucHJpb3JpdHkgPCBwcmlvcml0eSkgewogICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGksIDAsIGNhbGxiYWNrRGVmaW5pdGlvbik7CiAgICAgICAgICAgIGFkZGVkID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBBZGQgYXQgdGhlIGVuZCwgaWYgcmlnaHQgcGxhY2Ugd2FzIG5vdCBmb3VuZC4KCgogICAgICAgIGlmICghYWRkZWQpIHsKICAgICAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrRGVmaW5pdGlvbik7CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgIH0gZmluYWxseSB7CiAgICAgIF9pdGVyYXRvci5mKCk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICBfcmVtb3ZlRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24gX3JlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGNhbGxiYWNrKSB7CiAgICB2YXIgbGlzdHMgPSBnZXRDYWxsYmFja3NMaXN0c0Zvck5hbWVzcGFjZSh0aGlzLCBldmVudCk7CgogICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihsaXN0cyksCiAgICAgICAgX3N0ZXAyOwoKICAgIHRyeSB7CiAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgdmFyIGNhbGxiYWNrcyA9IF9zdGVwMi52YWx1ZTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChjYWxsYmFja3NbaV0uY2FsbGJhY2sgPT0gY2FsbGJhY2spIHsKICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBjYWxsYmFjayBmcm9tIHRoZSBsaXN0IChmaXhpbmcgdGhlIG5leHQgaW5kZXgpLgogICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGksIDEpOwogICAgICAgICAgICBpLS07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICB9IGZpbmFsbHkgewogICAgICBfaXRlcmF0b3IyLmYoKTsKICAgIH0KICB9Cn07CmV4cG9ydCBkZWZhdWx0IEVtaXR0ZXJNaXhpbjsKLyoqCiAqIEVtaXR0ZXIvbGlzdGVuZXIgaW50ZXJmYWNlLgogKgogKiBDYW4gYmUgZWFzaWx5IGltcGxlbWVudGVkIGJ5IGEgY2xhc3MgYnkgbWl4aW5nIHRoZSB7QGxpbmsgbW9kdWxlOnV0aWxzL2VtaXR0ZXJtaXhpbn5FbWl0dGVyTWl4aW59IG1peGluLgogKgogKiBSZWFkIG1vcmUgYWJvdXQgdGhlIHVzYWdlIG9mIHRoaXMgaW50ZXJmYWNlIGluIHRoZToKICogKiB7QGdsaW5rIGZyYW1ld29yay9ndWlkZXMvYXJjaGl0ZWN0dXJlL2NvcmUtZWRpdG9yLWFyY2hpdGVjdHVyZSNldmVudC1zeXN0ZW0tYW5kLW9ic2VydmFibGVzIEV2ZW50IHN5c3RlbSBhbmQgb2JzZXJ2YWJsZXN9CiAqIHNlY3Rpb24gb2YgdGhlIHtAZ2xpbmsgZnJhbWV3b3JrL2d1aWRlcy9hcmNoaXRlY3R1cmUvY29yZS1lZGl0b3ItYXJjaGl0ZWN0dXJlIENvcmUgZWRpdG9yIGFyY2hpdGVjdHVyZX0gZ3VpZGUuCiAqICoge0BnbGluayBmcmFtZXdvcmsvZ3VpZGVzL2RlZXAtZGl2ZS9ldmVudC1zeXN0ZW0gRXZlbnQgc3lzdGVtfSBkZWVwIGRpdmUgZ3VpZGUuCiAqCiAqIEBpbnRlcmZhY2UgRW1pdHRlcgogKi8KCi8qKgogKiBSZWdpc3RlcnMgYSBjYWxsYmFjayBmdW5jdGlvbiB0byBiZSBleGVjdXRlZCB3aGVuIGFuIGV2ZW50IGlzIGZpcmVkLgogKgogKiBTaG9ydGhhbmQgZm9yIHtAbGluayAjbGlzdGVuVG8gYHRoaXMubGlzdGVuVG8oIHRoaXMsIGV2ZW50LCBjYWxsYmFjaywgb3B0aW9ucyApYH0gKGl0IG1ha2VzIHRoZSBlbWl0dGVyCiAqIGxpc3RlbiBvbiBpdHNlbGYpLgogKgogKiBAbWV0aG9kICNvbgogKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgVGhlIG5hbWUgb2YgdGhlIGV2ZW50LgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIG9uIGV2ZW50LgogKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnM9e31dIEFkZGl0aW9uYWwgb3B0aW9ucy4KICogQHBhcmFtIHttb2R1bGU6dXRpbHMvcHJpb3JpdGllc35Qcmlvcml0eVN0cmluZ3xOdW1iZXJ9IFtvcHRpb25zLnByaW9yaXR5PSdub3JtYWwnXSBUaGUgcHJpb3JpdHkgb2YgdGhpcyBldmVudCBjYWxsYmFjay4gVGhlIGhpZ2hlcgogKiB0aGUgcHJpb3JpdHkgdmFsdWUgdGhlIHNvb25lciB0aGUgY2FsbGJhY2sgd2lsbCBiZSBmaXJlZC4gRXZlbnRzIGhhdmluZyB0aGUgc2FtZSBwcmlvcml0eSBhcmUgY2FsbGVkIGluIHRoZQogKiBvcmRlciB0aGV5IHdlcmUgYWRkZWQuCiAqLwoKLyoqCiAqIFJlZ2lzdGVycyBhIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGJlIGV4ZWN1dGVkIG9uIHRoZSBuZXh0IHRpbWUgdGhlIGV2ZW50IGlzIGZpcmVkIG9ubHkuIFRoaXMgaXMgc2ltaWxhciB0bwogKiBjYWxsaW5nIHtAbGluayAjb259IGZvbGxvd2VkIGJ5IHtAbGluayAjb2ZmfSBpbiB0aGUgY2FsbGJhY2suCiAqCiAqIEBtZXRob2QgI29uY2UKICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50IFRoZSBuYW1lIG9mIHRoZSBldmVudC4KICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBvbiBldmVudC4KICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zPXt9XSBBZGRpdGlvbmFsIG9wdGlvbnMuCiAqIEBwYXJhbSB7bW9kdWxlOnV0aWxzL3ByaW9yaXRpZXN+UHJpb3JpdHlTdHJpbmd8TnVtYmVyfSBbb3B0aW9ucy5wcmlvcml0eT0nbm9ybWFsJ10gVGhlIHByaW9yaXR5IG9mIHRoaXMgZXZlbnQgY2FsbGJhY2suIFRoZSBoaWdoZXIKICogdGhlIHByaW9yaXR5IHZhbHVlIHRoZSBzb29uZXIgdGhlIGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQuIEV2ZW50cyBoYXZpbmcgdGhlIHNhbWUgcHJpb3JpdHkgYXJlIGNhbGxlZCBpbiB0aGUKICogb3JkZXIgdGhleSB3ZXJlIGFkZGVkLgogKi8KCi8qKgogKiBTdG9wcyBleGVjdXRpbmcgdGhlIGNhbGxiYWNrIG9uIHRoZSBnaXZlbiBldmVudC4KICogU2hvcnRoYW5kIGZvciB7QGxpbmsgI3N0b3BMaXN0ZW5pbmcgYHRoaXMuc3RvcExpc3RlbmluZyggdGhpcywgZXZlbnQsIGNhbGxiYWNrIClgfS4KICoKICogQG1ldGhvZCAjb2ZmCiAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCBUaGUgbmFtZSBvZiB0aGUgZXZlbnQuCiAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0byBzdG9wIGJlaW5nIGNhbGxlZC4KICovCgovKioKICogUmVnaXN0ZXJzIGEgY2FsbGJhY2sgZnVuY3Rpb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBhbiBldmVudCBpcyBmaXJlZCBpbiBhIHNwZWNpZmljIChlbWl0dGVyKSBvYmplY3QuCiAqCiAqIEV2ZW50cyBjYW4gYmUgZ3JvdXBlZCBpbiBuYW1lc3BhY2VzIHVzaW5nIGA6YC4KICogV2hlbiBuYW1lc3BhY2VkIGV2ZW50IGlzIGZpcmVkLCBpdCBhZGRpdGlvbmFsbHkgZmlyZXMgYWxsIGNhbGxiYWNrcyBmb3IgdGhhdCBuYW1lc3BhY2UuCiAqCiAqCQkvLyBteUVtaXR0ZXIub24oIC4uLiApIGlzIGEgc2hvcnRoYW5kIGZvciBteUVtaXR0ZXIubGlzdGVuVG8oIG15RW1pdHRlciwgLi4uICkuCiAqCQlteUVtaXR0ZXIub24oICdteUdyb3VwJywgZ2VuZXJpY0NhbGxiYWNrICk7CiAqCQlteUVtaXR0ZXIub24oICdteUdyb3VwOm15RXZlbnQnLCBzcGVjaWZpY0NhbGxiYWNrICk7CiAqCiAqCQkvLyBnZW5lcmljQ2FsbGJhY2sgaXMgZmlyZWQuCiAqCQlteUVtaXR0ZXIuZmlyZSggJ215R3JvdXAnICk7CiAqCQkvLyBib3RoIGdlbmVyaWNDYWxsYmFjayBhbmQgc3BlY2lmaWNDYWxsYmFjayBhcmUgZmlyZWQuCiAqCQlteUVtaXR0ZXIuZmlyZSggJ215R3JvdXA6bXlFdmVudCcgKTsKICoJCS8vIGdlbmVyaWNDYWxsYmFjayBpcyBmaXJlZCBldmVuIHRob3VnaCB0aGVyZSBhcmUgbm8gY2FsbGJhY2tzIGZvciAiZm9vIi4KICoJCW15RW1pdHRlci5maXJlKCAnbXlHcm91cDpmb28nICk7CiAqCiAqIEFuIGV2ZW50IGNhbGxiYWNrIGNhbiB7QGxpbmsgbW9kdWxlOnV0aWxzL2V2ZW50aW5mb35FdmVudEluZm8jc3RvcCBzdG9wIHRoZSBldmVudH0gYW5kCiAqIHNldCB0aGUge0BsaW5rIG1vZHVsZTp1dGlscy9ldmVudGluZm9+RXZlbnRJbmZvI3JldHVybiByZXR1cm4gdmFsdWV9IG9mIHRoZSB7QGxpbmsgI2ZpcmV9IG1ldGhvZC4KICoKICogQG1ldGhvZCAjbGlzdGVuVG8KICogQHBhcmFtIHttb2R1bGU6dXRpbHMvZW1pdHRlcm1peGlufkVtaXR0ZXJ9IGVtaXR0ZXIgVGhlIG9iamVjdCB0aGF0IGZpcmVzIHRoZSBldmVudC4KICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50IFRoZSBuYW1lIG9mIHRoZSBldmVudC4KICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBvbiBldmVudC4KICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zPXt9XSBBZGRpdGlvbmFsIG9wdGlvbnMuCiAqIEBwYXJhbSB7bW9kdWxlOnV0aWxzL3ByaW9yaXRpZXN+UHJpb3JpdHlTdHJpbmd8TnVtYmVyfSBbb3B0aW9ucy5wcmlvcml0eT0nbm9ybWFsJ10gVGhlIHByaW9yaXR5IG9mIHRoaXMgZXZlbnQgY2FsbGJhY2suIFRoZSBoaWdoZXIKICogdGhlIHByaW9yaXR5IHZhbHVlIHRoZSBzb29uZXIgdGhlIGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQuIEV2ZW50cyBoYXZpbmcgdGhlIHNhbWUgcHJpb3JpdHkgYXJlIGNhbGxlZCBpbiB0aGUKICogb3JkZXIgdGhleSB3ZXJlIGFkZGVkLgogKi8KCi8qKgogKiBTdG9wcyBsaXN0ZW5pbmcgZm9yIGV2ZW50cy4gSXQgY2FuIGJlIHVzZWQgYXQgZGlmZmVyZW50IGxldmVsczoKICoKICogKiBUbyBzdG9wIGxpc3RlbmluZyB0byBhIHNwZWNpZmljIGNhbGxiYWNrLgogKiAqIFRvIHN0b3AgbGlzdGVuaW5nIHRvIGEgc3BlY2lmaWMgZXZlbnQuCiAqICogVG8gc3RvcCBsaXN0ZW5pbmcgdG8gYWxsIGV2ZW50cyBmaXJlZCBieSBhIHNwZWNpZmljIG9iamVjdC4KICogKiBUbyBzdG9wIGxpc3RlbmluZyB0byBhbGwgZXZlbnRzIGZpcmVkIGJ5IGFsbCBvYmplY3RzLgogKgogKiBAbWV0aG9kICNzdG9wTGlzdGVuaW5nCiAqIEBwYXJhbSB7bW9kdWxlOnV0aWxzL2VtaXR0ZXJtaXhpbn5FbWl0dGVyfSBbZW1pdHRlcl0gVGhlIG9iamVjdCB0byBzdG9wIGxpc3RlbmluZyB0by4gSWYgb21pdHRlZCwgc3RvcHMgaXQgZm9yIGFsbCBvYmplY3RzLgogKiBAcGFyYW0ge1N0cmluZ30gW2V2ZW50XSAoUmVxdWlyZXMgdGhlIGBlbWl0dGVyYCkgVGhlIG5hbWUgb2YgdGhlIGV2ZW50IHRvIHN0b3AgbGlzdGVuaW5nIHRvLiBJZiBvbWl0dGVkLCBzdG9wcyBpdAogKiBmb3IgYWxsIGV2ZW50cyBmcm9tIGBlbWl0dGVyYC4KICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrXSAoUmVxdWlyZXMgdGhlIGBldmVudGApIFRoZSBmdW5jdGlvbiB0byBiZSByZW1vdmVkIGZyb20gdGhlIGNhbGwgbGlzdCBmb3IgdGhlIGdpdmVuCiAqIGBldmVudGAuCiAqLwoKLyoqCiAqIEZpcmVzIGFuIGV2ZW50LCBleGVjdXRpbmcgYWxsIGNhbGxiYWNrcyByZWdpc3RlcmVkIGZvciBpdC4KICoKICogVGhlIGZpcnN0IHBhcmFtZXRlciBwYXNzZWQgdG8gY2FsbGJhY2tzIGlzIGFuIHtAbGluayBtb2R1bGU6dXRpbHMvZXZlbnRpbmZvfkV2ZW50SW5mb30gb2JqZWN0LAogKiBmb2xsb3dlZCBieSB0aGUgb3B0aW9uYWwgYGFyZ3NgIHByb3ZpZGVkIGluIHRoZSBgZmlyZSgpYCBtZXRob2QgY2FsbC4KICoKICogQG1ldGhvZCAjZmlyZQogKiBAcGFyYW0ge1N0cmluZ3xtb2R1bGU6dXRpbHMvZXZlbnRpbmZvfkV2ZW50SW5mb30gZXZlbnRPckluZm8gVGhlIG5hbWUgb2YgdGhlIGV2ZW50IG9yIGBFdmVudEluZm9gIG9iamVjdCBpZiBldmVudCBpcyBkZWxlZ2F0ZWQuCiAqIEBwYXJhbSB7Li4uKn0gW2FyZ3NdIEFkZGl0aW9uYWwgYXJndW1lbnRzIHRvIGJlIHBhc3NlZCB0byB0aGUgY2FsbGJhY2tzLgogKiBAcmV0dXJucyB7Kn0gQnkgZGVmYXVsdCB0aGUgbWV0aG9kIHJldHVybnMgYHVuZGVmaW5lZGAuIEhvd2V2ZXIsIHRoZSByZXR1cm4gdmFsdWUgY2FuIGJlIGNoYW5nZWQgYnkgbGlzdGVuZXJzCiAqIHRocm91Z2ggbW9kaWZpY2F0aW9uIG9mIHRoZSB7QGxpbmsgbW9kdWxlOnV0aWxzL2V2ZW50aW5mb35FdmVudEluZm8jcmV0dXJuIGBldnQucmV0dXJuYH0ncyBwcm9wZXJ0eSAodGhlIGV2ZW50IGluZm8KICogaXMgdGhlIGZpcnN0IHBhcmFtIG9mIGV2ZXJ5IGNhbGxiYWNrKS4KICovCgovKioKICogRGVsZWdhdGVzIHNlbGVjdGVkIGV2ZW50cyB0byBhbm90aGVyIHtAbGluayBtb2R1bGU6dXRpbHMvZW1pdHRlcm1peGlufkVtaXR0ZXJ9LiBGb3IgaW5zdGFuY2U6CiAqCiAqCQllbWl0dGVyQS5kZWxlZ2F0ZSggJ2V2ZW50WCcgKS50byggZW1pdHRlckIgKTsKICoJCWVtaXR0ZXJBLmRlbGVnYXRlKCAnZXZlbnRYJywgJ2V2ZW50WScgKS50byggZW1pdHRlckMgKTsKICoKICogdGhlbiBgZXZlbnRYYCBpcyBkZWxlZ2F0ZWQgKGZpcmVkIGJ5KSBgZW1pdHRlckJgIGFuZCBgZW1pdHRlckNgIGFsb25nIHdpdGggYGRhdGFgOgogKgogKgkJZW1pdHRlckEuZmlyZSggJ2V2ZW50WCcsIGRhdGEgKTsKICoKICogYW5kIGBldmVudFlgIGlzIGRlbGVnYXRlZCAoZmlyZWQgYnkpIGBlbWl0dGVyQ2AgYWxvbmcgd2l0aCBgZGF0YWA6CiAqCiAqCQllbWl0dGVyQS5maXJlKCAnZXZlbnRZJywgZGF0YSApOwogKgogKiBAbWV0aG9kICNkZWxlZ2F0ZQogKiBAcGFyYW0gey4uLlN0cmluZ30gZXZlbnRzIEV2ZW50IG5hbWVzIHRoYXQgd2lsbCBiZSBkZWxlZ2F0ZWQgdG8gYW5vdGhlciBlbWl0dGVyLgogKiBAcmV0dXJucyB7bW9kdWxlOnV0aWxzL2VtaXR0ZXJtaXhpbn5FbWl0dGVyTWl4aW5EZWxlZ2F0ZUNoYWlufQogKi8KCi8qKgogKiBTdG9wcyBkZWxlZ2F0aW5nIGV2ZW50cy4gSXQgY2FuIGJlIHVzZWQgYXQgZGlmZmVyZW50IGxldmVsczoKICoKICogKiBUbyBzdG9wIGRlbGVnYXRpbmcgYWxsIGV2ZW50cy4KICogKiBUbyBzdG9wIGRlbGVnYXRpbmcgYSBzcGVjaWZpYyBldmVudCB0byBhbGwgZW1pdHRlcnMuCiAqICogVG8gc3RvcCBkZWxlZ2F0aW5nIGEgc3BlY2lmaWMgZXZlbnQgdG8gYSBzcGVjaWZpYyBlbWl0dGVyLgogKgogKiBAbWV0aG9kICNzdG9wRGVsZWdhdGluZwogKiBAcGFyYW0ge1N0cmluZ30gW2V2ZW50XSBUaGUgbmFtZSBvZiB0aGUgZXZlbnQgdG8gc3RvcCBkZWxlZ2F0aW5nLiBJZiBvbWl0dGVkLCBzdG9wcyBpdCBhbGwgZGVsZWdhdGlvbnMuCiAqIEBwYXJhbSB7bW9kdWxlOnV0aWxzL2VtaXR0ZXJtaXhpbn5FbWl0dGVyfSBbZW1pdHRlcl0gKHJlcXVpcmVzIGBldmVudGApIFRoZSBvYmplY3QgdG8gc3RvcCBkZWxlZ2F0aW5nIGEgcGFydGljdWxhciBldmVudCB0by4KICogSWYgb21pdHRlZCwgc3RvcHMgZGVsZWdhdGlvbiBvZiBgZXZlbnRgIHRvIGFsbCBlbWl0dGVycy4KICovCgovKioKICogQWRkcyBjYWxsYmFjayB0byBlbWl0dGVyIGZvciBnaXZlbiBldmVudC4KICoKICogQHByb3RlY3RlZAogKiBAbWV0aG9kICNfYWRkRXZlbnRMaXN0ZW5lcgogKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgVGhlIG5hbWUgb2YgdGhlIGV2ZW50LgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIG9uIGV2ZW50LgogKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnM9e31dIEFkZGl0aW9uYWwgb3B0aW9ucy4KICogQHBhcmFtIHttb2R1bGU6dXRpbHMvcHJpb3JpdGllc35Qcmlvcml0eVN0cmluZ3xOdW1iZXJ9IFtvcHRpb25zLnByaW9yaXR5PSdub3JtYWwnXSBUaGUgcHJpb3JpdHkgb2YgdGhpcyBldmVudCBjYWxsYmFjay4gVGhlIGhpZ2hlcgogKiB0aGUgcHJpb3JpdHkgdmFsdWUgdGhlIHNvb25lciB0aGUgY2FsbGJhY2sgd2lsbCBiZSBmaXJlZC4gRXZlbnRzIGhhdmluZyB0aGUgc2FtZSBwcmlvcml0eSBhcmUgY2FsbGVkIGluIHRoZQogKiBvcmRlciB0aGV5IHdlcmUgYWRkZWQuCiAqLwoKLyoqCiAqIFJlbW92ZXMgY2FsbGJhY2sgZnJvbSBlbWl0dGVyIGZvciBnaXZlbiBldmVudC4KICoKICogQHByb3RlY3RlZAogKiBAbWV0aG9kICNfcmVtb3ZlRXZlbnRMaXN0ZW5lcgogKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgVGhlIG5hbWUgb2YgdGhlIGV2ZW50LgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gc3RvcCBiZWluZyBjYWxsZWQuCiAqLwoKLyoqCiAqIENoZWNrcyBpZiBgbGlzdGVuaW5nRW1pdHRlcmAgbGlzdGVucyB0byBhbiBlbWl0dGVyIHdpdGggZ2l2ZW4gYGxpc3RlbmVkVG9FbWl0dGVySWRgIGFuZCBpZiBzbywgcmV0dXJucyB0aGF0IGVtaXR0ZXIuCiAqIElmIG5vdCwgcmV0dXJucyBgbnVsbGAuCiAqCiAqIEBwcm90ZWN0ZWQKICogQHBhcmFtIHttb2R1bGU6dXRpbHMvZW1pdHRlcm1peGlufkVtaXR0ZXJ9IGxpc3RlbmluZ0VtaXR0ZXIgQW4gZW1pdHRlciB0aGF0IGxpc3RlbnMuCiAqIEBwYXJhbSB7U3RyaW5nfSBsaXN0ZW5lZFRvRW1pdHRlcklkIFVuaXF1ZSBlbWl0dGVyIGlkIG9mIGVtaXR0ZXIgbGlzdGVuZWQgdG8uCiAqIEByZXR1cm5zIHttb2R1bGU6dXRpbHMvZW1pdHRlcm1peGlufkVtaXR0ZXJ8bnVsbH0KICovCgpleHBvcnQgZnVuY3Rpb24gX2dldEVtaXR0ZXJMaXN0ZW5lZFRvKGxpc3RlbmluZ0VtaXR0ZXIsIGxpc3RlbmVkVG9FbWl0dGVySWQpIHsKICBpZiAobGlzdGVuaW5nRW1pdHRlcltfbGlzdGVuaW5nVG9dICYmIGxpc3RlbmluZ0VtaXR0ZXJbX2xpc3RlbmluZ1RvXVtsaXN0ZW5lZFRvRW1pdHRlcklkXSkgewogICAgcmV0dXJuIGxpc3RlbmluZ0VtaXR0ZXJbX2xpc3RlbmluZ1RvXVtsaXN0ZW5lZFRvRW1pdHRlcklkXS5lbWl0dGVyOwogIH0KCiAgcmV0dXJuIG51bGw7Cn0KLyoqCiAqIFNldHMgZW1pdHRlcidzIHVuaXF1ZSBpZC4KICoKICogKipOb3RlOioqIGBfZW1pdHRlcklkYCBjYW4gYmUgc2V0IG9ubHkgb25jZS4KICoKICogQHByb3RlY3RlZAogKiBAcGFyYW0ge21vZHVsZTp1dGlscy9lbWl0dGVybWl4aW5+RW1pdHRlcn0gZW1pdHRlciBBbiBlbWl0dGVyIGZvciB3aGljaCBpZCB3aWxsIGJlIHNldC4KICogQHBhcmFtIHtTdHJpbmd9IFtpZF0gVW5pcXVlIGlkIHRvIHNldC4gSWYgbm90IHBhc3NlZCwgcmFuZG9tIHVuaXF1ZSBpZCB3aWxsIGJlIHNldC4KICovCgpleHBvcnQgZnVuY3Rpb24gX3NldEVtaXR0ZXJJZChlbWl0dGVyLCBpZCkgewogIGlmICghZW1pdHRlcltfZW1pdHRlcklkXSkgewogICAgZW1pdHRlcltfZW1pdHRlcklkXSA9IGlkIHx8IHVpZCgpOwogIH0KfQovKioKICogUmV0dXJucyBlbWl0dGVyJ3MgdW5pcXVlIGlkLgogKgogKiBAcHJvdGVjdGVkCiAqIEBwYXJhbSB7bW9kdWxlOnV0aWxzL2VtaXR0ZXJtaXhpbn5FbWl0dGVyfSBlbWl0dGVyIEFuIGVtaXR0ZXIgd2hpY2ggaWQgd2lsbCBiZSByZXR1cm5lZC4KICovCgpleHBvcnQgZnVuY3Rpb24gX2dldEVtaXR0ZXJJZChlbWl0dGVyKSB7CiAgcmV0dXJuIGVtaXR0ZXJbX2VtaXR0ZXJJZF07Cn0gLy8gR2V0cyB0aGUgaW50ZXJuYWwgYF9ldmVudHNgIHByb3BlcnR5IG9mIHRoZSBnaXZlbiBvYmplY3QuCi8vIGBfZXZlbnRzYCBwcm9wZXJ0eSBzdG9yZSBhbGwgbGlzdHMgd2l0aCBjYWxsYmFja3MgZm9yIHJlZ2lzdGVyZWQgZXZlbnQgbmFtZXMuCi8vIElmIHRoZXJlIHdlcmUgbm8gZXZlbnRzIHJlZ2lzdGVyZWQgb24gdGhlIG9iamVjdCwgZW1wdHkgYF9ldmVudHNgIG9iamVjdCBpcyBjcmVhdGVkLgoKZnVuY3Rpb24gZ2V0RXZlbnRzKHNvdXJjZSkgewogIGlmICghc291cmNlLl9ldmVudHMpIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzb3VyY2UsICdfZXZlbnRzJywgewogICAgICB2YWx1ZToge30KICAgIH0pOwogIH0KCiAgcmV0dXJuIHNvdXJjZS5fZXZlbnRzOwp9IC8vIENyZWF0ZXMgZXZlbnQgbm9kZSBmb3IgZ2VuZXJpYy1zcGVjaWZpYyBldmVudHMgcmVsYXRpb24gYXJjaGl0ZWN0dXJlLgoKCmZ1bmN0aW9uIG1ha2VFdmVudE5vZGUoKSB7CiAgcmV0dXJuIHsKICAgIGNhbGxiYWNrczogW10sCiAgICBjaGlsZEV2ZW50czogW10KICB9Owp9IC8vIENyZWF0ZXMgYW4gYXJjaGl0ZWN0dXJlIGZvciBnZW5lcmljLXNwZWNpZmljIGV2ZW50cyByZWxhdGlvbi4KLy8gSWYgbmVlZGVkLCBjcmVhdGVzIGFsbCBldmVudHMgZm9yIGdpdmVuIGV2ZW50TmFtZSwgaS5lLiBpZiB0aGUgZmlyc3QgcmVnaXN0ZXJlZCBldmVudAovLyBpcyBmb286YmFyOmFiYywgaXQgd2lsbCBjcmVhdGUgZm9vOmJhcjphYmMsIGZvbzpiYXIgYW5kIGZvbyBldmVudCBhbmQgdGllIHRoZW0gdG9nZXRoZXIuCi8vIEl0IGFsc28gY29waWVzIGNhbGxiYWNrcyBmcm9tIG1vcmUgZ2VuZXJpYyBldmVudHMgdG8gbW9yZSBzcGVjaWZpYyBldmVudHMgd2hlbgovLyBzcGVjaWZpYyBldmVudHMgYXJlIGNyZWF0ZWQuCgoKZnVuY3Rpb24gY3JlYXRlRXZlbnROYW1lc3BhY2Uoc291cmNlLCBldmVudE5hbWUpIHsKICB2YXIgZXZlbnRzID0gZ2V0RXZlbnRzKHNvdXJjZSk7IC8vIEZpcnN0LCBjaGVjayBpZiB0aGUgZXZlbnQgd2Ugd2FudCB0byBhZGQgdG8gdGhlIHN0cnVjdHVyZSBhbHJlYWR5IGV4aXN0cy4KCiAgaWYgKGV2ZW50c1tldmVudE5hbWVdKSB7CiAgICAvLyBJZiBpdCBleGlzdHMsIHdlIGRvbid0IGhhdmUgdG8gZG8gYW55dGhpbmcuCiAgICByZXR1cm47CiAgfSAvLyBJbiBvdGhlciBjYXNlLCB3ZSBoYXZlIHRvIGNyZWF0ZSB0aGUgc3RydWN0dXJlIGZvciB0aGUgZXZlbnQuCiAgLy8gTm90ZSwgdGhhdCB3ZSBtaWdodCBuZWVkIHRvIGNyZWF0ZSBpbnRlcm1lZGlhdGUgZXZlbnRzIHRvby4KICAvLyBJLmUuIGlmIGZvbzpiYXI6YWJjIGlzIGJlaW5nIHJlZ2lzdGVyZWQgYW5kIHdlIG9ubHkgaGF2ZSBmb28gaW4gdGhlIHN0cnVjdHVyZSwKICAvLyB3ZSBuZWVkIHRvIGFsc28gcmVnaXN0ZXIgZm9vOmJhci4KICAvLyBDdXJyZW50bHkgcHJvY2Vzc2VkIGV2ZW50IG5hbWUuCgoKICB2YXIgbmFtZSA9IGV2ZW50TmFtZTsgLy8gTmFtZSBvZiB0aGUgZXZlbnQgdGhhdCBpcyBhIGNoaWxkIGV2ZW50IGZvciBjdXJyZW50bHkgcHJvY2Vzc2VkIGV2ZW50LgoKICB2YXIgY2hpbGRFdmVudE5hbWUgPSBudWxsOyAvLyBBcnJheSBjb250YWluaW5nIGFsbCBuZXdseSBjcmVhdGVkIHNwZWNpZmljIGV2ZW50cy4KCiAgdmFyIG5ld0V2ZW50Tm9kZXMgPSBbXTsgLy8gV2hpbGUgbG9vcCBjYW4ndCBjaGVjayBmb3IgJzonIGluZGV4IGJlY2F1c2Ugd2UgaGF2ZSB0byBoYW5kbGUgZ2VuZXJpYyBldmVudHMgdG9vLgogIC8vIEluIGVhY2ggbG9vcCwgd2UgdHJ1bmNhdGUgZXZlbnQgbmFtZSwgZ29pbmcgZnJvbSB0aGUgbW9zdCBzcGVjaWZpYyBuYW1lIHRvIHRoZSBnZW5lcmljIG9uZS4KICAvLyBJLmUuIGZvbzpiYXI6YWJjIC0+IGZvbzpiYXIgLT4gZm9vLgoKICB3aGlsZSAobmFtZSAhPT0gJycpIHsKICAgIGlmIChldmVudHNbbmFtZV0pIHsKICAgICAgLy8gSWYgdGhlIGN1cnJlbnRseSBwcm9jZXNzZWQgZXZlbnQgbmFtZSBpcyBhbHJlYWR5IHJlZ2lzdGVyZWQsIHdlIGNhbiBiZSBzdXJlCiAgICAgIC8vIHRoYXQgaXQgYWxyZWFkeSBoYXMgYWxsIHRoZSBzdHJ1Y3R1cmUgY3JlYXRlZCwgc28gd2UgY2FuIGJyZWFrIHRoZSBsb29wIGhlcmUKICAgICAgLy8gYXMgbm8gbW9yZSBldmVudHMgbmVlZCB0byBiZSByZWdpc3RlcmVkLgogICAgICBicmVhazsKICAgIH0gLy8gSWYgdGhpcyBldmVudCBpcyBub3QgeWV0IHJlZ2lzdGVyZWQsIGNyZWF0ZSBhIG5ldyBvYmplY3QgZm9yIGl0LgoKCiAgICBldmVudHNbbmFtZV0gPSBtYWtlRXZlbnROb2RlKCk7IC8vIEFkZCBpdCB0byB0aGUgYXJyYXkgd2l0aCBuZXdseSBjcmVhdGVkIGV2ZW50cy4KCiAgICBuZXdFdmVudE5vZGVzLnB1c2goZXZlbnRzW25hbWVdKTsgLy8gQWRkIHByZXZpb3VzbHkgcHJvY2Vzc2VkIGV2ZW50IG5hbWUgYXMgYSBjaGlsZCBvZiB0aGlzIGV2ZW50LgoKICAgIGlmIChjaGlsZEV2ZW50TmFtZSkgewogICAgICBldmVudHNbbmFtZV0uY2hpbGRFdmVudHMucHVzaChjaGlsZEV2ZW50TmFtZSk7CiAgICB9CgogICAgY2hpbGRFdmVudE5hbWUgPSBuYW1lOyAvLyBJZiBgLmxhc3RJbmRleE9mKClgIHJldHVybnMgLTEsIGAuc3Vic3RyKClgIHdpbGwgcmV0dXJuICcnIHdoaWNoIHdpbGwgYnJlYWsgdGhlIGxvb3AuCgogICAgbmFtZSA9IG5hbWUuc3Vic3RyKDAsIG5hbWUubGFzdEluZGV4T2YoJzonKSk7CiAgfQoKICBpZiAobmFtZSAhPT0gJycpIHsKICAgIC8vIElmIG5hbWUgaXMgbm90IGVtcHR5LCB3ZSBmb3VuZCBhbiBhbHJlYWR5IHJlZ2lzdGVyZWQgZXZlbnQgdGhhdCB3YXMgYSBwYXJlbnQgb2YgdGhlCiAgICAvLyBldmVudCB3ZSB3YW50ZWQgdG8gcmVnaXN0ZXIuCiAgICAvLyBDb3B5IHRoYXQgZXZlbnQncyBjYWxsYmFja3MgdG8gbmV3bHkgcmVnaXN0ZXJlZCBldmVudHMuCiAgICB2YXIgX2l0ZXJhdG9yMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG5ld0V2ZW50Tm9kZXMpLAogICAgICAgIF9zdGVwMzsKCiAgICB0cnkgewogICAgICBmb3IgKF9pdGVyYXRvcjMucygpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMubigpKS5kb25lOykgewogICAgICAgIHZhciBub2RlID0gX3N0ZXAzLnZhbHVlOwogICAgICAgIG5vZGUuY2FsbGJhY2tzID0gZXZlbnRzW25hbWVdLmNhbGxiYWNrcy5zbGljZSgpOwogICAgICB9IC8vIEFkZCBsYXN0IG5ld2x5IGNyZWF0ZWQgZXZlbnQgdG8gdGhlIGFscmVhZHkgcmVnaXN0ZXJlZCBldmVudC4KCiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yMy5lKGVycik7CiAgICB9IGZpbmFsbHkgewogICAgICBfaXRlcmF0b3IzLmYoKTsKICAgIH0KCiAgICBldmVudHNbbmFtZV0uY2hpbGRFdmVudHMucHVzaChjaGlsZEV2ZW50TmFtZSk7CiAgfQp9IC8vIEdldHMgYW4gYXJyYXkgY29udGFpbmluZyBjYWxsYmFja3MgbGlzdCBmb3IgYSBnaXZlbiBldmVudCBhbmQgaXQncyBtb3JlIHNwZWNpZmljIGV2ZW50cy4KLy8gSS5lLiBpZiBnaXZlbiBldmVudCBpcyBmb286YmFyIGFuZCB0aGVyZSBpcyBhbHNvIGZvbzpiYXI6YWJjIGV2ZW50IHJlZ2lzdGVyZWQsIHRoaXMgd2lsbAovLyByZXR1cm4gY2FsbGJhY2sgbGlzdCBvZiBmb286YmFyIGFuZCBmb286YmFyOmFiYyAoYnV0IG5vdCBmb28pLgoKCmZ1bmN0aW9uIGdldENhbGxiYWNrc0xpc3RzRm9yTmFtZXNwYWNlKHNvdXJjZSwgZXZlbnROYW1lKSB7CiAgdmFyIGV2ZW50Tm9kZSA9IGdldEV2ZW50cyhzb3VyY2UpW2V2ZW50TmFtZV07CgogIGlmICghZXZlbnROb2RlKSB7CiAgICByZXR1cm4gW107CiAgfQoKICB2YXIgY2FsbGJhY2tzTGlzdHMgPSBbZXZlbnROb2RlLmNhbGxiYWNrc107CgogIGZvciAodmFyIGkgPSAwOyBpIDwgZXZlbnROb2RlLmNoaWxkRXZlbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgY2hpbGRDYWxsYmFja3NMaXN0cyA9IGdldENhbGxiYWNrc0xpc3RzRm9yTmFtZXNwYWNlKHNvdXJjZSwgZXZlbnROb2RlLmNoaWxkRXZlbnRzW2ldKTsKICAgIGNhbGxiYWNrc0xpc3RzID0gY2FsbGJhY2tzTGlzdHMuY29uY2F0KGNoaWxkQ2FsbGJhY2tzTGlzdHMpOwogIH0KCiAgcmV0dXJuIGNhbGxiYWNrc0xpc3RzOwp9IC8vIEdldCB0aGUgbGlzdCBvZiBjYWxsYmFja3MgZm9yIGEgZ2l2ZW4gZXZlbnQsIGJ1dCBvbmx5IGlmIHRoZXJlIGFueSBjYWxsYmFja3MgaGF2ZSBiZWVuIHJlZ2lzdGVyZWQuCi8vIElmIHRoZXJlIGFyZSBubyBjYWxsYmFja3MgcmVnaXN0ZXJlZCBmb3IgZ2l2ZW4gZXZlbnQsIGl0IGNoZWNrcyBpZiB0aGlzIGlzIGEgc3BlY2lmaWMgZXZlbnQgYW5kIGxvb2tzCi8vIGZvciBjYWxsYmFja3MgZm9yIGl0J3MgbW9yZSBnZW5lcmljIHZlcnNpb24uCgoKZnVuY3Rpb24gZ2V0Q2FsbGJhY2tzRm9yRXZlbnQoc291cmNlLCBldmVudE5hbWUpIHsKICB2YXIgZXZlbnQ7CgogIGlmICghc291cmNlLl9ldmVudHMgfHwgIShldmVudCA9IHNvdXJjZS5fZXZlbnRzW2V2ZW50TmFtZV0pIHx8ICFldmVudC5jYWxsYmFja3MubGVuZ3RoKSB7CiAgICAvLyBUaGVyZSBhcmUgbm8gY2FsbGJhY2tzIHJlZ2lzdGVyZWQgZm9yIHNwZWNpZmllZCBldmVudE5hbWUuCiAgICAvLyBCdXQgdGhpcyBjb3VsZCBiZSBhIHNwZWNpZmljLXR5cGUgZXZlbnQgdGhhdCBpcyBpbiBhIG5hbWVzcGFjZS4KICAgIGlmIChldmVudE5hbWUuaW5kZXhPZignOicpID4gLTEpIHsKICAgICAgLy8gSWYgdGhlIGV2ZW50TmFtZSBpcyBzcGVjaWZpYywgdHJ5IHRvIGZpbmQgY2FsbGJhY2sgbGlzdHMgZm9yIG1vcmUgZ2VuZXJpYyBldmVudC4KICAgICAgcmV0dXJuIGdldENhbGxiYWNrc0ZvckV2ZW50KHNvdXJjZSwgZXZlbnROYW1lLnN1YnN0cigwLCBldmVudE5hbWUubGFzdEluZGV4T2YoJzonKSkpOwogICAgfSBlbHNlIHsKICAgICAgLy8gSWYgdGhpcyBpcyBhIHRvcC1sZXZlbCBnZW5lcmljIGV2ZW50LCByZXR1cm4gbnVsbDsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQoKICByZXR1cm4gZXZlbnQuY2FsbGJhY2tzOwp9IC8vIEZpcmVzIGRlbGVnYXRlZCBldmVudHMgZm9yIGdpdmVuIG1hcCBvZiBkZXN0aW5hdGlvbnMuCi8vCi8vIEBwcml2YXRlCi8vICogQHBhcmFtIHtNYXAuPHV0aWxzLkVtaXR0ZXI+fSBkZXN0aW5hdGlvbnMgQSBtYXAgY29udGFpbmluZwovLyBgWyB7QGxpbmsgbW9kdWxlOnV0aWxzL2VtaXR0ZXJtaXhpbn5FbWl0dGVyfSwgImV2ZW50IG5hbWUiIF1gIHBhaXIgZGVzdGluYXRpb25zLgovLyAqIEBwYXJhbSB7dXRpbHMuRXZlbnRJbmZvfSBldmVudEluZm8gVGhlIG9yaWdpbmFsIGV2ZW50IGluZm8gb2JqZWN0LgovLyAqIEBwYXJhbSB7QXJyYXkuPCo+fSBmaXJlQXJncyBBcmd1bWVudHMgdGhlIG9yaWdpbmFsIGV2ZW50IHdhcyBmaXJlZCB3aXRoLgoKCmZ1bmN0aW9uIGZpcmVEZWxlZ2F0ZWRFdmVudHMoZGVzdGluYXRpb25zLCBldmVudEluZm8sIGZpcmVBcmdzKSB7CiAgdmFyIF9pdGVyYXRvcjQgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihkZXN0aW5hdGlvbnMpLAogICAgICBfc3RlcDQ7CgogIHRyeSB7CiAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICB2YXIgX3N0ZXA0JHZhbHVlID0gX3NsaWNlZFRvQXJyYXkoX3N0ZXA0LnZhbHVlLCAyKSwKICAgICAgICAgIGVtaXR0ZXIgPSBfc3RlcDQkdmFsdWVbMF0sCiAgICAgICAgICBuYW1lID0gX3N0ZXA0JHZhbHVlWzFdOwoKICAgICAgaWYgKCFuYW1lKSB7CiAgICAgICAgbmFtZSA9IGV2ZW50SW5mby5uYW1lOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBuYW1lID09ICdmdW5jdGlvbicpIHsKICAgICAgICBuYW1lID0gbmFtZShldmVudEluZm8ubmFtZSk7CiAgICAgIH0KCiAgICAgIHZhciBkZWxlZ2F0ZWRJbmZvID0gbmV3IEV2ZW50SW5mbyhldmVudEluZm8uc291cmNlLCBuYW1lKTsKICAgICAgZGVsZWdhdGVkSW5mby5wYXRoID0gX3RvQ29uc3VtYWJsZUFycmF5KGV2ZW50SW5mby5wYXRoKTsKICAgICAgZW1pdHRlci5maXJlLmFwcGx5KGVtaXR0ZXIsIFtkZWxlZ2F0ZWRJbmZvXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGZpcmVBcmdzKSkpOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yNC5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjQuZigpOwogIH0KfSAvLyBIZWxwZXIgZm9yIHJlZ2lzdGVyaW5nIGV2ZW50IGNhbGxiYWNrIG9uIHRoZSBlbWl0dGVyLgoKCmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIobGlzdGVuZXIsIGVtaXR0ZXIsIGV2ZW50LCBjYWxsYmFjaywgb3B0aW9ucykgewogIGlmIChlbWl0dGVyLl9hZGRFdmVudExpc3RlbmVyKSB7CiAgICBlbWl0dGVyLl9hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBjYWxsYmFjaywgb3B0aW9ucyk7CiAgfSBlbHNlIHsKICAgIC8vIEFsbG93IGxpc3RlbmluZyBvbiBvYmplY3RzIHRoYXQgZG8gbm90IGltcGxlbWVudCBFbWl0dGVyIGludGVyZmFjZS4KICAgIC8vIFRoaXMgaXMgbmVlZGVkIGluIHNvbWUgdGVzdHMgdGhhdCBhcmUgdXNpbmcgbW9ja3MgaW5zdGVhZCBvZiB0aGUgcmVhbCBvYmplY3RzIHdpdGggRW1pdHRlck1peGluIG1peGVkLgogICAgbGlzdGVuZXIuX2FkZEV2ZW50TGlzdGVuZXIuY2FsbChlbWl0dGVyLCBldmVudCwgY2FsbGJhY2ssIG9wdGlvbnMpOwogIH0KfSAvLyBIZWxwZXIgZm9yIHJlbW92aW5nIGV2ZW50IGNhbGxiYWNrIGZyb20gdGhlIGVtaXR0ZXIuCgoKZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lcihsaXN0ZW5lciwgZW1pdHRlciwgZXZlbnQsIGNhbGxiYWNrKSB7CiAgaWYgKGVtaXR0ZXIuX3JlbW92ZUV2ZW50TGlzdGVuZXIpIHsKICAgIGVtaXR0ZXIuX3JlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGNhbGxiYWNrKTsKICB9IGVsc2UgewogICAgLy8gQWxsb3cgbGlzdGVuaW5nIG9uIG9iamVjdHMgdGhhdCBkbyBub3QgaW1wbGVtZW50IEVtaXR0ZXIgaW50ZXJmYWNlLgogICAgLy8gVGhpcyBpcyBuZWVkZWQgaW4gc29tZSB0ZXN0cyB0aGF0IGFyZSB1c2luZyBtb2NrcyBpbnN0ZWFkIG9mIHRoZSByZWFsIG9iamVjdHMgd2l0aCBFbWl0dGVyTWl4aW4gbWl4ZWQuCiAgICBsaXN0ZW5lci5fcmVtb3ZlRXZlbnRMaXN0ZW5lci5jYWxsKGVtaXR0ZXIsIGV2ZW50LCBjYWxsYmFjayk7CiAgfQp9Ci8qKgogKiBUaGUgcmV0dXJuIHZhbHVlIG9mIHtAbGluayB+RW1pdHRlck1peGluI2RlbGVnYXRlfS4KICoKICogQGludGVyZmFjZSBtb2R1bGU6dXRpbHMvZW1pdHRlcm1peGlufkVtaXR0ZXJNaXhpbkRlbGVnYXRlQ2hhaW4KICovCgovKioKICogU2VsZWN0cyBkZXN0aW5hdGlvbiBmb3Ige0BsaW5rIG1vZHVsZTp1dGlscy9lbWl0dGVybWl4aW5+RW1pdHRlck1peGluI2RlbGVnYXRlfSBldmVudHMuCiAqCiAqIEBtZXRob2QgI3RvCiAqIEBwYXJhbSB7bW9kdWxlOnV0aWxzL2VtaXR0ZXJtaXhpbn5FbWl0dGVyfSBlbWl0dGVyIEFuIGBFbWl0dGVyTWl4aW5gIGluc3RhbmNlIHdoaWNoIGlzIHRoZSBkZXN0aW5hdGlvbiBmb3IgZGVsZWdhdGVkIGV2ZW50cy4KICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IFtuYW1lT3JGdW5jdGlvbl0gQSBjdXN0b20gZXZlbnQgbmFtZSBvciBmdW5jdGlvbiB3aGljaCBjb252ZXJ0cyB0aGUgb3JpZ2luYWwgbmFtZSBzdHJpbmcuCiAqLw=="},{"version":3,"sources":["/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-utils/src/emittermixin.js"],"names":["EventInfo","uid","priorities","CKEditorError","_listeningTo","Symbol","_emitterId","EmitterMixin","on","event","callback","options","listenTo","once","wasFired","onceCallback","off","args","call","stopListening","emitter","emitterInfo","eventCallbacks","emitters","_getEmitterId","_setEmitterId","emitterId","callbacks","push","addEventListener","removeEventListener","index","indexOf","length","pop","fire","eventOrInfo","eventInfo","name","getCallbacksForEvent","path","callbackArgs","Array","from","i","apply","called","_removeEventListener","stop","_delegations","destinations","get","passAllDestinations","fireDelegatedEvents","return","err","rethrowUnexpectedError","delegate","events","to","nameOrFunction","Map","forEach","eventName","set","stopDelegating","clear","delete","_addEventListener","createEventNamespace","lists","getCallbacksListsForNamespace","priority","callbackDefinition","added","splice","_getEmitterListenedTo","listeningEmitter","listenedToEmitterId","id","getEvents","source","_events","Object","defineProperty","value","makeEventNode","childEvents","childEventName","newEventNodes","substr","lastIndexOf","node","slice","eventNode","callbacksLists","childCallbacksLists","concat","fireArgs","delegatedInfo","listener"],"mappings":"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CAAC,GAAG,CAAd,EAAiBA,CAAC,GAAGjB,SAAS,CAACM,MAA/B,EAAuCW,CAAC,EAAxC,EAA6C;AAC5C,cAAKjB,SAAS,CAAEiB,CAAF,CAAT,CAAelC,QAAf,IAA2BA,QAAhC,EAA2C;AAC1C;AACAiB,YAAAA,SAAS,CAACgD,MAAV,CAAkB/B,CAAlB,EAAqB,CAArB;AACAA,YAAAA,CAAC;AACD;AACD;AACD;AAXsC;AAAA;AAAA;AAAA;AAAA;AAYvC;AA9SmB,CAArB;AAiTA,eAAerC,YAAf;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASqE,qBAAT,CAAgCC,gBAAhC,EAAkDC,mBAAlD,EAAwE;AAC9E,MAAKD,gBAAgB,CAAE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","sourcesContent":["/**\n * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module utils/emittermixin\n */\n\nimport EventInfo from './eventinfo';\nimport uid from './uid';\nimport priorities from './priorities';\n\n// To check if component is loaded more than once.\nimport './version';\nimport CKEditorError from './ckeditorerror';\n\nconst _listeningTo = Symbol( 'listeningTo' );\nconst _emitterId = Symbol( 'emitterId' );\n\n/**\n * Mixin that injects the {@link ~Emitter events API} into its host.\n *\n * Read more about the concept of emitters in the:\n * * {@glink framework/guides/architecture/core-editor-architecture#event-system-and-observables Event system and observables}\n * section of the {@glink framework/guides/architecture/core-editor-architecture Core editor architecture} guide.\n * * {@glink framework/guides/deep-dive/event-system Event system} deep dive guide.\n *\n * @mixin EmitterMixin\n * @implements module:utils/emittermixin~Emitter\n */\nconst EmitterMixin = {\n\t/**\n\t * @inheritDoc\n\t */\n\ton( event, callback, options = {} ) {\n\t\tthis.listenTo( this, event, callback, options );\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\tonce( event, callback, options ) {\n\t\tlet wasFired = false;\n\n\t\tconst onceCallback = function( event, ...args ) {\n\t\t\t// Ensure the callback is called only once even if the callback itself leads to re-firing the event\n\t\t\t// (which would call the callback again).\n\t\t\tif ( !wasFired ) {\n\t\t\t\twasFired = true;\n\n\t\t\t\t// Go off() at the first call.\n\t\t\t\tevent.off();\n\n\t\t\t\t// Go with the original callback.\n\t\t\t\tcallback.call( this, event, ...args );\n\t\t\t}\n\t\t};\n\n\t\t// Make a similar on() call, simply replacing the callback.\n\t\tthis.listenTo( this, event, onceCallback, options );\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\toff( event, callback ) {\n\t\tthis.stopListening( this, event, callback );\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\tlistenTo( emitter, event, callback, options = {} ) {\n\t\tlet emitterInfo, eventCallbacks;\n\n\t\t// _listeningTo contains a list of emitters that this object is listening to.\n\t\t// This list has the following format:\n\t\t//\n\t\t// _listeningTo: {\n\t\t//     emitterId: {\n\t\t//         emitter: emitter,\n\t\t//         callbacks: {\n\t\t//             event1: [ callback1, callback2, ... ]\n\t\t//             ....\n\t\t//         }\n\t\t//     },\n\t\t//     ...\n\t\t// }\n\n\t\tif ( !this[ _listeningTo ] ) {\n\t\t\tthis[ _listeningTo ] = {};\n\t\t}\n\n\t\tconst emitters = this[ _listeningTo ];\n\n\t\tif ( !_getEmitterId( emitter ) ) {\n\t\t\t_setEmitterId( emitter );\n\t\t}\n\n\t\tconst emitterId = _getEmitterId( emitter );\n\n\t\tif ( !( emitterInfo = emitters[ emitterId ] ) ) {\n\t\t\temitterInfo = emitters[ emitterId ] = {\n\t\t\t\temitter,\n\t\t\t\tcallbacks: {}\n\t\t\t};\n\t\t}\n\n\t\tif ( !( eventCallbacks = emitterInfo.callbacks[ event ] ) ) {\n\t\t\teventCallbacks = emitterInfo.callbacks[ event ] = [];\n\t\t}\n\n\t\teventCallbacks.push( callback );\n\n\t\t// Finally register the callback to the event.\n\t\taddEventListener( this, emitter, event, callback, options );\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstopListening( emitter, event, callback ) {\n\t\tconst emitters = this[ _listeningTo ];\n\t\tlet emitterId = emitter && _getEmitterId( emitter );\n\t\tconst emitterInfo = emitters && emitterId && emitters[ emitterId ];\n\t\tconst eventCallbacks = emitterInfo && event && emitterInfo.callbacks[ event ];\n\n\t\t// Stop if nothing has been listened.\n\t\tif ( !emitters || ( emitter && !emitterInfo ) || ( event && !eventCallbacks ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// All params provided. off() that single callback.\n\t\tif ( callback ) {\n\t\t\tremoveEventListener( this, emitter, event, callback );\n\n\t\t\t// We must remove callbacks as well in order to prevent memory leaks.\n\t\t\t// See https://github.com/ckeditor/ckeditor5/pull/8480\n\t\t\tconst index = eventCallbacks.indexOf( callback );\n\n\t\t\tif ( index !== -1 ) {\n\t\t\t\tif ( eventCallbacks.length === 1 ) {\n\t\t\t\t\tdelete emitterInfo.callbacks[ event ];\n\t\t\t\t} else {\n\t\t\t\t\tremoveEventListener( this, emitter, event, callback );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Only `emitter` and `event` provided. off() all callbacks for that event.\n\t\telse if ( eventCallbacks ) {\n\t\t\twhile ( ( callback = eventCallbacks.pop() ) ) {\n\t\t\t\tremoveEventListener( this, emitter, event, callback );\n\t\t\t}\n\n\t\t\tdelete emitterInfo.callbacks[ event ];\n\t\t}\n\t\t// Only `emitter` provided. off() all events for that emitter.\n\t\telse if ( emitterInfo ) {\n\t\t\tfor ( event in emitterInfo.callbacks ) {\n\t\t\t\tthis.stopListening( emitter, event );\n\t\t\t}\n\t\t\tdelete emitters[ emitterId ];\n\t\t}\n\t\t// No params provided. off() all emitters.\n\t\telse {\n\t\t\tfor ( emitterId in emitters ) {\n\t\t\t\tthis.stopListening( emitters[ emitterId ].emitter );\n\t\t\t}\n\t\t\tdelete this[ _listeningTo ];\n\t\t}\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\tfire( eventOrInfo, ...args ) {\n\t\ttry {\n\t\t\tconst eventInfo = eventOrInfo instanceof EventInfo ? eventOrInfo : new EventInfo( this, eventOrInfo );\n\t\t\tconst event = eventInfo.name;\n\t\t\tlet callbacks = getCallbacksForEvent( this, event );\n\n\t\t\t// Record that the event passed this emitter on its path.\n\t\t\teventInfo.path.push( this );\n\n\t\t\t// Handle event listener callbacks first.\n\t\t\tif ( callbacks ) {\n\t\t\t\t// Arguments passed to each callback.\n\t\t\t\tconst callbackArgs = [ eventInfo, ...args ];\n\n\t\t\t\t// Copying callbacks array is the easiest and most secure way of preventing infinite loops, when event callbacks\n\t\t\t\t// are added while processing other callbacks. Previous solution involved adding counters (unique ids) but\n\t\t\t\t// failed if callbacks were added to the queue before currently processed callback.\n\t\t\t\t// If this proves to be too inefficient, another method is to change `.on()` so callbacks are stored if same\n\t\t\t\t// event is currently processed. Then, `.fire()` at the end, would have to add all stored events.\n\t\t\t\tcallbacks = Array.from( callbacks );\n\n\t\t\t\tfor ( let i = 0; i < callbacks.length; i++ ) {\n\t\t\t\t\tcallbacks[ i ].callback.apply( this, callbackArgs );\n\n\t\t\t\t\t// Remove the callback from future requests if off() has been called.\n\t\t\t\t\tif ( eventInfo.off.called ) {\n\t\t\t\t\t\t// Remove the called mark for the next calls.\n\t\t\t\t\t\tdelete eventInfo.off.called;\n\n\t\t\t\t\t\tthis._removeEventListener( event, callbacks[ i ].callback );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Do not execute next callbacks if stop() was called.\n\t\t\t\t\tif ( eventInfo.stop.called ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Delegate event to other emitters if needed.\n\t\t\tif ( this._delegations ) {\n\t\t\t\tconst destinations = this._delegations.get( event );\n\t\t\t\tconst passAllDestinations = this._delegations.get( '*' );\n\n\t\t\t\tif ( destinations ) {\n\t\t\t\t\tfireDelegatedEvents( destinations, eventInfo, args );\n\t\t\t\t}\n\n\t\t\t\tif ( passAllDestinations ) {\n\t\t\t\t\tfireDelegatedEvents( passAllDestinations, eventInfo, args );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn eventInfo.return;\n\t\t} catch ( err ) {\n\t\t\t// @if CK_DEBUG // throw err;\n\t\t\t/* istanbul ignore next */\n\t\t\tCKEditorError.rethrowUnexpectedError( err, this );\n\t\t}\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdelegate( ...events ) {\n\t\treturn {\n\t\t\tto: ( emitter, nameOrFunction ) => {\n\t\t\t\tif ( !this._delegations ) {\n\t\t\t\t\tthis._delegations = new Map();\n\t\t\t\t}\n\n\t\t\t\t// Originally there was a for..of loop which unfortunately caused an error in Babel that didn't allow\n\t\t\t\t// build an application. See: https://github.com/ckeditor/ckeditor5-react/issues/40.\n\t\t\t\tevents.forEach( eventName => {\n\t\t\t\t\tconst destinations = this._delegations.get( eventName );\n\n\t\t\t\t\tif ( !destinations ) {\n\t\t\t\t\t\tthis._delegations.set( eventName, new Map( [ [ emitter, nameOrFunction ] ] ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdestinations.set( emitter, nameOrFunction );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstopDelegating( event, emitter ) {\n\t\tif ( !this._delegations ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !event ) {\n\t\t\tthis._delegations.clear();\n\t\t} else if ( !emitter ) {\n\t\t\tthis._delegations.delete( event );\n\t\t} else {\n\t\t\tconst destinations = this._delegations.get( event );\n\n\t\t\tif ( destinations ) {\n\t\t\t\tdestinations.delete( emitter );\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\t_addEventListener( event, callback, options ) {\n\t\tcreateEventNamespace( this, event );\n\n\t\tconst lists = getCallbacksListsForNamespace( this, event );\n\t\tconst priority = priorities.get( options.priority );\n\n\t\tconst callbackDefinition = {\n\t\t\tcallback,\n\t\t\tpriority\n\t\t};\n\n\t\t// Add the callback to all callbacks list.\n\t\tfor ( const callbacks of lists ) {\n\t\t\t// Add the callback to the list in the right priority position.\n\t\t\tlet added = false;\n\n\t\t\tfor ( let i = 0; i < callbacks.length; i++ ) {\n\t\t\t\tif ( callbacks[ i ].priority < priority ) {\n\t\t\t\t\tcallbacks.splice( i, 0, callbackDefinition );\n\t\t\t\t\tadded = true;\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Add at the end, if right place was not found.\n\t\t\tif ( !added ) {\n\t\t\t\tcallbacks.push( callbackDefinition );\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\t_removeEventListener( event, callback ) {\n\t\tconst lists = getCallbacksListsForNamespace( this, event );\n\n\t\tfor ( const callbacks of lists ) {\n\t\t\tfor ( let i = 0; i < callbacks.length; i++ ) {\n\t\t\t\tif ( callbacks[ i ].callback == callback ) {\n\t\t\t\t\t// Remove the callback from the list (fixing the next index).\n\t\t\t\t\tcallbacks.splice( i, 1 );\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nexport default EmitterMixin;\n\n/**\n * Emitter/listener interface.\n *\n * Can be easily implemented by a class by mixing the {@link module:utils/emittermixin~EmitterMixin} mixin.\n *\n * Read more about the usage of this interface in the:\n * * {@glink framework/guides/architecture/core-editor-architecture#event-system-and-observables Event system and observables}\n * section of the {@glink framework/guides/architecture/core-editor-architecture Core editor architecture} guide.\n * * {@glink framework/guides/deep-dive/event-system Event system} deep dive guide.\n *\n * @interface Emitter\n */\n\n/**\n * Registers a callback function to be executed when an event is fired.\n *\n * Shorthand for {@link #listenTo `this.listenTo( this, event, callback, options )`} (it makes the emitter\n * listen on itself).\n *\n * @method #on\n * @param {String} event The name of the event.\n * @param {Function} callback The function to be called on event.\n * @param {Object} [options={}] Additional options.\n * @param {module:utils/priorities~PriorityString|Number} [options.priority='normal'] The priority of this event callback. The higher\n * the priority value the sooner the callback will be fired. Events having the same priority are called in the\n * order they were added.\n */\n\n/**\n * Registers a callback function to be executed on the next time the event is fired only. This is similar to\n * calling {@link #on} followed by {@link #off} in the callback.\n *\n * @method #once\n * @param {String} event The name of the event.\n * @param {Function} callback The function to be called on event.\n * @param {Object} [options={}] Additional options.\n * @param {module:utils/priorities~PriorityString|Number} [options.priority='normal'] The priority of this event callback. The higher\n * the priority value the sooner the callback will be fired. Events having the same priority are called in the\n * order they were added.\n */\n\n/**\n * Stops executing the callback on the given event.\n * Shorthand for {@link #stopListening `this.stopListening( this, event, callback )`}.\n *\n * @method #off\n * @param {String} event The name of the event.\n * @param {Function} callback The function to stop being called.\n */\n\n/**\n * Registers a callback function to be executed when an event is fired in a specific (emitter) object.\n *\n * Events can be grouped in namespaces using `:`.\n * When namespaced event is fired, it additionally fires all callbacks for that namespace.\n *\n *\t\t// myEmitter.on( ... ) is a shorthand for myEmitter.listenTo( myEmitter, ... ).\n *\t\tmyEmitter.on( 'myGroup', genericCallback );\n *\t\tmyEmitter.on( 'myGroup:myEvent', specificCallback );\n *\n *\t\t// genericCallback is fired.\n *\t\tmyEmitter.fire( 'myGroup' );\n *\t\t// both genericCallback and specificCallback are fired.\n *\t\tmyEmitter.fire( 'myGroup:myEvent' );\n *\t\t// genericCallback is fired even though there are no callbacks for \"foo\".\n *\t\tmyEmitter.fire( 'myGroup:foo' );\n *\n * An event callback can {@link module:utils/eventinfo~EventInfo#stop stop the event} and\n * set the {@link module:utils/eventinfo~EventInfo#return return value} of the {@link #fire} method.\n *\n * @method #listenTo\n * @param {module:utils/emittermixin~Emitter} emitter The object that fires the event.\n * @param {String} event The name of the event.\n * @param {Function} callback The function to be called on event.\n * @param {Object} [options={}] Additional options.\n * @param {module:utils/priorities~PriorityString|Number} [options.priority='normal'] The priority of this event callback. The higher\n * the priority value the sooner the callback will be fired. Events having the same priority are called in the\n * order they were added.\n */\n\n/**\n * Stops listening for events. It can be used at different levels:\n *\n * * To stop listening to a specific callback.\n * * To stop listening to a specific event.\n * * To stop listening to all events fired by a specific object.\n * * To stop listening to all events fired by all objects.\n *\n * @method #stopListening\n * @param {module:utils/emittermixin~Emitter} [emitter] The object to stop listening to. If omitted, stops it for all objects.\n * @param {String} [event] (Requires the `emitter`) The name of the event to stop listening to. If omitted, stops it\n * for all events from `emitter`.\n * @param {Function} [callback] (Requires the `event`) The function to be removed from the call list for the given\n * `event`.\n */\n\n/**\n * Fires an event, executing all callbacks registered for it.\n *\n * The first parameter passed to callbacks is an {@link module:utils/eventinfo~EventInfo} object,\n * followed by the optional `args` provided in the `fire()` method call.\n *\n * @method #fire\n * @param {String|module:utils/eventinfo~EventInfo} eventOrInfo The name of the event or `EventInfo` object if event is delegated.\n * @param {...*} [args] Additional arguments to be passed to the callbacks.\n * @returns {*} By default the method returns `undefined`. However, the return value can be changed by listeners\n * through modification of the {@link module:utils/eventinfo~EventInfo#return `evt.return`}'s property (the event info\n * is the first param of every callback).\n */\n\n/**\n * Delegates selected events to another {@link module:utils/emittermixin~Emitter}. For instance:\n *\n *\t\temitterA.delegate( 'eventX' ).to( emitterB );\n *\t\temitterA.delegate( 'eventX', 'eventY' ).to( emitterC );\n *\n * then `eventX` is delegated (fired by) `emitterB` and `emitterC` along with `data`:\n *\n *\t\temitterA.fire( 'eventX', data );\n *\n * and `eventY` is delegated (fired by) `emitterC` along with `data`:\n *\n *\t\temitterA.fire( 'eventY', data );\n *\n * @method #delegate\n * @param {...String} events Event names that will be delegated to another emitter.\n * @returns {module:utils/emittermixin~EmitterMixinDelegateChain}\n */\n\n/**\n * Stops delegating events. It can be used at different levels:\n *\n * * To stop delegating all events.\n * * To stop delegating a specific event to all emitters.\n * * To stop delegating a specific event to a specific emitter.\n *\n * @method #stopDelegating\n * @param {String} [event] The name of the event to stop delegating. If omitted, stops it all delegations.\n * @param {module:utils/emittermixin~Emitter} [emitter] (requires `event`) The object to stop delegating a particular event to.\n * If omitted, stops delegation of `event` to all emitters.\n */\n\n/**\n * Adds callback to emitter for given event.\n *\n * @protected\n * @method #_addEventListener\n * @param {String} event The name of the event.\n * @param {Function} callback The function to be called on event.\n * @param {Object} [options={}] Additional options.\n * @param {module:utils/priorities~PriorityString|Number} [options.priority='normal'] The priority of this event callback. The higher\n * the priority value the sooner the callback will be fired. Events having the same priority are called in the\n * order they were added.\n */\n\n/**\n * Removes callback from emitter for given event.\n *\n * @protected\n * @method #_removeEventListener\n * @param {String} event The name of the event.\n * @param {Function} callback The function to stop being called.\n */\n\n/**\n * Checks if `listeningEmitter` listens to an emitter with given `listenedToEmitterId` and if so, returns that emitter.\n * If not, returns `null`.\n *\n * @protected\n * @param {module:utils/emittermixin~Emitter} listeningEmitter An emitter that listens.\n * @param {String} listenedToEmitterId Unique emitter id of emitter listened to.\n * @returns {module:utils/emittermixin~Emitter|null}\n */\nexport function _getEmitterListenedTo( listeningEmitter, listenedToEmitterId ) {\n\tif ( listeningEmitter[ _listeningTo ] && listeningEmitter[ _listeningTo ][ listenedToEmitterId ] ) {\n\t\treturn listeningEmitter[ _listeningTo ][ listenedToEmitterId ].emitter;\n\t}\n\n\treturn null;\n}\n\n/**\n * Sets emitter's unique id.\n *\n * **Note:** `_emitterId` can be set only once.\n *\n * @protected\n * @param {module:utils/emittermixin~Emitter} emitter An emitter for which id will be set.\n * @param {String} [id] Unique id to set. If not passed, random unique id will be set.\n */\nexport function _setEmitterId( emitter, id ) {\n\tif ( !emitter[ _emitterId ] ) {\n\t\temitter[ _emitterId ] = id || uid();\n\t}\n}\n\n/**\n * Returns emitter's unique id.\n *\n * @protected\n * @param {module:utils/emittermixin~Emitter} emitter An emitter which id will be returned.\n */\nexport function _getEmitterId( emitter ) {\n\treturn emitter[ _emitterId ];\n}\n\n// Gets the internal `_events` property of the given object.\n// `_events` property store all lists with callbacks for registered event names.\n// If there were no events registered on the object, empty `_events` object is created.\nfunction getEvents( source ) {\n\tif ( !source._events ) {\n\t\tObject.defineProperty( source, '_events', {\n\t\t\tvalue: {}\n\t\t} );\n\t}\n\n\treturn source._events;\n}\n\n// Creates event node for generic-specific events relation architecture.\nfunction makeEventNode() {\n\treturn {\n\t\tcallbacks: [],\n\t\tchildEvents: []\n\t};\n}\n\n// Creates an architecture for generic-specific events relation.\n// If needed, creates all events for given eventName, i.e. if the first registered event\n// is foo:bar:abc, it will create foo:bar:abc, foo:bar and foo event and tie them together.\n// It also copies callbacks from more generic events to more specific events when\n// specific events are created.\nfunction createEventNamespace( source, eventName ) {\n\tconst events = getEvents( source );\n\n\t// First, check if the event we want to add to the structure already exists.\n\tif ( events[ eventName ] ) {\n\t\t// If it exists, we don't have to do anything.\n\t\treturn;\n\t}\n\n\t// In other case, we have to create the structure for the event.\n\t// Note, that we might need to create intermediate events too.\n\t// I.e. if foo:bar:abc is being registered and we only have foo in the structure,\n\t// we need to also register foo:bar.\n\n\t// Currently processed event name.\n\tlet name = eventName;\n\t// Name of the event that is a child event for currently processed event.\n\tlet childEventName = null;\n\n\t// Array containing all newly created specific events.\n\tconst newEventNodes = [];\n\n\t// While loop can't check for ':' index because we have to handle generic events too.\n\t// In each loop, we truncate event name, going from the most specific name to the generic one.\n\t// I.e. foo:bar:abc -> foo:bar -> foo.\n\twhile ( name !== '' ) {\n\t\tif ( events[ name ] ) {\n\t\t\t// If the currently processed event name is already registered, we can be sure\n\t\t\t// that it already has all the structure created, so we can break the loop here\n\t\t\t// as no more events need to be registered.\n\t\t\tbreak;\n\t\t}\n\n\t\t// If this event is not yet registered, create a new object for it.\n\t\tevents[ name ] = makeEventNode();\n\t\t// Add it to the array with newly created events.\n\t\tnewEventNodes.push( events[ name ] );\n\n\t\t// Add previously processed event name as a child of this event.\n\t\tif ( childEventName ) {\n\t\t\tevents[ name ].childEvents.push( childEventName );\n\t\t}\n\n\t\tchildEventName = name;\n\t\t// If `.lastIndexOf()` returns -1, `.substr()` will return '' which will break the loop.\n\t\tname = name.substr( 0, name.lastIndexOf( ':' ) );\n\t}\n\n\tif ( name !== '' ) {\n\t\t// If name is not empty, we found an already registered event that was a parent of the\n\t\t// event we wanted to register.\n\n\t\t// Copy that event's callbacks to newly registered events.\n\t\tfor ( const node of newEventNodes ) {\n\t\t\tnode.callbacks = events[ name ].callbacks.slice();\n\t\t}\n\n\t\t// Add last newly created event to the already registered event.\n\t\tevents[ name ].childEvents.push( childEventName );\n\t}\n}\n\n// Gets an array containing callbacks list for a given event and it's more specific events.\n// I.e. if given event is foo:bar and there is also foo:bar:abc event registered, this will\n// return callback list of foo:bar and foo:bar:abc (but not foo).\nfunction getCallbacksListsForNamespace( source, eventName ) {\n\tconst eventNode = getEvents( source )[ eventName ];\n\n\tif ( !eventNode ) {\n\t\treturn [];\n\t}\n\n\tlet callbacksLists = [ eventNode.callbacks ];\n\n\tfor ( let i = 0; i < eventNode.childEvents.length; i++ ) {\n\t\tconst childCallbacksLists = getCallbacksListsForNamespace( source, eventNode.childEvents[ i ] );\n\n\t\tcallbacksLists = callbacksLists.concat( childCallbacksLists );\n\t}\n\n\treturn callbacksLists;\n}\n\n// Get the list of callbacks for a given event, but only if there any callbacks have been registered.\n// If there are no callbacks registered for given event, it checks if this is a specific event and looks\n// for callbacks for it's more generic version.\nfunction getCallbacksForEvent( source, eventName ) {\n\tlet event;\n\n\tif ( !source._events || !( event = source._events[ eventName ] ) || !event.callbacks.length ) {\n\t\t// There are no callbacks registered for specified eventName.\n\t\t// But this could be a specific-type event that is in a namespace.\n\t\tif ( eventName.indexOf( ':' ) > -1 ) {\n\t\t\t// If the eventName is specific, try to find callback lists for more generic event.\n\t\t\treturn getCallbacksForEvent( source, eventName.substr( 0, eventName.lastIndexOf( ':' ) ) );\n\t\t} else {\n\t\t\t// If this is a top-level generic event, return null;\n\t\t\treturn null;\n\t\t}\n\t}\n\n\treturn event.callbacks;\n}\n\n// Fires delegated events for given map of destinations.\n//\n// @private\n// * @param {Map.<utils.Emitter>} destinations A map containing\n// `[ {@link module:utils/emittermixin~Emitter}, \"event name\" ]` pair destinations.\n// * @param {utils.EventInfo} eventInfo The original event info object.\n// * @param {Array.<*>} fireArgs Arguments the original event was fired with.\nfunction fireDelegatedEvents( destinations, eventInfo, fireArgs ) {\n\tfor ( let [ emitter, name ] of destinations ) {\n\t\tif ( !name ) {\n\t\t\tname = eventInfo.name;\n\t\t} else if ( typeof name == 'function' ) {\n\t\t\tname = name( eventInfo.name );\n\t\t}\n\n\t\tconst delegatedInfo = new EventInfo( eventInfo.source, name );\n\n\t\tdelegatedInfo.path = [ ...eventInfo.path ];\n\n\t\temitter.fire( delegatedInfo, ...fireArgs );\n\t}\n}\n\n// Helper for registering event callback on the emitter.\nfunction addEventListener( listener, emitter, event, callback, options ) {\n\tif ( emitter._addEventListener ) {\n\t\temitter._addEventListener( event, callback, options );\n\t} else {\n\t\t// Allow listening on objects that do not implement Emitter interface.\n\t\t// This is needed in some tests that are using mocks instead of the real objects with EmitterMixin mixed.\n\t\tlistener._addEventListener.call( emitter, event, callback, options );\n\t}\n}\n\n// Helper for removing event callback from the emitter.\nfunction removeEventListener( listener, emitter, event, callback ) {\n\tif ( emitter._removeEventListener ) {\n\t\temitter._removeEventListener( event, callback );\n\t} else {\n\t\t// Allow listening on objects that do not implement Emitter interface.\n\t\t// This is needed in some tests that are using mocks instead of the real objects with EmitterMixin mixed.\n\t\tlistener._removeEventListener.call( emitter, event, callback );\n\t}\n}\n\n/**\n * The return value of {@link ~EmitterMixin#delegate}.\n *\n * @interface module:utils/emittermixin~EmitterMixinDelegateChain\n */\n\n/**\n * Selects destination for {@link module:utils/emittermixin~EmitterMixin#delegate} events.\n *\n * @method #to\n * @param {module:utils/emittermixin~Emitter} emitter An `EmitterMixin` instance which is the destination for delegated events.\n * @param {String|Function} [nameOrFunction] A custom event name or function which converts the original name string.\n */\n"]}]}