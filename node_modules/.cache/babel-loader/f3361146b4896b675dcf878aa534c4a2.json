{"remainingRequest":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js?{}!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-engine/src/view/element.js","dependencies":[{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-engine/src/view/element.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jb25zdHJ1Y3QgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jb25zdHJ1Y3QiOwppbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9ob21lL2VrZWJlcmF0L1lhbmRleC5EaXNrL1Byb2plbGVyaW0vQmVuaW1Qcm9qZWxlcmltL3dlYnNpdGVtL3dlYnNpdGVtLXdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zZXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZyb20uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKCi8qKgogKiBAbGljZW5zZSBDb3B5cmlnaHQgKGMpIDIwMDMtMjAyMSwgQ0tTb3VyY2UgLSBGcmVkZXJpY28gS25hYmJlbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogRm9yIGxpY2Vuc2luZywgc2VlIExJQ0VOU0UubWQgb3IgaHR0cHM6Ly9ja2VkaXRvci5jb20vbGVnYWwvY2tlZGl0b3Itb3NzLWxpY2Vuc2UKICovCgovKioKICogQG1vZHVsZSBlbmdpbmUvdmlldy9lbGVtZW50CiAqLwppbXBvcnQgTm9kZSBmcm9tICcuL25vZGUnOwppbXBvcnQgVGV4dCBmcm9tICcuL3RleHQnOwppbXBvcnQgVGV4dFByb3h5IGZyb20gJy4vdGV4dHByb3h5JzsKaW1wb3J0IHRvTWFwIGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtdXRpbHMvc3JjL3RvbWFwJzsKaW1wb3J0IHRvQXJyYXkgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvdG9hcnJheSc7CmltcG9ydCBpc0l0ZXJhYmxlIGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtdXRpbHMvc3JjL2lzaXRlcmFibGUnOwppbXBvcnQgTWF0Y2hlciBmcm9tICcuL21hdGNoZXInOwppbXBvcnQgU3R5bGVzTWFwIGZyb20gJy4vc3R5bGVzbWFwJzsgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLyBjb25zdCB7IGNvbnZlcnRNYXBUb1RhZ3MgfSA9IHJlcXVpcmUoICcuLi9kZXYtdXRpbHMvdXRpbHMnICk7CgovKioKICogVmlldyBlbGVtZW50LgogKgogKiBUaGUgZWRpdGluZyBlbmdpbmUgZG9lcyBub3QgZGVmaW5lIGEgZml4ZWQgc2VtYW50aWNzIG9mIGl0cyBlbGVtZW50cyAoaXQgaXMgIkRURC1mcmVlIikuCiAqIFRoaXMgaXMgd2h5IHRoZSB0eXBlIG9mIHRoZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudH0gbmVlZCB0bwogKiBiZSBkZWZpbmVkIGJ5IHRoZSBmZWF0dXJlIGRldmVsb3Blci4gV2hlbiBjcmVhdGluZyBhbiBlbGVtZW50IHlvdSBzaG91bGQgdXNlIG9uZSBvZiB0aGUgZm9sbG93aW5nIG1ldGhvZHM6CiAqCiAqICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlciNjcmVhdGVDb250YWluZXJFbGVtZW50IGBkb3duY2FzdFdyaXRlciNjcmVhdGVDb250YWluZXJFbGVtZW50KClgfQogKiBpbiBvcmRlciB0byBjcmVhdGUgYSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2NvbnRhaW5lcmVsZW1lbnR+Q29udGFpbmVyRWxlbWVudH0sCiAqICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlciNjcmVhdGVBdHRyaWJ1dGVFbGVtZW50IGBkb3duY2FzdFdyaXRlciNjcmVhdGVBdHRyaWJ1dGVFbGVtZW50KClgfQogKiBpbiBvcmRlciB0byBjcmVhdGUgYSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2F0dHJpYnV0ZWVsZW1lbnR+QXR0cmlidXRlRWxlbWVudH0sCiAqICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlciNjcmVhdGVFbXB0eUVsZW1lbnQgYGRvd25jYXN0V3JpdGVyI2NyZWF0ZUVtcHR5RWxlbWVudCgpYH0KICogaW4gb3JkZXIgdG8gY3JlYXRlIGEge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9lbXB0eWVsZW1lbnR+RW1wdHlFbGVtZW50fS4KICogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI2NyZWF0ZVVJRWxlbWVudCBgZG93bmNhc3RXcml0ZXIjY3JlYXRlVUlFbGVtZW50KClgfQogKiBpbiBvcmRlciB0byBjcmVhdGUgYSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3VpZWxlbWVudH5VSUVsZW1lbnR9LgogKiAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjY3JlYXRlRWRpdGFibGVFbGVtZW50IGBkb3duY2FzdFdyaXRlciNjcmVhdGVFZGl0YWJsZUVsZW1lbnQoKWB9CiAqIGluIG9yZGVyIHRvIGNyZWF0ZSBhIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZWRpdGFibGVlbGVtZW50fkVkaXRhYmxlRWxlbWVudH0uCiAqCiAqIE5vdGUgdGhhdCBmb3IgdmlldyBlbGVtZW50cyB3aGljaCBhcmUgbm90IGNyZWF0ZWQgZnJvbSB0aGUgbW9kZWwsIGxpa2UgZWxlbWVudHMgZnJvbSBtdXRhdGlvbnMsIHBhc3RlIG9yCiAqIHtAbGluayBtb2R1bGU6ZW5naW5lL2NvbnRyb2xsZXIvZGF0YWNvbnRyb2xsZXJ+RGF0YUNvbnRyb2xsZXIjc2V0IGRhdGEuc2V0fSBpdCBpcyBub3QgcG9zc2libGUgdG8gZGVmaW5lIHRoZSB0eXBlIG9mIHRoZSBlbGVtZW50LgogKiBJbiBzdWNoIGNhc2VzIHRoZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3VwY2FzdHdyaXRlcn5VcGNhc3RXcml0ZXIjY3JlYXRlRWxlbWVudCBgVXBjYXN0V3JpdGVyI2NyZWF0ZUVsZW1lbnQoKWB9IG1ldGhvZAogKiBzaG91bGQgYmUgdXNlZCB0byBjcmVhdGUgZ2VuZXJpYyB2aWV3IGVsZW1lbnRzLgogKgogKiBAZXh0ZW5kcyBtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlCiAqLwoKdmFyIEVsZW1lbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Ob2RlKSB7CiAgX2luaGVyaXRzKEVsZW1lbnQsIF9Ob2RlKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihFbGVtZW50KTsKCiAgLyoqCiAgICogQ3JlYXRlcyBhIHZpZXcgZWxlbWVudC4KICAgKgogICAqIEF0dHJpYnV0ZXMgY2FuIGJlIHBhc3NlZCBpbiB2YXJpb3VzIGZvcm1hdHM6CiAgICoKICAgKgkJbmV3IEVsZW1lbnQoIHZpZXdEb2N1bWVudCwgJ2RpdicsIHsgY2xhc3M6ICdlZGl0b3InLCBjb250ZW50RWRpdGFibGU6ICd0cnVlJyB9ICk7IC8vIG9iamVjdAogICAqCQluZXcgRWxlbWVudCggdmlld0RvY3VtZW50LCAnZGl2JywgWyBbICdjbGFzcycsICdlZGl0b3InIF0sIFsgJ2NvbnRlbnRFZGl0YWJsZScsICd0cnVlJyBdIF0gKTsgLy8gbWFwLWxpa2UgaXRlcmF0b3IKICAgKgkJbmV3IEVsZW1lbnQoIHZpZXdEb2N1bWVudCwgJ2RpdicsIG1hcE9mQXR0cmlidXRlcyApOyAvLyBtYXAKICAgKgogICAqIEBwcm90ZWN0ZWQKICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9kb2N1bWVudH5Eb2N1bWVudH0gZG9jdW1lbnQgVGhlIGRvY3VtZW50IGluc3RhbmNlIHRvIHdoaWNoIHRoaXMgZWxlbWVudCBiZWxvbmdzLgogICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIE5vZGUgbmFtZS4KICAgKiBAcGFyYW0ge09iamVjdHxJdGVyYWJsZX0gW2F0dHJzXSBDb2xsZWN0aW9uIG9mIGF0dHJpYnV0ZXMuCiAgICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlfEl0ZXJhYmxlLjxtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlPn0gW2NoaWxkcmVuXQogICAqIEEgbGlzdCBvZiBub2RlcyB0byBiZSBpbnNlcnRlZCBpbnRvIGNyZWF0ZWQgZWxlbWVudC4KICAgKi8KICBmdW5jdGlvbiBFbGVtZW50KGRvY3VtZW50LCBuYW1lLCBhdHRycywgY2hpbGRyZW4pIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRWxlbWVudCk7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkb2N1bWVudCk7CiAgICAvKioKICAgICAqIE5hbWUgb2YgdGhlIGVsZW1lbnQuCiAgICAgKgogICAgICogQHJlYWRvbmx5CiAgICAgKiBAbWVtYmVyIHtTdHJpbmd9CiAgICAgKi8KCiAgICBfdGhpcy5uYW1lID0gbmFtZTsKICAgIC8qKgogICAgICogTWFwIG9mIGF0dHJpYnV0ZXMsIHdoZXJlIGF0dHJpYnV0ZXMgbmFtZXMgYXJlIGtleXMgYW5kIGF0dHJpYnV0ZXMgdmFsdWVzIGFyZSB2YWx1ZXMuCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQG1lbWJlciB7TWFwfSAjX2F0dHJzCiAgICAgKi8KCiAgICBfdGhpcy5fYXR0cnMgPSBwYXJzZUF0dHJpYnV0ZXMoYXR0cnMpOwogICAgLyoqCiAgICAgKiBBcnJheSBvZiBjaGlsZCBub2Rlcy4KICAgICAqCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAbWVtYmVyIHtBcnJheS48bW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZT59CiAgICAgKi8KCiAgICBfdGhpcy5fY2hpbGRyZW4gPSBbXTsKCiAgICBpZiAoY2hpbGRyZW4pIHsKICAgICAgX3RoaXMuX2luc2VydENoaWxkKDAsIGNoaWxkcmVuKTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IG9mIGNsYXNzZXMgYXNzb2NpYXRlZCB3aXRoIGVsZW1lbnQgaW5zdGFuY2UuCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQG1lbWJlciB7U2V0fQogICAgICovCgoKICAgIF90aGlzLl9jbGFzc2VzID0gbmV3IFNldCgpOwoKICAgIGlmIChfdGhpcy5fYXR0cnMuaGFzKCdjbGFzcycpKSB7CiAgICAgIC8vIFJlbW92ZSBjbGFzcyBhdHRyaWJ1dGUgYW5kIGhhbmRsZSBpdCBieSBjbGFzcyBzZXQuCiAgICAgIHZhciBjbGFzc1N0cmluZyA9IF90aGlzLl9hdHRycy5nZXQoJ2NsYXNzJyk7CgogICAgICBwYXJzZUNsYXNzZXMoX3RoaXMuX2NsYXNzZXMsIGNsYXNzU3RyaW5nKTsKCiAgICAgIF90aGlzLl9hdHRycy5kZWxldGUoJ2NsYXNzJyk7CiAgICB9CiAgICAvKioKICAgICAqIE5vcm1hbGl6ZWQgc3R5bGVzLgogICAgICoKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBtZW1iZXIge21vZHVsZTplbmdpbmUvdmlldy9zdHlsZXNtYXB+U3R5bGVzTWFwfSBtb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50I19zdHlsZXMKICAgICAqLwoKCiAgICBfdGhpcy5fc3R5bGVzID0gbmV3IFN0eWxlc01hcChfdGhpcy5kb2N1bWVudC5zdHlsZXNQcm9jZXNzb3IpOwoKICAgIGlmIChfdGhpcy5fYXR0cnMuaGFzKCdzdHlsZScpKSB7CiAgICAgIC8vIFJlbW92ZSBzdHlsZSBhdHRyaWJ1dGUgYW5kIGhhbmRsZSBpdCBieSBzdHlsZXMgbWFwLgogICAgICBfdGhpcy5fc3R5bGVzLnNldFRvKF90aGlzLl9hdHRycy5nZXQoJ3N0eWxlJykpOwoKICAgICAgX3RoaXMuX2F0dHJzLmRlbGV0ZSgnc3R5bGUnKTsKICAgIH0KICAgIC8qKgogICAgICogTWFwIG9mIGN1c3RvbSBwcm9wZXJ0aWVzLgogICAgICogQ3VzdG9tIHByb3BlcnRpZXMgY2FuIGJlIGFkZGVkIHRvIGVsZW1lbnQgaW5zdGFuY2UsIHdpbGwgYmUgY2xvbmVkIGJ1dCBub3QgcmVuZGVyZWQgaW50byBET00uCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQG1lbWJlciB7TWFwfQogICAgICovCgoKICAgIF90aGlzLl9jdXN0b21Qcm9wZXJ0aWVzID0gbmV3IE1hcCgpOwogICAgLyoqCiAgICAgKiBXaGV0aGVyIGFuIGVsZW1lbnQgaXMgYWxsb3dlZCBpbnNpZGUgYW4gQXR0cmlidXRlRWxlbWVudCBhbmQgY2FuIGJlIHdyYXBwZWQgd2l0aAogICAgICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9hdHRyaWJ1dGVlbGVtZW50fkF0dHJpYnV0ZUVsZW1lbnR9IGJ5IHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXJ9LgogICAgICoKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBtZW1iZXIge0Jvb2xlYW59CiAgICAgKi8KCiAgICBfdGhpcy5faXNBbGxvd2VkSW5zaWRlQXR0cmlidXRlRWxlbWVudCA9IGZhbHNlOwogICAgcmV0dXJuIF90aGlzOwogIH0KICAvKioKICAgKiBOdW1iZXIgb2YgZWxlbWVudCdzIGNoaWxkcmVuLgogICAqCiAgICogQHJlYWRvbmx5CiAgICogQHR5cGUge051bWJlcn0KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhFbGVtZW50LCBbewogICAga2V5OiAiY2hpbGRDb3VudCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLmxlbmd0aDsKICAgIH0KICAgIC8qKgogICAgICogSXMgYHRydWVgIGlmIHRoZXJlIGFyZSBubyBub2RlcyBpbnNpZGUgdGhpcyBlbGVtZW50LCBgZmFsc2VgIG90aGVyd2lzZS4KICAgICAqCiAgICAgKiBAcmVhZG9ubHkKICAgICAqIEB0eXBlIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogImlzRW1wdHkiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbi5sZW5ndGggPT09IDA7CiAgICB9CiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhlIGVsZW1lbnQgaXMgYWxsb3dlZCBpbnNpZGUgYW4gQXR0cmlidXRlRWxlbWVudCBhbmQgY2FuIGJlIHdyYXBwZWQgd2l0aAogICAgICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9hdHRyaWJ1dGVlbGVtZW50fkF0dHJpYnV0ZUVsZW1lbnR9IGJ5IHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXJ9LgogICAgICoKICAgICAqIEByZWFkb25seQogICAgICogQHR5cGUge0Jvb2xlYW59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaXNBbGxvd2VkSW5zaWRlQXR0cmlidXRlRWxlbWVudCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2lzQWxsb3dlZEluc2lkZUF0dHJpYnV0ZUVsZW1lbnQ7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrcyB3aGV0aGVyIHRoaXMgb2JqZWN0IGlzIG9mIHRoZSBnaXZlbi4KICAgICAqCiAgICAgKgkJZWxlbWVudC5pcyggJ2VsZW1lbnQnICk7IC8vIC0+IHRydWUKICAgICAqCQllbGVtZW50LmlzKCAnbm9kZScgKTsgLy8gLT4gdHJ1ZQogICAgICoJCWVsZW1lbnQuaXMoICd2aWV3OmVsZW1lbnQnICk7IC8vIC0+IHRydWUKICAgICAqCQllbGVtZW50LmlzKCAndmlldzpub2RlJyApOyAvLyAtPiB0cnVlCiAgICAgKgogICAgICoJCWVsZW1lbnQuaXMoICdtb2RlbDplbGVtZW50JyApOyAvLyAtPiBmYWxzZQogICAgICoJCWVsZW1lbnQuaXMoICdkb2N1bWVudFNlbGVjdGlvbicgKTsgLy8gLT4gZmFsc2UKICAgICAqCiAgICAgKiBBc3N1bWluZyB0aGF0IHRoZSBvYmplY3QgYmVpbmcgY2hlY2tlZCBpcyBhbiBlbGVtZW50LCB5b3UgY2FuIGFsc28gY2hlY2sgaXRzCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudCNuYW1lIG5hbWV9OgogICAgICoKICAgICAqCQllbGVtZW50LmlzKCAnZWxlbWVudCcsICdpbWcnICk7IC8vIC0+IHRydWUgaWYgdGhpcyBpcyBhbiA8aW1nPiBlbGVtZW50CiAgICAgKgkJdGV4dC5pcyggJ2VsZW1lbnQnLCAnaW1nJyApOyAtPiBmYWxzZQogICAgICoKICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlI2lzIENoZWNrIHRoZSBlbnRpcmUgbGlzdCBvZiB2aWV3IG9iamVjdHN9IHdoaWNoIGltcGxlbWVudCB0aGUgYGlzKClgIG1ldGhvZC4KICAgICAqCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZSBUeXBlIHRvIGNoZWNrLgogICAgICogQHBhcmFtIHtTdHJpbmd9IFtuYW1lXSBFbGVtZW50IG5hbWUuCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXModHlwZSkgewogICAgICB2YXIgbmFtZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDsKCiAgICAgIGlmICghbmFtZSkgewogICAgICAgIHJldHVybiB0eXBlID09PSAnZWxlbWVudCcgfHwgdHlwZSA9PT0gJ3ZpZXc6ZWxlbWVudCcgfHwgLy8gRnJvbSBzdXBlci5pcygpLiBUaGlzIGlzIGhpZ2hseSB1dGlsaXNlZCBtZXRob2QgYW5kIGNhbm5vdCBjYWxsIHN1cGVyLiBTZWUgY2tlZGl0b3IvY2tlZGl0b3I1IzY1MjkuCiAgICAgICAgdHlwZSA9PT0gJ25vZGUnIHx8IHR5cGUgPT09ICd2aWV3Om5vZGUnOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuYW1lID09PSB0aGlzLm5hbWUgJiYgKHR5cGUgPT09ICdlbGVtZW50JyB8fCB0eXBlID09PSAndmlldzplbGVtZW50Jyk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogR2V0cyBjaGlsZCBhdCB0aGUgZ2l2ZW4gaW5kZXguCiAgICAgKgogICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4IEluZGV4IG9mIGNoaWxkLgogICAgICogQHJldHVybnMge21vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGV9IENoaWxkIG5vZGUuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Q2hpbGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENoaWxkKGluZGV4KSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbltpbmRleF07CiAgICB9CiAgICAvKioKICAgICAqIEdldHMgaW5kZXggb2YgdGhlIGdpdmVuIGNoaWxkIG5vZGUuIFJldHVybnMgYC0xYCBpZiBjaGlsZCBub2RlIGlzIG5vdCBmb3VuZC4KICAgICAqCiAgICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGV9IG5vZGUgQ2hpbGQgbm9kZS4KICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IEluZGV4IG9mIHRoZSBjaGlsZCBub2RlLgogICAgICovCgogIH0sIHsKICAgIGtleTogImdldENoaWxkSW5kZXgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENoaWxkSW5kZXgobm9kZSkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW4uaW5kZXhPZihub2RlKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0cyBjaGlsZCBub2RlcyBpdGVyYXRvci4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7SXRlcmFibGUuPG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGU+fSBDaGlsZCBub2RlcyBpdGVyYXRvci4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDaGlsZHJlbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2hpbGRyZW4oKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbltTeW1ib2wuaXRlcmF0b3JdKCk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYW4gaXRlcmF0b3IgdGhhdCBjb250YWlucyB0aGUga2V5cyBmb3IgYXR0cmlidXRlcy4gT3JkZXIgb2YgaW5zZXJ0aW5nIGF0dHJpYnV0ZXMgaXMgbm90IHByZXNlcnZlZC4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7SXRlcmFibGUuPFN0cmluZz59IEtleXMgZm9yIGF0dHJpYnV0ZXMuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0QXR0cmlidXRlS2V5cyIsCiAgICB2YWx1ZToKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIGdldEF0dHJpYnV0ZUtleXMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBnZXRBdHRyaWJ1dGVLZXlzJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBpZiAoISh0aGlzLl9jbGFzc2VzLnNpemUgPiAwKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiAnY2xhc3MnOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGlmICh0aGlzLl9zdHlsZXMuaXNFbXB0eSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiAnc3R5bGUnOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5kZWxlZ2F0ZVlpZWxkKHRoaXMuX2F0dHJzLmtleXMoKSwgInQwIiwgNyk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIGdldEF0dHJpYnV0ZUtleXMsIHRoaXMpOwogICAgfSkKICAgIC8qKgogICAgICogUmV0dXJucyBpdGVyYXRvciB0aGF0IGl0ZXJhdGVzIG92ZXIgdGhpcyBlbGVtZW50J3MgYXR0cmlidXRlcy4KICAgICAqCiAgICAgKiBBdHRyaWJ1dGVzIGFyZSByZXR1cm5lZCBhcyBhcnJheXMgY29udGFpbmluZyB0d28gaXRlbXMuIEZpcnN0IG9uZSBpcyBhdHRyaWJ1dGUga2V5IGFuZCBzZWNvbmQgaXMgYXR0cmlidXRlIHZhbHVlLgogICAgICogVGhpcyBmb3JtYXQgaXMgYWNjZXB0ZWQgYnkgbmF0aXZlIGBNYXBgIG9iamVjdCBhbmQgYWxzbyBjYW4gYmUgcGFzc2VkIGluIGBOb2RlYCBjb25zdHJ1Y3Rvci4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7SXRlcmFibGUuPCo+fQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldEF0dHJpYnV0ZXMiLAogICAgdmFsdWU6CiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBnZXRBdHRyaWJ1dGVzKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gZ2V0QXR0cmlidXRlcyQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5kZWxlZ2F0ZVlpZWxkKHRoaXMuX2F0dHJzLmVudHJpZXMoKSwgInQwIiwgMSk7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgaWYgKCEodGhpcy5fY2xhc3Nlcy5zaXplID4gMCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiBbJ2NsYXNzJywgdGhpcy5nZXRBdHRyaWJ1dGUoJ2NsYXNzJyldOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGlmICh0aGlzLl9zdHlsZXMuaXNFbXB0eSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIFsnc3R5bGUnLCB0aGlzLmdldEF0dHJpYnV0ZSgnc3R5bGUnKV07CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBnZXRBdHRyaWJ1dGVzLCB0aGlzKTsKICAgIH0pCiAgICAvKioKICAgICAqIEdldHMgYXR0cmlidXRlIGJ5IGtleS4gSWYgYXR0cmlidXRlIGlzIG5vdCBwcmVzZW50IC0gcmV0dXJucyB1bmRlZmluZWQuCiAgICAgKgogICAgICogQHBhcmFtIHtTdHJpbmd9IGtleSBBdHRyaWJ1dGUga2V5LgogICAgICogQHJldHVybnMge1N0cmluZ3x1bmRlZmluZWR9IEF0dHJpYnV0ZSB2YWx1ZS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRBdHRyaWJ1dGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEF0dHJpYnV0ZShrZXkpIHsKICAgICAgaWYgKGtleSA9PSAnY2xhc3MnKSB7CiAgICAgICAgaWYgKHRoaXMuX2NsYXNzZXMuc2l6ZSA+IDApIHsKICAgICAgICAgIHJldHVybiBfdG9Db25zdW1hYmxlQXJyYXkodGhpcy5fY2xhc3Nlcykuam9pbignICcpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PSAnc3R5bGUnKSB7CiAgICAgICAgdmFyIGlubGluZVN0eWxlID0gdGhpcy5fc3R5bGVzLnRvU3RyaW5nKCk7CgogICAgICAgIHJldHVybiBpbmxpbmVTdHlsZSA9PSAnJyA/IHVuZGVmaW5lZCA6IGlubGluZVN0eWxlOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5fYXR0cnMuZ2V0KGtleSk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciBhbiBhdHRyaWJ1dGUgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBleGlzdHMgaW4gdGhlIGVsZW1lbnQuCiAgICAgKgogICAgICogQHBhcmFtIHtTdHJpbmd9IGtleSBBdHRyaWJ1dGUga2V5LgogICAgICogQHJldHVybnMge0Jvb2xlYW59IGB0cnVlYCBpZiBhdHRyaWJ1dGUgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBleGlzdHMgaW4gdGhlIGVsZW1lbnQsIGZhbHNlIG90aGVyd2lzZS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJoYXNBdHRyaWJ1dGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhc0F0dHJpYnV0ZShrZXkpIHsKICAgICAgaWYgKGtleSA9PSAnY2xhc3MnKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX2NsYXNzZXMuc2l6ZSA+IDA7CiAgICAgIH0KCiAgICAgIGlmIChrZXkgPT0gJ3N0eWxlJykgewogICAgICAgIHJldHVybiAhdGhpcy5fc3R5bGVzLmlzRW1wdHk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLl9hdHRycy5oYXMoa2V5KTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2tzIGlmIHRoaXMgZWxlbWVudCBpcyBzaW1pbGFyIHRvIG90aGVyIGVsZW1lbnQuCiAgICAgKiBCb3RoIGVsZW1lbnRzIHNob3VsZCBoYXZlIHRoZSBzYW1lIG5hbWUgYW5kIGF0dHJpYnV0ZXMgdG8gYmUgY29uc2lkZXJlZCBhcyBzaW1pbGFyLiBUd28gc2ltaWxhciBlbGVtZW50cwogICAgICogY2FuIGNvbnRhaW4gZGlmZmVyZW50IHNldCBvZiBjaGlsZHJlbiBub2Rlcy4KICAgICAqCiAgICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IG90aGVyRWxlbWVudAogICAgICogQHJldHVybnMge0Jvb2xlYW59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaXNTaW1pbGFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc1NpbWlsYXIob3RoZXJFbGVtZW50KSB7CiAgICAgIGlmICghKG90aGVyRWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnQpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vIElmIGV4YWN0bHkgdGhlIHNhbWUgRWxlbWVudCBpcyBwcm92aWRlZCAtIHJldHVybiB0cnVlIGltbWVkaWF0ZWx5LgoKCiAgICAgIGlmICh0aGlzID09PSBvdGhlckVsZW1lbnQpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSAvLyBDaGVjayBlbGVtZW50IG5hbWUuCgoKICAgICAgaWYgKHRoaXMubmFtZSAhPSBvdGhlckVsZW1lbnQubmFtZSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyBDaGVjayBpc0FsbG93ZWRJbnNpZGVBdHRyaWJ1dGVFbGVtZW50IHByb3BlcnR5LgoKCiAgICAgIGlmICh0aGlzLmlzQWxsb3dlZEluc2lkZUF0dHJpYnV0ZUVsZW1lbnQgIT0gb3RoZXJFbGVtZW50LmlzQWxsb3dlZEluc2lkZUF0dHJpYnV0ZUVsZW1lbnQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gQ2hlY2sgbnVtYmVyIG9mIGF0dHJpYnV0ZXMsIGNsYXNzZXMgYW5kIHN0eWxlcy4KCgogICAgICBpZiAodGhpcy5fYXR0cnMuc2l6ZSAhPT0gb3RoZXJFbGVtZW50Ll9hdHRycy5zaXplIHx8IHRoaXMuX2NsYXNzZXMuc2l6ZSAhPT0gb3RoZXJFbGVtZW50Ll9jbGFzc2VzLnNpemUgfHwgdGhpcy5fc3R5bGVzLnNpemUgIT09IG90aGVyRWxlbWVudC5fc3R5bGVzLnNpemUpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gQ2hlY2sgaWYgYXR0cmlidXRlcyBhcmUgdGhlIHNhbWUuCgoKICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuX2F0dHJzKSwKICAgICAgICAgIF9zdGVwOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgdmFyIF9zdGVwJHZhbHVlID0gX3NsaWNlZFRvQXJyYXkoX3N0ZXAudmFsdWUsIDIpLAogICAgICAgICAgICAgIGtleSA9IF9zdGVwJHZhbHVlWzBdLAogICAgICAgICAgICAgIHZhbHVlID0gX3N0ZXAkdmFsdWVbMV07CgogICAgICAgICAgaWYgKCFvdGhlckVsZW1lbnQuX2F0dHJzLmhhcyhrZXkpIHx8IG90aGVyRWxlbWVudC5fYXR0cnMuZ2V0KGtleSkgIT09IHZhbHVlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIENoZWNrIGlmIGNsYXNzZXMgYXJlIHRoZSBzYW1lLgoKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICB9CgogICAgICB2YXIgX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuX2NsYXNzZXMpLAogICAgICAgICAgX3N0ZXAyOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjIucygpOyAhKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IF9zdGVwMi52YWx1ZTsKCiAgICAgICAgICBpZiAoIW90aGVyRWxlbWVudC5fY2xhc3Nlcy5oYXMoY2xhc3NOYW1lKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBDaGVjayBpZiBzdHlsZXMgYXJlIHRoZSBzYW1lLgoKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yMi5mKCk7CiAgICAgIH0KCiAgICAgIHZhciBfaXRlcmF0b3IzID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5fc3R5bGVzLmdldFN0eWxlTmFtZXMoKSksCiAgICAgICAgICBfc3RlcDM7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yMy5zKCk7ICEoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgcHJvcGVydHkgPSBfc3RlcDMudmFsdWU7CgogICAgICAgICAgaWYgKCFvdGhlckVsZW1lbnQuX3N0eWxlcy5oYXMocHJvcGVydHkpIHx8IG90aGVyRWxlbWVudC5fc3R5bGVzLmdldEFzU3RyaW5nKHByb3BlcnR5KSAhPT0gdGhpcy5fc3R5bGVzLmdldEFzU3RyaW5nKHByb3BlcnR5KSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IzLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IzLmYoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiBjbGFzcyBpcyBwcmVzZW50LgogICAgICogSWYgbW9yZSB0aGVuIG9uZSBjbGFzcyBpcyBwcm92aWRlZCAtIHJldHVybnMgdHJ1ZSBvbmx5IHdoZW4gYWxsIGNsYXNzZXMgYXJlIHByZXNlbnQuCiAgICAgKgogICAgICoJCWVsZW1lbnQuaGFzQ2xhc3MoICdmb28nICk7IC8vIFJldHVybnMgdHJ1ZSBpZiAnZm9vJyBjbGFzcyBpcyBwcmVzZW50LgogICAgICoJCWVsZW1lbnQuaGFzQ2xhc3MoICdmb28nLCAnYmFyJyApOyAvLyBSZXR1cm5zIHRydWUgaWYgJ2ZvbycgYW5kICdiYXInIGNsYXNzZXMgYXJlIGJvdGggcHJlc2VudC4KICAgICAqCiAgICAgKiBAcGFyYW0gey4uLlN0cmluZ30gY2xhc3NOYW1lCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaGFzQ2xhc3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhc0NsYXNzKCkgewogICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgY2xhc3NOYW1lID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICAgIGNsYXNzTmFtZVtfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgX2kgPSAwLCBfY2xhc3NOYW1lID0gY2xhc3NOYW1lOyBfaSA8IF9jbGFzc05hbWUubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgdmFyIG5hbWUgPSBfY2xhc3NOYW1lW19pXTsKCiAgICAgICAgaWYgKCF0aGlzLl9jbGFzc2VzLmhhcyhuYW1lKSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgaXRlcmF0b3IgdGhhdCBjb250YWlucyBhbGwgY2xhc3MgbmFtZXMuCiAgICAgKgogICAgICogQHJldHVybnMge0l0ZXJhYmxlLjxTdHJpbmc+fQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldENsYXNzTmFtZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENsYXNzTmFtZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jbGFzc2VzLmtleXMoKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBzdHlsZSB2YWx1ZSBmb3IgdGhlIGdpdmVuIHByb3BlcnR5IG1hZS4KICAgICAqIElmIHRoZSBzdHlsZSBkb2VzIG5vdCBleGlzdCBgdW5kZWZpbmVkYCBpcyByZXR1cm5lZC4KICAgICAqCiAgICAgKiAqKk5vdGUqKjogVGhpcyBtZXRob2QgY2FuIHdvcmsgd2l0aCBub3JtYWxpemVkIHN0eWxlIG5hbWVzIGlmCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9jb250cm9sbGVyL2RhdGFjb250cm9sbGVyfkRhdGFDb250cm9sbGVyI2FkZFN0eWxlUHJvY2Vzc29yUnVsZXMgYSBwYXJ0aWN1bGFyIHN0eWxlIHByb2Nlc3NvciBydWxlIGlzIGVuYWJsZWR9LgogICAgICogU2VlIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvc3R5bGVzbWFwflN0eWxlc01hcCNnZXRBc1N0cmluZyBgU3R5bGVzTWFwI2dldEFzU3RyaW5nKClgfSBmb3IgZGV0YWlscy4KICAgICAqCiAgICAgKiBGb3IgYW4gZWxlbWVudCB3aXRoIHN0eWxlIHNldCB0byBgJ21hcmdpbjoxcHgnYDoKICAgICAqCiAgICAgKgkJLy8gRW5hYmxlICdtYXJnaW4nIHNob3J0aGFuZCBwcm9jZXNzaW5nOgogICAgICoJCWVkaXRvci5kYXRhLmFkZFN0eWxlUHJvY2Vzc29yUnVsZXMoIGFkZE1hcmdpblJ1bGVzICk7CiAgICAgKgogICAgICoJCWNvbnN0IGVsZW1lbnQgPSB2aWV3LmNoYW5nZSggd3JpdGVyID0+IHsKICAgICAqCQkJY29uc3QgZWxlbWVudCA9IHdyaXRlci5jcmVhdGVFbGVtZW50KCk7CiAgICAgKgkJCXdyaXRlci5zZXRTdHlsZSggJ21hcmdpbicsICcxcHgnICk7CiAgICAgKgkJCXdyaXRlci5zZXRTdHlsZSggJ21hcmdpbi1ib3R0b20nLCAnM2VtJyApOwogICAgICoKICAgICAqCQkJcmV0dXJuIGVsZW1lbnQ7CiAgICAgKgkJfSApOwogICAgICoKICAgICAqCQllbGVtZW50LmdldFN0eWxlKCAnbWFyZ2luJyApOyAvLyAtPiAnbWFyZ2luOiAxcHggMXB4IDNlbTsnCiAgICAgKgogICAgICogQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5CiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfHVuZGVmaW5lZH0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRTdHlsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3R5bGUocHJvcGVydHkpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlcy5nZXRBc1N0cmluZyhwcm9wZXJ0eSk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBub3JtYWxpemVkIHN0eWxlIG9iamVjdCBvciBzaW5nbGUgc3R5bGUgdmFsdWUuCiAgICAgKgogICAgICogRm9yIGFuIGVsZW1lbnQgd2l0aCBzdHlsZSBzZXQgdG86IG1hcmdpbjoxcHggMnB4IDNlbTsKICAgICAqCiAgICAgKgkJZWxlbWVudC5nZXROb3JtYWxpemVkU3R5bGUoICdtYXJnaW4nICkgKTsKICAgICAqCiAgICAgKiB3aWxsIHJldHVybjoKICAgICAqCiAgICAgKgkJewogICAgICoJCQl0b3A6ICcxcHgnLAogICAgICoJCQlyaWdodDogJzJweCcsCiAgICAgKgkJCWJvdHRvbTogJzNlbScsCiAgICAgKgkJCWxlZnQ6ICcycHgnICAgIC8vIGEgbm9ybWFsaXplZCB2YWx1ZSBmcm9tIG1hcmdpbiBzaG9ydGhhbmQKICAgICAqCQl9CiAgICAgKgogICAgICogYW5kIHJlYWRpbmcgZm9yIHNpbmdsZSBzdHlsZSB2YWx1ZToKICAgICAqCiAgICAgKgkJc3R5bGVzLmdldE5vcm1hbGl6ZWRTdHlsZSggJ21hcmdpbi1sZWZ0JyApOwogICAgICoKICAgICAqIFdpbGwgcmV0dXJuIGEgYDJweGAgc3RyaW5nLgogICAgICoKICAgICAqICoqTm90ZSoqOiBUaGlzIG1ldGhvZCB3aWxsIHJldHVybiBub3JtYWxpemVkIHZhbHVlcyBvbmx5IGlmCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9jb250cm9sbGVyL2RhdGFjb250cm9sbGVyfkRhdGFDb250cm9sbGVyI2FkZFN0eWxlUHJvY2Vzc29yUnVsZXMgYSBwYXJ0aWN1bGFyIHN0eWxlIHByb2Nlc3NvciBydWxlIGlzIGVuYWJsZWR9LgogICAgICogU2VlIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvc3R5bGVzbWFwflN0eWxlc01hcCNnZXROb3JtYWxpemVkIGBTdHlsZXNNYXAjZ2V0Tm9ybWFsaXplZCgpYH0gZm9yIGRldGFpbHMuCiAgICAgKgogICAgICoKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eSBOYW1lIG9mIENTUyBwcm9wZXJ0eQogICAgICogQHJldHVybnMge09iamVjdHxTdHJpbmd8dW5kZWZpbmVkfQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldE5vcm1hbGl6ZWRTdHlsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Tm9ybWFsaXplZFN0eWxlKHByb3BlcnR5KSB7CiAgICAgIHJldHVybiB0aGlzLl9zdHlsZXMuZ2V0Tm9ybWFsaXplZChwcm9wZXJ0eSk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgaXRlcmF0b3IgdGhhdCBjb250YWlucyBhbGwgc3R5bGUgbmFtZXMuCiAgICAgKgogICAgICogQHJldHVybnMge0l0ZXJhYmxlLjxTdHJpbmc+fQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldFN0eWxlTmFtZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFN0eWxlTmFtZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdHlsZXMuZ2V0U3R5bGVOYW1lcygpOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgc3R5bGUga2V5cyBhcmUgcHJlc2VudC4KICAgICAqIElmIG1vcmUgdGhlbiBvbmUgc3R5bGUgcHJvcGVydHkgaXMgcHJvdmlkZWQgLSByZXR1cm5zIHRydWUgb25seSB3aGVuIGFsbCBwcm9wZXJ0aWVzIGFyZSBwcmVzZW50LgogICAgICoKICAgICAqCQllbGVtZW50Lmhhc1N0eWxlKCAnY29sb3InICk7IC8vIFJldHVybnMgdHJ1ZSBpZiAnYm9yZGVyLXRvcCcgc3R5bGUgaXMgcHJlc2VudC4KICAgICAqCQllbGVtZW50Lmhhc1N0eWxlKCAnY29sb3InLCAnYm9yZGVyLXRvcCcgKTsgLy8gUmV0dXJucyB0cnVlIGlmICdjb2xvcicgYW5kICdib3JkZXItdG9wJyBzdHlsZXMgYXJlIGJvdGggcHJlc2VudC4KICAgICAqCiAgICAgKiBAcGFyYW0gey4uLlN0cmluZ30gcHJvcGVydHkKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJoYXNTdHlsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzU3R5bGUoKSB7CiAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgcHJvcGVydHkgPSBuZXcgQXJyYXkoX2xlbjIpLCBfa2V5MiA9IDA7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHsKICAgICAgICBwcm9wZXJ0eVtfa2V5Ml0gPSBhcmd1bWVudHNbX2tleTJdOwogICAgICB9CgogICAgICBmb3IgKHZhciBfaTIgPSAwLCBfcHJvcGVydHkgPSBwcm9wZXJ0eTsgX2kyIDwgX3Byb3BlcnR5Lmxlbmd0aDsgX2kyKyspIHsKICAgICAgICB2YXIgbmFtZSA9IF9wcm9wZXJ0eVtfaTJdOwoKICAgICAgICBpZiAoIXRoaXMuX3N0eWxlcy5oYXMobmFtZSkpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFuY2VzdG9yIGVsZW1lbnQgdGhhdCBtYXRjaCBzcGVjaWZpZWQgcGF0dGVybi4KICAgICAqIFByb3ZpZGVkIHBhdHRlcm5zIHNob3VsZCBiZSBjb21wYXRpYmxlIHdpdGgge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9tYXRjaGVyfk1hdGNoZXIgTWF0Y2hlcn0gYXMgaXQgaXMgdXNlZCBpbnRlcm5hbGx5LgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L21hdGNoZXJ+TWF0Y2hlcgogICAgICogQHBhcmFtIHtPYmplY3R8U3RyaW5nfFJlZ0V4cHxGdW5jdGlvbn0gcGF0dGVybnMgUGF0dGVybnMgdXNlZCB0byBtYXRjaCBjb3JyZWN0IGFuY2VzdG9yLgogICAgICogU2VlIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvbWF0Y2hlcn5NYXRjaGVyfS4KICAgICAqIEByZXR1cm5zIHttb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50fG51bGx9IEZvdW5kIGVsZW1lbnQgb3IgYG51bGxgIGlmIG5vIG1hdGNoaW5nIGFuY2VzdG9yIHdhcyBmb3VuZC4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJmaW5kQW5jZXN0b3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRBbmNlc3RvcigpIHsKICAgICAgZm9yICh2YXIgX2xlbjMgPSBhcmd1bWVudHMubGVuZ3RoLCBwYXR0ZXJucyA9IG5ldyBBcnJheShfbGVuMyksIF9rZXkzID0gMDsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykgewogICAgICAgIHBhdHRlcm5zW19rZXkzXSA9IGFyZ3VtZW50c1tfa2V5M107CiAgICAgIH0KCiAgICAgIHZhciBtYXRjaGVyID0gX2NvbnN0cnVjdChNYXRjaGVyLCBwYXR0ZXJucyk7CgogICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7CgogICAgICB3aGlsZSAocGFyZW50KSB7CiAgICAgICAgaWYgKG1hdGNoZXIubWF0Y2gocGFyZW50KSkgewogICAgICAgICAgcmV0dXJuIHBhcmVudDsKICAgICAgICB9CgogICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBjdXN0b20gcHJvcGVydHkgdmFsdWUgZm9yIHRoZSBnaXZlbiBrZXkuCiAgICAgKgogICAgICogQHBhcmFtIHtTdHJpbmd8U3ltYm9sfSBrZXkKICAgICAqIEByZXR1cm5zIHsqfQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldEN1c3RvbVByb3BlcnR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDdXN0b21Qcm9wZXJ0eShrZXkpIHsKICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbVByb3BlcnRpZXMuZ2V0KGtleSk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYW4gaXRlcmF0b3Igd2hpY2ggaXRlcmF0ZXMgb3ZlciB0aGlzIGVsZW1lbnQncyBjdXN0b20gcHJvcGVydGllcy4KICAgICAqIEl0ZXJhdG9yIHByb3ZpZGVzIGBbIGtleSwgdmFsdWUgXWAgcGFpcnMgZm9yIGVhY2ggc3RvcmVkIHByb3BlcnR5LgogICAgICoKICAgICAqIEByZXR1cm5zIHtJdGVyYWJsZS48Kj59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Q3VzdG9tUHJvcGVydGllcyIsCiAgICB2YWx1ZToKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIGdldEN1c3RvbVByb3BlcnRpZXMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBnZXRDdXN0b21Qcm9wZXJ0aWVzJChfY29udGV4dDMpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmRlbGVnYXRlWWllbGQodGhpcy5fY3VzdG9tUHJvcGVydGllcy5lbnRyaWVzKCksICJ0MCIsIDEpOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgZ2V0Q3VzdG9tUHJvcGVydGllcywgdGhpcyk7CiAgICB9KQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGlkZW50aXR5IHN0cmluZyBiYXNlZCBvbiBlbGVtZW50J3MgbmFtZSwgc3R5bGVzLCBjbGFzc2VzIGFuZCBvdGhlciBhdHRyaWJ1dGVzLgogICAgICogVHdvIGVsZW1lbnRzIHRoYXQge0BsaW5rICNpc1NpbWlsYXIgYXJlIHNpbWlsYXJ9IHdpbGwgaGF2ZSBzYW1lIGlkZW50aXR5IHN0cmluZy4KICAgICAqIEl0IGhhcyB0aGUgZm9sbG93aW5nIGZvcm1hdDoKICAgICAqCiAgICAgKgkJJ25hbWUgY2xhc3M9ImNsYXNzMSxjbGFzczIiIHN0eWxlPSJzdHlsZTE6dmFsdWUxO3N0eWxlMjp2YWx1ZTIiIGF0dHIxPSJ2YWwxIiBhdHRyMj0idmFsMiInCiAgICAJICoKICAgICAqIEZvciBleGFtcGxlOgogICAgICoKICAgICAqCQljb25zdCBlbGVtZW50ID0gd3JpdGVyLmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQoICdmb28nLCB7CiAgICAgKgkJCWJhbmFuYTogJzEwJywKICAgICAqCQkJYXBwbGU6ICcyMCcsCiAgICAgKgkJCXN0eWxlOiAnY29sb3I6IHJlZDsgYm9yZGVyLWNvbG9yOiB3aGl0ZTsnLAogICAgICoJCQljbGFzczogJ2JheicKICAgICAqCQl9ICk7CiAgICAgKgogICAgICoJCS8vIHJldHVybnMgJ2ZvbyBjbGFzcz0iYmF6IiBzdHlsZT0iYm9yZGVyLWNvbG9yOndoaXRlO2NvbG9yOnJlZCIgYXBwbGU9IjIwIiBiYW5hbmE9IjEwIicKICAgICAqCQllbGVtZW50LmdldElkZW50aXR5KCk7CiAgICAgKgogICAgICogKipOb3RlKio6IENsYXNzZXMsIHN0eWxlcyBhbmQgb3RoZXIgYXR0cmlidXRlcyBhcmUgc29ydGVkIGFscGhhYmV0aWNhbGx5LgogICAgICoKICAgICAqIEByZXR1cm5zIHtTdHJpbmd9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0SWRlbnRpdHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldElkZW50aXR5KCkgewogICAgICB2YXIgY2xhc3NlcyA9IEFycmF5LmZyb20odGhpcy5fY2xhc3Nlcykuc29ydCgpLmpvaW4oJywnKTsKCiAgICAgIHZhciBzdHlsZXMgPSB0aGlzLl9zdHlsZXMudG9TdHJpbmcoKTsKCiAgICAgIHZhciBhdHRyaWJ1dGVzID0gQXJyYXkuZnJvbSh0aGlzLl9hdHRycykubWFwKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdChpWzBdLCAiPVwiIikuY29uY2F0KGlbMV0sICJcIiIpOwogICAgICB9KS5zb3J0KCkuam9pbignICcpOwogICAgICByZXR1cm4gdGhpcy5uYW1lICsgKGNsYXNzZXMgPT0gJycgPyAnJyA6ICIgY2xhc3M9XCIiLmNvbmNhdChjbGFzc2VzLCAiXCIiKSkgKyAoIXN0eWxlcyA/ICcnIDogIiBzdHlsZT1cIiIuY29uY2F0KHN0eWxlcywgIlwiIikpICsgKGF0dHJpYnV0ZXMgPT0gJycgPyAnJyA6ICIgIi5jb25jYXQoYXR0cmlidXRlcykpOwogICAgfQogICAgLyoqCiAgICAgKiBDbG9uZXMgcHJvdmlkZWQgZWxlbWVudC4KICAgICAqCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtkZWVwPWZhbHNlXSBJZiBzZXQgdG8gYHRydWVgIGNsb25lcyBlbGVtZW50IGFuZCBhbGwgaXRzIGNoaWxkcmVuIHJlY3Vyc2l2ZWx5LiBXaGVuIHNldCB0byBgZmFsc2VgLAogICAgICogZWxlbWVudCB3aWxsIGJlIGNsb25lZCB3aXRob3V0IGFueSBjaGlsZHJlbi4KICAgICAqIEByZXR1cm5zIHttb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50fSBDbG9uZSBvZiB0aGlzIGVsZW1lbnQuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX2Nsb25lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfY2xvbmUoKSB7CiAgICAgIHZhciBkZWVwID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgICAgdmFyIGNoaWxkcmVuQ2xvbmUgPSBbXTsKCiAgICAgIGlmIChkZWVwKSB7CiAgICAgICAgdmFyIF9pdGVyYXRvcjQgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmdldENoaWxkcmVuKCkpLAogICAgICAgICAgICBfc3RlcDQ7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgY2hpbGQgPSBfc3RlcDQudmFsdWU7CiAgICAgICAgICAgIGNoaWxkcmVuQ2xvbmUucHVzaChjaGlsZC5fY2xvbmUoZGVlcCkpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yNC5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvcjQuZigpOwogICAgICAgIH0KICAgICAgfSAvLyBDb250YWluZXJFbGVtZW50IGFuZCBBdHRyaWJ1dGVFbGVtZW50IHNob3VsZCBiZSBhbHNvIGNsb25lZCBwcm9wZXJseS4KCgogICAgICB2YXIgY2xvbmVkID0gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5kb2N1bWVudCwgdGhpcy5uYW1lLCB0aGlzLl9hdHRycywgY2hpbGRyZW5DbG9uZSk7IC8vIENsYXNzZXMgYW5kIHN0eWxlcyBhcmUgY2xvbmVkIHNlcGFyYXRlbHkgLSB0aGlzIHNvbHV0aW9uIGlzIGZhc3RlciB0aGFuIGFkZGluZyB0aGVtIGJhY2sgdG8gYXR0cmlidXRlcyBhbmQKICAgICAgLy8gcGFyc2Ugb25jZSBhZ2FpbiBpbiBjb25zdHJ1Y3Rvci4KCiAgICAgIGNsb25lZC5fY2xhc3NlcyA9IG5ldyBTZXQodGhpcy5fY2xhc3Nlcyk7CgogICAgICBjbG9uZWQuX3N0eWxlcy5zZXQodGhpcy5fc3R5bGVzLmdldE5vcm1hbGl6ZWQoKSk7IC8vIENsb25lIGN1c3RvbSBwcm9wZXJ0aWVzLgoKCiAgICAgIGNsb25lZC5fY3VzdG9tUHJvcGVydGllcyA9IG5ldyBNYXAodGhpcy5fY3VzdG9tUHJvcGVydGllcyk7IC8vIENsb25lIGZpbGxlciBvZmZzZXQgbWV0aG9kLgogICAgICAvLyBXZSBjYW4ndCBkZWZpbmUgdGhpcyBtZXRob2QgaW4gYSBwcm90b3R5cGUgYmVjYXVzZSBpdCdzIGJlaGF2aW9yIHdoaWNoCiAgICAgIC8vIGlzIGNoYW5nZWQgYnkgZS5nLiB0b1dpZGdldCgpIGZ1bmN0aW9uIGZyb20gY2tlZGl0b3I1LXdpZGdldC4gUGVyaGFwcyB0aGlzIHNob3VsZCBiZSBvbmUgb2YgY3VzdG9tIHByb3BzLgoKICAgICAgY2xvbmVkLmdldEZpbGxlck9mZnNldCA9IHRoaXMuZ2V0RmlsbGVyT2Zmc2V0OwogICAgICBjbG9uZWQuX2lzQWxsb3dlZEluc2lkZUF0dHJpYnV0ZUVsZW1lbnQgPSB0aGlzLmlzQWxsb3dlZEluc2lkZUF0dHJpYnV0ZUVsZW1lbnQ7CiAgICAgIHJldHVybiBjbG9uZWQ7CiAgICB9CiAgICAvKioKICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50I19pbnNlcnRDaGlsZCBJbnNlcnR9IGEgY2hpbGQgbm9kZSBvciBhIGxpc3Qgb2YgY2hpbGQgbm9kZXMgYXQgdGhlIGVuZCBvZiB0aGlzIG5vZGUKICAgICAqIGFuZCBzZXRzIHRoZSBwYXJlbnQgb2YgdGhlc2Ugbm9kZXMgdG8gdGhpcyBlbGVtZW50LgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI2luc2VydAogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvaXRlbX5JdGVtfEl0ZXJhYmxlLjxtb2R1bGU6ZW5naW5lL3ZpZXcvaXRlbX5JdGVtPn0gaXRlbXMgSXRlbXMgdG8gYmUgaW5zZXJ0ZWQuCiAgICAgKiBAZmlyZXMgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZSNjaGFuZ2UKICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IE51bWJlciBvZiBhcHBlbmRlZCBub2Rlcy4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfYXBwZW5kQ2hpbGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hcHBlbmRDaGlsZChpdGVtcykgewogICAgICByZXR1cm4gdGhpcy5faW5zZXJ0Q2hpbGQodGhpcy5jaGlsZENvdW50LCBpdGVtcyk7CiAgICB9CiAgICAvKioKICAgICAqIEluc2VydHMgYSBjaGlsZCBub2RlIG9yIGEgbGlzdCBvZiBjaGlsZCBub2RlcyBvbiB0aGUgZ2l2ZW4gaW5kZXggYW5kIHNldHMgdGhlIHBhcmVudCBvZiB0aGVzZSBub2RlcyB0bwogICAgICogdGhpcyBlbGVtZW50LgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI2luc2VydAogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4IFBvc2l0aW9uIHdoZXJlIG5vZGVzIHNob3VsZCBiZSBpbnNlcnRlZC4KICAgICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2l0ZW1+SXRlbXxJdGVyYWJsZS48bW9kdWxlOmVuZ2luZS92aWV3L2l0ZW1+SXRlbT59IGl0ZW1zIEl0ZW1zIHRvIGJlIGluc2VydGVkLgogICAgICogQGZpcmVzIG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGUjY2hhbmdlCiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfSBOdW1iZXIgb2YgaW5zZXJ0ZWQgbm9kZXMuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX2luc2VydENoaWxkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaW5zZXJ0Q2hpbGQoaW5kZXgsIGl0ZW1zKSB7CiAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoJ2NoaWxkcmVuJywgdGhpcyk7CgogICAgICB2YXIgY291bnQgPSAwOwogICAgICB2YXIgbm9kZXMgPSBub3JtYWxpemUodGhpcy5kb2N1bWVudCwgaXRlbXMpOwoKICAgICAgdmFyIF9pdGVyYXRvcjUgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihub2RlcyksCiAgICAgICAgICBfc3RlcDU7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yNS5zKCk7ICEoX3N0ZXA1ID0gX2l0ZXJhdG9yNS5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgbm9kZSA9IF9zdGVwNS52YWx1ZTsKCiAgICAgICAgICAvLyBJZiBub2RlIHRoYXQgaXMgYmVpbmcgYWRkZWQgdG8gdGhpcyBlbGVtZW50IGlzIGFscmVhZHkgaW5zaWRlIGFub3RoZXIgZWxlbWVudCwgZmlyc3QgcmVtb3ZlIGl0IGZyb20gdGhlIG9sZCBwYXJlbnQuCiAgICAgICAgICBpZiAobm9kZS5wYXJlbnQgIT09IG51bGwpIHsKICAgICAgICAgICAgbm9kZS5fcmVtb3ZlKCk7CiAgICAgICAgICB9CgogICAgICAgICAgbm9kZS5wYXJlbnQgPSB0aGlzOwogICAgICAgICAgbm9kZS5kb2N1bWVudCA9IHRoaXMuZG9jdW1lbnQ7CgogICAgICAgICAgdGhpcy5fY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAwLCBub2RlKTsKCiAgICAgICAgICBpbmRleCsrOwogICAgICAgICAgY291bnQrKzsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjUuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjUuZigpOwogICAgICB9CgogICAgICByZXR1cm4gY291bnQ7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgbnVtYmVyIG9mIGNoaWxkIG5vZGVzIHN0YXJ0aW5nIGF0IHRoZSBnaXZlbiBpbmRleCBhbmQgc2V0IHRoZSBwYXJlbnQgb2YgdGhlc2Ugbm9kZXMgdG8gYG51bGxgLgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI3JlbW92ZQogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4IE51bWJlciBvZiB0aGUgZmlyc3Qgbm9kZSB0byByZW1vdmUuCiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2hvd01hbnk9MV0gTnVtYmVyIG9mIG5vZGVzIHRvIHJlbW92ZS4KICAgICAqIEBmaXJlcyBtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlI2NoYW5nZQogICAgICogQHJldHVybnMge0FycmF5Ljxtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlPn0gVGhlIGFycmF5IG9mIHJlbW92ZWQgbm9kZXMuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3JlbW92ZUNoaWxkcmVuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVtb3ZlQ2hpbGRyZW4oaW5kZXgpIHsKICAgICAgdmFyIGhvd01hbnkgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IDE7CgogICAgICB0aGlzLl9maXJlQ2hhbmdlKCdjaGlsZHJlbicsIHRoaXMpOwoKICAgICAgZm9yICh2YXIgaSA9IGluZGV4OyBpIDwgaW5kZXggKyBob3dNYW55OyBpKyspIHsKICAgICAgICB0aGlzLl9jaGlsZHJlbltpXS5wYXJlbnQgPSBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW4uc3BsaWNlKGluZGV4LCBob3dNYW55KTsKICAgIH0KICAgIC8qKgogICAgICogQWRkcyBvciBvdmVyd3JpdGUgYXR0cmlidXRlIHdpdGggYSBzcGVjaWZpZWQga2V5IGFuZCB2YWx1ZS4KICAgICAqCiAgICAgKiBAc2VlIG1vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlciNzZXRBdHRyaWJ1dGUKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBrZXkgQXR0cmlidXRlIGtleS4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSBBdHRyaWJ1dGUgdmFsdWUuCiAgICAgKiBAZmlyZXMgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZSNjaGFuZ2UKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfc2V0QXR0cmlidXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0QXR0cmlidXRlKGtleSwgdmFsdWUpIHsKICAgICAgdmFsdWUgPSBTdHJpbmcodmFsdWUpOwoKICAgICAgdGhpcy5fZmlyZUNoYW5nZSgnYXR0cmlidXRlcycsIHRoaXMpOwoKICAgICAgaWYgKGtleSA9PSAnY2xhc3MnKSB7CiAgICAgICAgcGFyc2VDbGFzc2VzKHRoaXMuX2NsYXNzZXMsIHZhbHVlKTsKICAgICAgfSBlbHNlIGlmIChrZXkgPT0gJ3N0eWxlJykgewogICAgICAgIHRoaXMuX3N0eWxlcy5zZXRUbyh2YWx1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5fYXR0cnMuc2V0KGtleSwgdmFsdWUpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgYXR0cmlidXRlIGZyb20gdGhlIGVsZW1lbnQuCiAgICAgKgogICAgICogQHNlZSBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjcmVtb3ZlQXR0cmlidXRlCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IEF0dHJpYnV0ZSBrZXkuCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyB0cnVlIGlmIGFuIGF0dHJpYnV0ZSBleGlzdGVkIGFuZCBoYXMgYmVlbiByZW1vdmVkLgogICAgICogQGZpcmVzIG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGUjY2hhbmdlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3JlbW92ZUF0dHJpYnV0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbW92ZUF0dHJpYnV0ZShrZXkpIHsKICAgICAgdGhpcy5fZmlyZUNoYW5nZSgnYXR0cmlidXRlcycsIHRoaXMpOyAvLyBSZW1vdmUgY2xhc3MgYXR0cmlidXRlLgoKCiAgICAgIGlmIChrZXkgPT0gJ2NsYXNzJykgewogICAgICAgIGlmICh0aGlzLl9jbGFzc2VzLnNpemUgPiAwKSB7CiAgICAgICAgICB0aGlzLl9jbGFzc2VzLmNsZWFyKCk7CgogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gUmVtb3ZlIHN0eWxlIGF0dHJpYnV0ZS4KCgogICAgICBpZiAoa2V5ID09ICdzdHlsZScpIHsKICAgICAgICBpZiAoIXRoaXMuX3N0eWxlcy5pc0VtcHR5KSB7CiAgICAgICAgICB0aGlzLl9zdHlsZXMuY2xlYXIoKTsKCiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyBSZW1vdmUgb3RoZXIgYXR0cmlidXRlcy4KCgogICAgICByZXR1cm4gdGhpcy5fYXR0cnMuZGVsZXRlKGtleSk7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgc3BlY2lmaWVkIGNsYXNzLgogICAgICoKICAgICAqCQllbGVtZW50Ll9hZGRDbGFzcyggJ2ZvbycgKTsgLy8gQWRkcyAnZm9vJyBjbGFzcy4KICAgICAqCQllbGVtZW50Ll9hZGRDbGFzcyggWyAnZm9vJywgJ2JhcicgXSApOyAvLyBBZGRzICdmb28nIGFuZCAnYmFyJyBjbGFzc2VzLgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI2FkZENsYXNzCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAcGFyYW0ge0FycmF5LjxTdHJpbmc+fFN0cmluZ30gY2xhc3NOYW1lCiAgICAgKiBAZmlyZXMgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZSNjaGFuZ2UKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfYWRkQ2xhc3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hZGRDbGFzcyhjbGFzc05hbWUpIHsKICAgICAgdGhpcy5fZmlyZUNoYW5nZSgnYXR0cmlidXRlcycsIHRoaXMpOwoKICAgICAgdmFyIF9pdGVyYXRvcjYgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0b0FycmF5KGNsYXNzTmFtZSkpLAogICAgICAgICAgX3N0ZXA2OwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjYucygpOyAhKF9zdGVwNiA9IF9pdGVyYXRvcjYubigpKS5kb25lOykgewogICAgICAgICAgdmFyIG5hbWUgPSBfc3RlcDYudmFsdWU7CgogICAgICAgICAgdGhpcy5fY2xhc3Nlcy5hZGQobmFtZSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I2LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I2LmYoKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIHNwZWNpZmllZCBjbGFzcy4KICAgICAqCiAgICAgKgkJZWxlbWVudC5fcmVtb3ZlQ2xhc3MoICdmb28nICk7ICAvLyBSZW1vdmVzICdmb28nIGNsYXNzLgogICAgICoJCWVsZW1lbnQuX3JlbW92ZUNsYXNzKCBbICdmb28nLCAnYmFyJyBdICk7IC8vIFJlbW92ZXMgYm90aCAnZm9vJyBhbmQgJ2JhcicgY2xhc3Nlcy4KICAgICAqCiAgICAgKiBAc2VlIG1vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlciNyZW1vdmVDbGFzcwogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHtBcnJheS48U3RyaW5nPnxTdHJpbmd9IGNsYXNzTmFtZQogICAgICogQGZpcmVzIG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGUjY2hhbmdlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3JlbW92ZUNsYXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKSB7CiAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoJ2F0dHJpYnV0ZXMnLCB0aGlzKTsKCiAgICAgIHZhciBfaXRlcmF0b3I3ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodG9BcnJheShjbGFzc05hbWUpKSwKICAgICAgICAgIF9zdGVwNzsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3I3LnMoKTsgIShfc3RlcDcgPSBfaXRlcmF0b3I3Lm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBuYW1lID0gX3N0ZXA3LnZhbHVlOwoKICAgICAgICAgIHRoaXMuX2NsYXNzZXMuZGVsZXRlKG5hbWUpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yNy5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yNy5mKCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQWRkcyBzdHlsZSB0byB0aGUgZWxlbWVudC4KICAgICAqCiAgICAgKgkJZWxlbWVudC5fc2V0U3R5bGUoICdjb2xvcicsICdyZWQnICk7CiAgICAgKgkJZWxlbWVudC5fc2V0U3R5bGUoIHsKICAgICAqCQkJY29sb3I6ICdyZWQnLAogICAgICoJCQlwb3NpdGlvbjogJ2ZpeGVkJwogICAgICoJCX0gKTsKICAgICAqCiAgICAgKiAqKk5vdGUqKjogVGhpcyBtZXRob2QgY2FuIHdvcmsgd2l0aCBub3JtYWxpemVkIHN0eWxlIG5hbWVzIGlmCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9jb250cm9sbGVyL2RhdGFjb250cm9sbGVyfkRhdGFDb250cm9sbGVyI2FkZFN0eWxlUHJvY2Vzc29yUnVsZXMgYSBwYXJ0aWN1bGFyIHN0eWxlIHByb2Nlc3NvciBydWxlIGlzIGVuYWJsZWR9LgogICAgICogU2VlIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvc3R5bGVzbWFwflN0eWxlc01hcCNzZXQgYFN0eWxlc01hcCNzZXQoKWB9IGZvciBkZXRhaWxzLgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI3NldFN0eWxlCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IHByb3BlcnR5IFByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IHdpdGgga2V5IC0gdmFsdWUgcGFpcnMuCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW3ZhbHVlXSBWYWx1ZSB0byBzZXQuIFRoaXMgcGFyYW1ldGVyIGlzIGlnbm9yZWQgaWYgb2JqZWN0IGlzIHByb3ZpZGVkIGFzIHRoZSBmaXJzdCBwYXJhbWV0ZXIuCiAgICAgKiBAZmlyZXMgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZSNjaGFuZ2UKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfc2V0U3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRTdHlsZShwcm9wZXJ0eSwgdmFsdWUpIHsKICAgICAgdGhpcy5fZmlyZUNoYW5nZSgnYXR0cmlidXRlcycsIHRoaXMpOwoKICAgICAgdGhpcy5fc3R5bGVzLnNldChwcm9wZXJ0eSwgdmFsdWUpOwogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIHNwZWNpZmllZCBzdHlsZS4KICAgICAqCiAgICAgKgkJZWxlbWVudC5fcmVtb3ZlU3R5bGUoICdjb2xvcicgKTsgIC8vIFJlbW92ZXMgJ2NvbG9yJyBzdHlsZS4KICAgICAqCQllbGVtZW50Ll9yZW1vdmVTdHlsZSggWyAnY29sb3InLCAnYm9yZGVyLXRvcCcgXSApOyAvLyBSZW1vdmVzIGJvdGggJ2NvbG9yJyBhbmQgJ2JvcmRlci10b3AnIHN0eWxlcy4KICAgICAqCiAgICAgKiAqKk5vdGUqKjogVGhpcyBtZXRob2QgY2FuIHdvcmsgd2l0aCBub3JtYWxpemVkIHN0eWxlIG5hbWVzIGlmCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9jb250cm9sbGVyL2RhdGFjb250cm9sbGVyfkRhdGFDb250cm9sbGVyI2FkZFN0eWxlUHJvY2Vzc29yUnVsZXMgYSBwYXJ0aWN1bGFyIHN0eWxlIHByb2Nlc3NvciBydWxlIGlzIGVuYWJsZWR9LgogICAgICogU2VlIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvc3R5bGVzbWFwflN0eWxlc01hcCNyZW1vdmUgYFN0eWxlc01hcCNyZW1vdmUoKWB9IGZvciBkZXRhaWxzLgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI3JlbW92ZVN0eWxlCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAcGFyYW0ge0FycmF5LjxTdHJpbmc+fFN0cmluZ30gcHJvcGVydHkKICAgICAqIEBmaXJlcyBtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlI2NoYW5nZQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9yZW1vdmVTdHlsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbW92ZVN0eWxlKHByb3BlcnR5KSB7CiAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoJ2F0dHJpYnV0ZXMnLCB0aGlzKTsKCiAgICAgIHZhciBfaXRlcmF0b3I4ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodG9BcnJheShwcm9wZXJ0eSkpLAogICAgICAgICAgX3N0ZXA4OwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjgucygpOyAhKF9zdGVwOCA9IF9pdGVyYXRvcjgubigpKS5kb25lOykgewogICAgICAgICAgdmFyIG5hbWUgPSBfc3RlcDgudmFsdWU7CgogICAgICAgICAgdGhpcy5fc3R5bGVzLnJlbW92ZShuYW1lKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjguZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjguZigpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNldHMgYSBjdXN0b20gcHJvcGVydHkuIFVubGlrZSBhdHRyaWJ1dGVzLCBjdXN0b20gcHJvcGVydGllcyBhcmUgbm90IHJlbmRlcmVkIHRvIHRoZSBET00sCiAgICAgKiBzbyB0aGV5IGNhbiBiZSB1c2VkIHRvIGFkZCBzcGVjaWFsIGRhdGEgdG8gZWxlbWVudHMuCiAgICAgKgogICAgICogQHNlZSBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjc2V0Q3VzdG9tUHJvcGVydHkKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBwYXJhbSB7U3RyaW5nfFN5bWJvbH0ga2V5CiAgICAgKiBAcGFyYW0geyp9IHZhbHVlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3NldEN1c3RvbVByb3BlcnR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0Q3VzdG9tUHJvcGVydHkoa2V5LCB2YWx1ZSkgewogICAgICB0aGlzLl9jdXN0b21Qcm9wZXJ0aWVzLnNldChrZXksIHZhbHVlKTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyB0aGUgY3VzdG9tIHByb3BlcnR5IHN0b3JlZCB1bmRlciB0aGUgZ2l2ZW4ga2V5LgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI3JlbW92ZUN1c3RvbVByb3BlcnR5CiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAcGFyYW0ge1N0cmluZ3xTeW1ib2x9IGtleQogICAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiBwcm9wZXJ0eSB3YXMgcmVtb3ZlZC4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfcmVtb3ZlQ3VzdG9tUHJvcGVydHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW1vdmVDdXN0b21Qcm9wZXJ0eShrZXkpIHsKICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbVByb3BlcnRpZXMuZGVsZXRlKGtleSk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYmxvY2sge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9maWxsZXIgZmlsbGVyfSBvZmZzZXQgb3IgYG51bGxgIGlmIGJsb2NrIGZpbGxlciBpcyBub3QgbmVlZGVkLgogICAgICoKICAgICAqIEBhYnN0cmFjdAogICAgICogQG1ldGhvZCBtb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50I2dldEZpbGxlck9mZnNldAogICAgICovCiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vIHByaW50VHJlZSggbGV2ZWwgPSAwKSB7CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vIAlsZXQgc3RyaW5nID0gJyc7CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vCXN0cmluZyArPSAnXHQnLnJlcGVhdCggbGV2ZWwgKSArIGA8JHsgdGhpcy5uYW1lIH0keyBjb252ZXJ0TWFwVG9UYWdzKCB0aGlzLmdldEF0dHJpYnV0ZXMoKSApIH0+YDsKICAgIC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8JZm9yICggY29uc3QgY2hpbGQgb2YgdGhpcy5nZXRDaGlsZHJlbigpICkgewogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwkJaWYgKCBjaGlsZC5pcyggJyR0ZXh0JyApICkgewogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwkJCXN0cmluZyArPSAnXG4nICsgJ1x0Jy5yZXBlYXQoIGxldmVsICsgMSApICsgY2hpbGQuZGF0YTsKICAgIC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8JCX0gZWxzZSB7CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vCQkJc3RyaW5nICs9ICdcbicgKyBjaGlsZC5wcmludFRyZWUoIGxldmVsICsgMSApOwogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwkJfQogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwl9CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vCWlmICggdGhpcy5jaGlsZENvdW50ICkgewogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwkJc3RyaW5nICs9ICdcbicgKyAnXHQnLnJlcGVhdCggbGV2ZWwgKTsKICAgIC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8JfQogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwlzdHJpbmcgKz0gYDwvJHsgdGhpcy5uYW1lIH0+YDsKICAgIC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8JcmV0dXJuIHN0cmluZzsKICAgIC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8gfQogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLyBsb2dUcmVlKCkgewogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLyAJY29uc29sZS5sb2coIHRoaXMucHJpbnRUcmVlKCkgKTsKICAgIC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8gfQoKICB9XSk7CgogIHJldHVybiBFbGVtZW50Owp9KE5vZGUpOyAvLyBQYXJzZXMgYXR0cmlidXRlcyBwcm92aWRlZCB0byB0aGUgZWxlbWVudCBjb25zdHJ1Y3RvciBiZWZvcmUgdGhleSBhcmUgYXBwbGllZCB0byBhbiBlbGVtZW50LiBJZiBhdHRyaWJ1dGVzIGFyZSBwYXNzZWQKLy8gYXMgYW4gb2JqZWN0IChpbnN0ZWFkIG9mIGBJdGVyYWJsZWApLCB0aGUgb2JqZWN0IGlzIHRyYW5zZm9ybWVkIHRvIHRoZSBtYXAuIEF0dHJpYnV0ZXMgd2l0aCBgbnVsbGAgdmFsdWUgYXJlIHJlbW92ZWQuCi8vIEF0dHJpYnV0ZXMgd2l0aCBub24tYFN0cmluZ2AgdmFsdWUgYXJlIGNvbnZlcnRlZCB0byBgU3RyaW5nYC4KLy8KLy8gQHBhcmFtIHtPYmplY3R8SXRlcmFibGV9IGF0dHJzIEF0dHJpYnV0ZXMgdG8gcGFyc2UuCi8vIEByZXR1cm5zIHtNYXB9IFBhcnNlZCBhdHRyaWJ1dGVzLgoKCmV4cG9ydCB7IEVsZW1lbnQgYXMgZGVmYXVsdCB9OwoKZnVuY3Rpb24gcGFyc2VBdHRyaWJ1dGVzKGF0dHJzKSB7CiAgYXR0cnMgPSB0b01hcChhdHRycyk7CgogIHZhciBfaXRlcmF0b3I5ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoYXR0cnMpLAogICAgICBfc3RlcDk7CgogIHRyeSB7CiAgICBmb3IgKF9pdGVyYXRvcjkucygpOyAhKF9zdGVwOSA9IF9pdGVyYXRvcjkubigpKS5kb25lOykgewogICAgICB2YXIgX3N0ZXA5JHZhbHVlID0gX3NsaWNlZFRvQXJyYXkoX3N0ZXA5LnZhbHVlLCAyKSwKICAgICAgICAgIGtleSA9IF9zdGVwOSR2YWx1ZVswXSwKICAgICAgICAgIHZhbHVlID0gX3N0ZXA5JHZhbHVlWzFdOwoKICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgICAgYXR0cnMuZGVsZXRlKGtleSk7CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSB7CiAgICAgICAgYXR0cnMuc2V0KGtleSwgU3RyaW5nKHZhbHVlKSk7CiAgICAgIH0KICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9pdGVyYXRvcjkuZShlcnIpOwogIH0gZmluYWxseSB7CiAgICBfaXRlcmF0b3I5LmYoKTsKICB9CgogIHJldHVybiBhdHRyczsKfSAvLyBQYXJzZXMgY2xhc3MgYXR0cmlidXRlIGFuZCBwdXRzIGFsbCBjbGFzc2VzIGludG8gY2xhc3NlcyBzZXQuCi8vIENsYXNzZXMgc2V0IHMgY2xlYXJlZCBiZWZvcmUgaW5zZXJ0aW9uLgovLwovLyBAcGFyYW0ge1NldC48U3RyaW5nPn0gY2xhc3Nlc1NldCBTZXQgdG8gaW5zZXJ0IHBhcnNlZCBjbGFzc2VzLgovLyBAcGFyYW0ge1N0cmluZ30gY2xhc3Nlc1N0cmluZyBTdHJpbmcgd2l0aCBjbGFzc2VzIHRvIHBhcnNlLgoKCmZ1bmN0aW9uIHBhcnNlQ2xhc3NlcyhjbGFzc2VzU2V0LCBjbGFzc2VzU3RyaW5nKSB7CiAgdmFyIGNsYXNzQXJyYXkgPSBjbGFzc2VzU3RyaW5nLnNwbGl0KC9ccysvKTsKICBjbGFzc2VzU2V0LmNsZWFyKCk7CiAgY2xhc3NBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICByZXR1cm4gY2xhc3Nlc1NldC5hZGQobmFtZSk7CiAgfSk7Cn0gLy8gQ29udmVydHMgc3RyaW5ncyB0byBUZXh0IGFuZCBub24taXRlcmFibGVzIHRvIGFycmF5cy4KLy8KLy8gQHBhcmFtIHtTdHJpbmd8bW9kdWxlOmVuZ2luZS92aWV3L2l0ZW1+SXRlbXxJdGVyYWJsZS48U3RyaW5nfG1vZHVsZTplbmdpbmUvdmlldy9pdGVtfkl0ZW0+fQovLyBAcmV0dXJucyB7SXRlcmFibGUuPG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGU+fQoKCmZ1bmN0aW9uIG5vcm1hbGl6ZShkb2N1bWVudCwgbm9kZXMpIHsKICAvLyBTZXBhcmF0ZSBjb25kaXRpb24gYmVjYXVzZSBzdHJpbmcgaXMgaXRlcmFibGUuCiAgaWYgKHR5cGVvZiBub2RlcyA9PSAnc3RyaW5nJykgewogICAgcmV0dXJuIFtuZXcgVGV4dChkb2N1bWVudCwgbm9kZXMpXTsKICB9CgogIGlmICghaXNJdGVyYWJsZShub2RlcykpIHsKICAgIG5vZGVzID0gW25vZGVzXTsKICB9IC8vIEFycmF5LmZyb20gdG8gZW5hYmxlIC5tYXAoKSBvbiBub24tYXJyYXlzLgoKCiAgcmV0dXJuIEFycmF5LmZyb20obm9kZXMpLm1hcChmdW5jdGlvbiAobm9kZSkgewogICAgaWYgKHR5cGVvZiBub2RlID09ICdzdHJpbmcnKSB7CiAgICAgIHJldHVybiBuZXcgVGV4dChkb2N1bWVudCwgbm9kZSk7CiAgICB9CgogICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBUZXh0UHJveHkpIHsKICAgICAgcmV0dXJuIG5ldyBUZXh0KGRvY3VtZW50LCBub2RlLmRhdGEpOwogICAgfQoKICAgIHJldHVybiBub2RlOwogIH0pOwp9"},{"version":3,"sources":["/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-engine/src/view/element.js"],"names":["Node","Text","TextProxy","toMap","toArray","isIterable","Matcher","StylesMap","Element","document","name","attrs","children","_attrs","parseAttributes","_children","_insertChild","_classes","Set","has","classString","get","parseClasses","delete","_styles","stylesProcessor","setTo","_customProperties","Map","_isAllowedInsideAttributeElement","length","type","index","node","indexOf","Symbol","iterator","size","isEmpty","keys","entries","getAttribute","key","join","undefined","inlineStyle","toString","otherElement","isAllowedInsideAttributeElement","value","className","getStyleNames","property","getAsString","getNormalized","patterns","matcher","parent","match","classes","Array","from","sort","styles","attributes","map","i","deep","childrenClone","getChildren","child","push","_clone","cloned","constructor","set","getFillerOffset","items","childCount","_fireChange","count","nodes","normalize","_remove","splice","howMany","String","clear","add","remove","classesSet","classesString","classArray","split","forEach","data"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module engine/view/element\n */\n\nimport Node from './node';\nimport Text from './text';\nimport TextProxy from './textproxy';\nimport toMap from '@ckeditor/ckeditor5-utils/src/tomap';\nimport toArray from '@ckeditor/ckeditor5-utils/src/toarray';\nimport isIterable from '@ckeditor/ckeditor5-utils/src/isiterable';\nimport Matcher from './matcher';\nimport StylesMap from './stylesmap';\n\n// @if CK_DEBUG_ENGINE // const { convertMapToTags } = require( '../dev-utils/utils' );\n\n/**\n * View element.\n *\n * The editing engine does not define a fixed semantics of its elements (it is \"DTD-free\").\n * This is why the type of the {@link module:engine/view/element~Element} need to\n * be defined by the feature developer. When creating an element you should use one of the following methods:\n *\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createContainerElement `downcastWriter#createContainerElement()`}\n * in order to create a {@link module:engine/view/containerelement~ContainerElement},\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createAttributeElement `downcastWriter#createAttributeElement()`}\n * in order to create a {@link module:engine/view/attributeelement~AttributeElement},\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createEmptyElement `downcastWriter#createEmptyElement()`}\n * in order to create a {@link module:engine/view/emptyelement~EmptyElement}.\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createUIElement `downcastWriter#createUIElement()`}\n * in order to create a {@link module:engine/view/uielement~UIElement}.\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createEditableElement `downcastWriter#createEditableElement()`}\n * in order to create a {@link module:engine/view/editableelement~EditableElement}.\n *\n * Note that for view elements which are not created from the model, like elements from mutations, paste or\n * {@link module:engine/controller/datacontroller~DataController#set data.set} it is not possible to define the type of the element.\n * In such cases the {@link module:engine/view/upcastwriter~UpcastWriter#createElement `UpcastWriter#createElement()`} method\n * should be used to create generic view elements.\n *\n * @extends module:engine/view/node~Node\n */\nexport default class Element extends Node {\n\t/**\n\t * Creates a view element.\n\t *\n\t * Attributes can be passed in various formats:\n\t *\n\t *\t\tnew Element( viewDocument, 'div', { class: 'editor', contentEditable: 'true' } ); // object\n\t *\t\tnew Element( viewDocument, 'div', [ [ 'class', 'editor' ], [ 'contentEditable', 'true' ] ] ); // map-like iterator\n\t *\t\tnew Element( viewDocument, 'div', mapOfAttributes ); // map\n\t *\n\t * @protected\n\t * @param {module:engine/view/document~Document} document The document instance to which this element belongs.\n\t * @param {String} name Node name.\n\t * @param {Object|Iterable} [attrs] Collection of attributes.\n\t * @param {module:engine/view/node~Node|Iterable.<module:engine/view/node~Node>} [children]\n\t * A list of nodes to be inserted into created element.\n\t */\n\tconstructor( document, name, attrs, children ) {\n\t\tsuper( document );\n\n\t\t/**\n\t\t * Name of the element.\n\t\t *\n\t\t * @readonly\n\t\t * @member {String}\n\t\t */\n\t\tthis.name = name;\n\n\t\t/**\n\t\t * Map of attributes, where attributes names are keys and attributes values are values.\n\t\t *\n\t\t * @protected\n\t\t * @member {Map} #_attrs\n\t\t */\n\t\tthis._attrs = parseAttributes( attrs );\n\n\t\t/**\n\t\t * Array of child nodes.\n\t\t *\n\t\t * @protected\n\t\t * @member {Array.<module:engine/view/node~Node>}\n\t\t */\n\t\tthis._children = [];\n\n\t\tif ( children ) {\n\t\t\tthis._insertChild( 0, children );\n\t\t}\n\n\t\t/**\n\t\t * Set of classes associated with element instance.\n\t\t *\n\t\t * @protected\n\t\t * @member {Set}\n\t\t */\n\t\tthis._classes = new Set();\n\n\t\tif ( this._attrs.has( 'class' ) ) {\n\t\t\t// Remove class attribute and handle it by class set.\n\t\t\tconst classString = this._attrs.get( 'class' );\n\t\t\tparseClasses( this._classes, classString );\n\t\t\tthis._attrs.delete( 'class' );\n\t\t}\n\n\t\t/**\n\t\t * Normalized styles.\n\t\t *\n\t\t * @protected\n\t\t * @member {module:engine/view/stylesmap~StylesMap} module:engine/view/element~Element#_styles\n\t\t */\n\t\tthis._styles = new StylesMap( this.document.stylesProcessor );\n\n\t\tif ( this._attrs.has( 'style' ) ) {\n\t\t\t// Remove style attribute and handle it by styles map.\n\t\t\tthis._styles.setTo( this._attrs.get( 'style' ) );\n\n\t\t\tthis._attrs.delete( 'style' );\n\t\t}\n\n\t\t/**\n\t\t * Map of custom properties.\n\t\t * Custom properties can be added to element instance, will be cloned but not rendered into DOM.\n\t\t *\n\t\t * @protected\n\t\t * @member {Map}\n\t\t */\n\t\tthis._customProperties = new Map();\n\n\t\t/**\n\t\t * Whether an element is allowed inside an AttributeElement and can be wrapped with\n\t\t * {@link module:engine/view/attributeelement~AttributeElement} by {@link module:engine/view/downcastwriter~DowncastWriter}.\n\t\t *\n\t\t * @protected\n\t\t * @member {Boolean}\n\t\t */\n\t\tthis._isAllowedInsideAttributeElement = false;\n\t}\n\n\t/**\n\t * Number of element's children.\n\t *\n\t * @readonly\n\t * @type {Number}\n\t */\n\tget childCount() {\n\t\treturn this._children.length;\n\t}\n\n\t/**\n\t * Is `true` if there are no nodes inside this element, `false` otherwise.\n\t *\n\t * @readonly\n\t * @type {Boolean}\n\t */\n\tget isEmpty() {\n\t\treturn this._children.length === 0;\n\t}\n\n\t/**\n\t * Whether the element is allowed inside an AttributeElement and can be wrapped with\n\t * {@link module:engine/view/attributeelement~AttributeElement} by {@link module:engine/view/downcastwriter~DowncastWriter}.\n\t *\n\t * @readonly\n\t * @type {Boolean}\n\t */\n\tget isAllowedInsideAttributeElement() {\n\t\treturn this._isAllowedInsideAttributeElement;\n\t}\n\n\t/**\n\t * Checks whether this object is of the given.\n\t *\n\t *\t\telement.is( 'element' ); // -> true\n\t *\t\telement.is( 'node' ); // -> true\n\t *\t\telement.is( 'view:element' ); // -> true\n\t *\t\telement.is( 'view:node' ); // -> true\n\t *\n\t *\t\telement.is( 'model:element' ); // -> false\n\t *\t\telement.is( 'documentSelection' ); // -> false\n\t *\n\t * Assuming that the object being checked is an element, you can also check its\n\t * {@link module:engine/view/element~Element#name name}:\n\t *\n\t *\t\telement.is( 'element', 'img' ); // -> true if this is an <img> element\n\t *\t\ttext.is( 'element', 'img' ); -> false\n\t *\n\t * {@link module:engine/view/node~Node#is Check the entire list of view objects} which implement the `is()` method.\n\t *\n\t * @param {String} type Type to check.\n\t * @param {String} [name] Element name.\n\t * @returns {Boolean}\n\t */\n\tis( type, name = null ) {\n\t\tif ( !name ) {\n\t\t\treturn type === 'element' || type === 'view:element' ||\n\t\t\t\t// From super.is(). This is highly utilised method and cannot call super. See ckeditor/ckeditor5#6529.\n\t\t\t\ttype === 'node' || type === 'view:node';\n\t\t} else {\n\t\t\treturn name === this.name && ( type === 'element' || type === 'view:element' );\n\t\t}\n\t}\n\n\t/**\n\t * Gets child at the given index.\n\t *\n\t * @param {Number} index Index of child.\n\t * @returns {module:engine/view/node~Node} Child node.\n\t */\n\tgetChild( index ) {\n\t\treturn this._children[ index ];\n\t}\n\n\t/**\n\t * Gets index of the given child node. Returns `-1` if child node is not found.\n\t *\n\t * @param {module:engine/view/node~Node} node Child node.\n\t * @returns {Number} Index of the child node.\n\t */\n\tgetChildIndex( node ) {\n\t\treturn this._children.indexOf( node );\n\t}\n\n\t/**\n\t * Gets child nodes iterator.\n\t *\n\t * @returns {Iterable.<module:engine/view/node~Node>} Child nodes iterator.\n\t */\n\tgetChildren() {\n\t\treturn this._children[ Symbol.iterator ]();\n\t}\n\n\t/**\n\t * Returns an iterator that contains the keys for attributes. Order of inserting attributes is not preserved.\n\t *\n\t * @returns {Iterable.<String>} Keys for attributes.\n\t */\n\t* getAttributeKeys() {\n\t\tif ( this._classes.size > 0 ) {\n\t\t\tyield 'class';\n\t\t}\n\n\t\tif ( !this._styles.isEmpty ) {\n\t\t\tyield 'style';\n\t\t}\n\n\t\tyield* this._attrs.keys();\n\t}\n\n\t/**\n\t * Returns iterator that iterates over this element's attributes.\n\t *\n\t * Attributes are returned as arrays containing two items. First one is attribute key and second is attribute value.\n\t * This format is accepted by native `Map` object and also can be passed in `Node` constructor.\n\t *\n\t * @returns {Iterable.<*>}\n\t */\n\t* getAttributes() {\n\t\tyield* this._attrs.entries();\n\n\t\tif ( this._classes.size > 0 ) {\n\t\t\tyield [ 'class', this.getAttribute( 'class' ) ];\n\t\t}\n\n\t\tif ( !this._styles.isEmpty ) {\n\t\t\tyield [ 'style', this.getAttribute( 'style' ) ];\n\t\t}\n\t}\n\n\t/**\n\t * Gets attribute by key. If attribute is not present - returns undefined.\n\t *\n\t * @param {String} key Attribute key.\n\t * @returns {String|undefined} Attribute value.\n\t */\n\tgetAttribute( key ) {\n\t\tif ( key == 'class' ) {\n\t\t\tif ( this._classes.size > 0 ) {\n\t\t\t\treturn [ ...this._classes ].join( ' ' );\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif ( key == 'style' ) {\n\t\t\tconst inlineStyle = this._styles.toString();\n\n\t\t\treturn inlineStyle == '' ? undefined : inlineStyle;\n\t\t}\n\n\t\treturn this._attrs.get( key );\n\t}\n\n\t/**\n\t * Returns a boolean indicating whether an attribute with the specified key exists in the element.\n\t *\n\t * @param {String} key Attribute key.\n\t * @returns {Boolean} `true` if attribute with the specified key exists in the element, false otherwise.\n\t */\n\thasAttribute( key ) {\n\t\tif ( key == 'class' ) {\n\t\t\treturn this._classes.size > 0;\n\t\t}\n\n\t\tif ( key == 'style' ) {\n\t\t\treturn !this._styles.isEmpty;\n\t\t}\n\n\t\treturn this._attrs.has( key );\n\t}\n\n\t/**\n\t * Checks if this element is similar to other element.\n\t * Both elements should have the same name and attributes to be considered as similar. Two similar elements\n\t * can contain different set of children nodes.\n\t *\n\t * @param {module:engine/view/element~Element} otherElement\n\t * @returns {Boolean}\n\t */\n\tisSimilar( otherElement ) {\n\t\tif ( !( otherElement instanceof Element ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// If exactly the same Element is provided - return true immediately.\n\t\tif ( this === otherElement ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Check element name.\n\t\tif ( this.name != otherElement.name ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check isAllowedInsideAttributeElement property.\n\t\tif ( this.isAllowedInsideAttributeElement != otherElement.isAllowedInsideAttributeElement ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check number of attributes, classes and styles.\n\t\tif ( this._attrs.size !== otherElement._attrs.size || this._classes.size !== otherElement._classes.size ||\n\t\t\tthis._styles.size !== otherElement._styles.size ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check if attributes are the same.\n\t\tfor ( const [ key, value ] of this._attrs ) {\n\t\t\tif ( !otherElement._attrs.has( key ) || otherElement._attrs.get( key ) !== value ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// Check if classes are the same.\n\t\tfor ( const className of this._classes ) {\n\t\t\tif ( !otherElement._classes.has( className ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// Check if styles are the same.\n\t\tfor ( const property of this._styles.getStyleNames() ) {\n\t\t\tif (\n\t\t\t\t!otherElement._styles.has( property ) ||\n\t\t\t\totherElement._styles.getAsString( property ) !== this._styles.getAsString( property )\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Returns true if class is present.\n\t * If more then one class is provided - returns true only when all classes are present.\n\t *\n\t *\t\telement.hasClass( 'foo' ); // Returns true if 'foo' class is present.\n\t *\t\telement.hasClass( 'foo', 'bar' ); // Returns true if 'foo' and 'bar' classes are both present.\n\t *\n\t * @param {...String} className\n\t */\n\thasClass( ...className ) {\n\t\tfor ( const name of className ) {\n\t\t\tif ( !this._classes.has( name ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Returns iterator that contains all class names.\n\t *\n\t * @returns {Iterable.<String>}\n\t */\n\tgetClassNames() {\n\t\treturn this._classes.keys();\n\t}\n\n\t/**\n\t * Returns style value for the given property mae.\n\t * If the style does not exist `undefined` is returned.\n\t *\n\t * **Note**: This method can work with normalized style names if\n\t * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n\t * See {@link module:engine/view/stylesmap~StylesMap#getAsString `StylesMap#getAsString()`} for details.\n\t *\n\t * For an element with style set to `'margin:1px'`:\n\t *\n\t *\t\t// Enable 'margin' shorthand processing:\n\t *\t\teditor.data.addStyleProcessorRules( addMarginRules );\n\t *\n\t *\t\tconst element = view.change( writer => {\n\t *\t\t\tconst element = writer.createElement();\n\t *\t\t\twriter.setStyle( 'margin', '1px' );\n\t *\t\t\twriter.setStyle( 'margin-bottom', '3em' );\n\t *\n\t *\t\t\treturn element;\n\t *\t\t} );\n\t *\n\t *\t\telement.getStyle( 'margin' ); // -> 'margin: 1px 1px 3em;'\n\t *\n\t * @param {String} property\n\t * @returns {String|undefined}\n\t */\n\tgetStyle( property ) {\n\t\treturn this._styles.getAsString( property );\n\t}\n\n\t/**\n\t * Returns a normalized style object or single style value.\n\t *\n\t * For an element with style set to: margin:1px 2px 3em;\n\t *\n\t *\t\telement.getNormalizedStyle( 'margin' ) );\n\t *\n\t * will return:\n\t *\n\t *\t\t{\n\t *\t\t\ttop: '1px',\n\t *\t\t\tright: '2px',\n\t *\t\t\tbottom: '3em',\n\t *\t\t\tleft: '2px'    // a normalized value from margin shorthand\n\t *\t\t}\n\t *\n\t * and reading for single style value:\n\t *\n\t *\t\tstyles.getNormalizedStyle( 'margin-left' );\n\t *\n\t * Will return a `2px` string.\n\t *\n\t * **Note**: This method will return normalized values only if\n\t * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n\t * See {@link module:engine/view/stylesmap~StylesMap#getNormalized `StylesMap#getNormalized()`} for details.\n\t *\n\t *\n\t * @param {String} property Name of CSS property\n\t * @returns {Object|String|undefined}\n\t */\n\tgetNormalizedStyle( property ) {\n\t\treturn this._styles.getNormalized( property );\n\t}\n\n\t/**\n\t * Returns iterator that contains all style names.\n\t *\n\t * @returns {Iterable.<String>}\n\t */\n\tgetStyleNames() {\n\t\treturn this._styles.getStyleNames();\n\t}\n\n\t/**\n\t * Returns true if style keys are present.\n\t * If more then one style property is provided - returns true only when all properties are present.\n\t *\n\t *\t\telement.hasStyle( 'color' ); // Returns true if 'border-top' style is present.\n\t *\t\telement.hasStyle( 'color', 'border-top' ); // Returns true if 'color' and 'border-top' styles are both present.\n\t *\n\t * @param {...String} property\n\t */\n\thasStyle( ...property ) {\n\t\tfor ( const name of property ) {\n\t\t\tif ( !this._styles.has( name ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Returns ancestor element that match specified pattern.\n\t * Provided patterns should be compatible with {@link module:engine/view/matcher~Matcher Matcher} as it is used internally.\n\t *\n\t * @see module:engine/view/matcher~Matcher\n\t * @param {Object|String|RegExp|Function} patterns Patterns used to match correct ancestor.\n\t * See {@link module:engine/view/matcher~Matcher}.\n\t * @returns {module:engine/view/element~Element|null} Found element or `null` if no matching ancestor was found.\n\t */\n\tfindAncestor( ...patterns ) {\n\t\tconst matcher = new Matcher( ...patterns );\n\t\tlet parent = this.parent;\n\n\t\twhile ( parent ) {\n\t\t\tif ( matcher.match( parent ) ) {\n\t\t\t\treturn parent;\n\t\t\t}\n\n\t\t\tparent = parent.parent;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the custom property value for the given key.\n\t *\n\t * @param {String|Symbol} key\n\t * @returns {*}\n\t */\n\tgetCustomProperty( key ) {\n\t\treturn this._customProperties.get( key );\n\t}\n\n\t/**\n\t * Returns an iterator which iterates over this element's custom properties.\n\t * Iterator provides `[ key, value ]` pairs for each stored property.\n\t *\n\t * @returns {Iterable.<*>}\n\t */\n\t* getCustomProperties() {\n\t\tyield* this._customProperties.entries();\n\t}\n\n\t/**\n\t * Returns identity string based on element's name, styles, classes and other attributes.\n\t * Two elements that {@link #isSimilar are similar} will have same identity string.\n\t * It has the following format:\n\t *\n\t *\t\t'name class=\"class1,class2\" style=\"style1:value1;style2:value2\" attr1=\"val1\" attr2=\"val2\"'\n \t *\n\t * For example:\n\t *\n\t *\t\tconst element = writer.createContainerElement( 'foo', {\n\t *\t\t\tbanana: '10',\n\t *\t\t\tapple: '20',\n\t *\t\t\tstyle: 'color: red; border-color: white;',\n\t *\t\t\tclass: 'baz'\n\t *\t\t} );\n\t *\n\t *\t\t// returns 'foo class=\"baz\" style=\"border-color:white;color:red\" apple=\"20\" banana=\"10\"'\n\t *\t\telement.getIdentity();\n\t *\n\t * **Note**: Classes, styles and other attributes are sorted alphabetically.\n\t *\n\t * @returns {String}\n\t */\n\tgetIdentity() {\n\t\tconst classes = Array.from( this._classes ).sort().join( ',' );\n\t\tconst styles = this._styles.toString();\n\t\tconst attributes = Array.from( this._attrs ).map( i => `${ i[ 0 ] }=\"${ i[ 1 ] }\"` ).sort().join( ' ' );\n\n\t\treturn this.name +\n\t\t\t( classes == '' ? '' : ` class=\"${ classes }\"` ) +\n\t\t\t( !styles ? '' : ` style=\"${ styles }\"` ) +\n\t\t\t( attributes == '' ? '' : ` ${ attributes }` );\n\t}\n\n\t/**\n\t * Clones provided element.\n\t *\n\t * @protected\n\t * @param {Boolean} [deep=false] If set to `true` clones element and all its children recursively. When set to `false`,\n\t * element will be cloned without any children.\n\t * @returns {module:engine/view/element~Element} Clone of this element.\n\t */\n\t_clone( deep = false ) {\n\t\tconst childrenClone = [];\n\n\t\tif ( deep ) {\n\t\t\tfor ( const child of this.getChildren() ) {\n\t\t\t\tchildrenClone.push( child._clone( deep ) );\n\t\t\t}\n\t\t}\n\n\t\t// ContainerElement and AttributeElement should be also cloned properly.\n\t\tconst cloned = new this.constructor( this.document, this.name, this._attrs, childrenClone );\n\n\t\t// Classes and styles are cloned separately - this solution is faster than adding them back to attributes and\n\t\t// parse once again in constructor.\n\t\tcloned._classes = new Set( this._classes );\n\t\tcloned._styles.set( this._styles.getNormalized() );\n\n\t\t// Clone custom properties.\n\t\tcloned._customProperties = new Map( this._customProperties );\n\n\t\t// Clone filler offset method.\n\t\t// We can't define this method in a prototype because it's behavior which\n\t\t// is changed by e.g. toWidget() function from ckeditor5-widget. Perhaps this should be one of custom props.\n\t\tcloned.getFillerOffset = this.getFillerOffset;\n\n\t\tcloned._isAllowedInsideAttributeElement = this.isAllowedInsideAttributeElement;\n\n\t\treturn cloned;\n\t}\n\n\t/**\n\t * {@link module:engine/view/element~Element#_insertChild Insert} a child node or a list of child nodes at the end of this node\n\t * and sets the parent of these nodes to this element.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#insert\n\t * @protected\n\t * @param {module:engine/view/item~Item|Iterable.<module:engine/view/item~Item>} items Items to be inserted.\n\t * @fires module:engine/view/node~Node#change\n\t * @returns {Number} Number of appended nodes.\n\t */\n\t_appendChild( items ) {\n\t\treturn this._insertChild( this.childCount, items );\n\t}\n\n\t/**\n\t * Inserts a child node or a list of child nodes on the given index and sets the parent of these nodes to\n\t * this element.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#insert\n\t * @protected\n\t * @param {Number} index Position where nodes should be inserted.\n\t * @param {module:engine/view/item~Item|Iterable.<module:engine/view/item~Item>} items Items to be inserted.\n\t * @fires module:engine/view/node~Node#change\n\t * @returns {Number} Number of inserted nodes.\n\t */\n\t_insertChild( index, items ) {\n\t\tthis._fireChange( 'children', this );\n\t\tlet count = 0;\n\n\t\tconst nodes = normalize( this.document, items );\n\n\t\tfor ( const node of nodes ) {\n\t\t\t// If node that is being added to this element is already inside another element, first remove it from the old parent.\n\t\t\tif ( node.parent !== null ) {\n\t\t\t\tnode._remove();\n\t\t\t}\n\n\t\t\tnode.parent = this;\n\t\t\tnode.document = this.document;\n\n\t\t\tthis._children.splice( index, 0, node );\n\t\t\tindex++;\n\t\t\tcount++;\n\t\t}\n\n\t\treturn count;\n\t}\n\n\t/**\n\t * Removes number of child nodes starting at the given index and set the parent of these nodes to `null`.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#remove\n\t * @protected\n\t * @param {Number} index Number of the first node to remove.\n\t * @param {Number} [howMany=1] Number of nodes to remove.\n\t * @fires module:engine/view/node~Node#change\n\t * @returns {Array.<module:engine/view/node~Node>} The array of removed nodes.\n\t */\n\t_removeChildren( index, howMany = 1 ) {\n\t\tthis._fireChange( 'children', this );\n\n\t\tfor ( let i = index; i < index + howMany; i++ ) {\n\t\t\tthis._children[ i ].parent = null;\n\t\t}\n\n\t\treturn this._children.splice( index, howMany );\n\t}\n\n\t/**\n\t * Adds or overwrite attribute with a specified key and value.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#setAttribute\n\t * @protected\n\t * @param {String} key Attribute key.\n\t * @param {String} value Attribute value.\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_setAttribute( key, value ) {\n\t\tvalue = String( value );\n\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tif ( key == 'class' ) {\n\t\t\tparseClasses( this._classes, value );\n\t\t} else if ( key == 'style' ) {\n\t\t\tthis._styles.setTo( value );\n\t\t} else {\n\t\t\tthis._attrs.set( key, value );\n\t\t}\n\t}\n\n\t/**\n\t * Removes attribute from the element.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#removeAttribute\n\t * @protected\n\t * @param {String} key Attribute key.\n\t * @returns {Boolean} Returns true if an attribute existed and has been removed.\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_removeAttribute( key ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\t// Remove class attribute.\n\t\tif ( key == 'class' ) {\n\t\t\tif ( this._classes.size > 0 ) {\n\t\t\t\tthis._classes.clear();\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// Remove style attribute.\n\t\tif ( key == 'style' ) {\n\t\t\tif ( !this._styles.isEmpty ) {\n\t\t\t\tthis._styles.clear();\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// Remove other attributes.\n\t\treturn this._attrs.delete( key );\n\t}\n\n\t/**\n\t * Adds specified class.\n\t *\n\t *\t\telement._addClass( 'foo' ); // Adds 'foo' class.\n\t *\t\telement._addClass( [ 'foo', 'bar' ] ); // Adds 'foo' and 'bar' classes.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#addClass\n\t * @protected\n\t * @param {Array.<String>|String} className\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_addClass( className ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tfor ( const name of toArray( className ) ) {\n\t\t\tthis._classes.add( name );\n\t\t}\n\t}\n\n\t/**\n\t * Removes specified class.\n\t *\n\t *\t\telement._removeClass( 'foo' );  // Removes 'foo' class.\n\t *\t\telement._removeClass( [ 'foo', 'bar' ] ); // Removes both 'foo' and 'bar' classes.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#removeClass\n\t * @protected\n\t * @param {Array.<String>|String} className\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_removeClass( className ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tfor ( const name of toArray( className ) ) {\n\t\t\tthis._classes.delete( name );\n\t\t}\n\t}\n\n\t/**\n\t * Adds style to the element.\n\t *\n\t *\t\telement._setStyle( 'color', 'red' );\n\t *\t\telement._setStyle( {\n\t *\t\t\tcolor: 'red',\n\t *\t\t\tposition: 'fixed'\n\t *\t\t} );\n\t *\n\t * **Note**: This method can work with normalized style names if\n\t * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n\t * See {@link module:engine/view/stylesmap~StylesMap#set `StylesMap#set()`} for details.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#setStyle\n\t * @protected\n\t * @param {String|Object} property Property name or object with key - value pairs.\n\t * @param {String} [value] Value to set. This parameter is ignored if object is provided as the first parameter.\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_setStyle( property, value ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tthis._styles.set( property, value );\n\t}\n\n\t/**\n\t * Removes specified style.\n\t *\n\t *\t\telement._removeStyle( 'color' );  // Removes 'color' style.\n\t *\t\telement._removeStyle( [ 'color', 'border-top' ] ); // Removes both 'color' and 'border-top' styles.\n\t *\n\t * **Note**: This method can work with normalized style names if\n\t * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n\t * See {@link module:engine/view/stylesmap~StylesMap#remove `StylesMap#remove()`} for details.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#removeStyle\n\t * @protected\n\t * @param {Array.<String>|String} property\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_removeStyle( property ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tfor ( const name of toArray( property ) ) {\n\t\t\tthis._styles.remove( name );\n\t\t}\n\t}\n\n\t/**\n\t * Sets a custom property. Unlike attributes, custom properties are not rendered to the DOM,\n\t * so they can be used to add special data to elements.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#setCustomProperty\n\t * @protected\n\t * @param {String|Symbol} key\n\t * @param {*} value\n\t */\n\t_setCustomProperty( key, value ) {\n\t\tthis._customProperties.set( key, value );\n\t}\n\n\t/**\n\t * Removes the custom property stored under the given key.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#removeCustomProperty\n\t * @protected\n\t * @param {String|Symbol} key\n\t * @returns {Boolean} Returns true if property was removed.\n\t */\n\t_removeCustomProperty( key ) {\n\t\treturn this._customProperties.delete( key );\n\t}\n\n\t/**\n\t * Returns block {@link module:engine/view/filler filler} offset or `null` if block filler is not needed.\n\t *\n\t * @abstract\n\t * @method module:engine/view/element~Element#getFillerOffset\n\t */\n\n\t// @if CK_DEBUG_ENGINE // printTree( level = 0) {\n\t// @if CK_DEBUG_ENGINE // \tlet string = '';\n\n\t// @if CK_DEBUG_ENGINE //\tstring += '\\t'.repeat( level ) + `<${ this.name }${ convertMapToTags( this.getAttributes() ) }>`;\n\n\t// @if CK_DEBUG_ENGINE //\tfor ( const child of this.getChildren() ) {\n\t// @if CK_DEBUG_ENGINE //\t\tif ( child.is( '$text' ) ) {\n\t// @if CK_DEBUG_ENGINE //\t\t\tstring += '\\n' + '\\t'.repeat( level + 1 ) + child.data;\n\t// @if CK_DEBUG_ENGINE //\t\t} else {\n\t// @if CK_DEBUG_ENGINE //\t\t\tstring += '\\n' + child.printTree( level + 1 );\n\t// @if CK_DEBUG_ENGINE //\t\t}\n\t// @if CK_DEBUG_ENGINE //\t}\n\n\t// @if CK_DEBUG_ENGINE //\tif ( this.childCount ) {\n\t// @if CK_DEBUG_ENGINE //\t\tstring += '\\n' + '\\t'.repeat( level );\n\t// @if CK_DEBUG_ENGINE //\t}\n\n\t// @if CK_DEBUG_ENGINE //\tstring += `</${ this.name }>`;\n\n\t// @if CK_DEBUG_ENGINE //\treturn string;\n\t// @if CK_DEBUG_ENGINE // }\n\n\t// @if CK_DEBUG_ENGINE // logTree() {\n\t// @if CK_DEBUG_ENGINE // \tconsole.log( this.printTree() );\n\t// @if CK_DEBUG_ENGINE // }\n}\n\n// Parses attributes provided to the element constructor before they are applied to an element. If attributes are passed\n// as an object (instead of `Iterable`), the object is transformed to the map. Attributes with `null` value are removed.\n// Attributes with non-`String` value are converted to `String`.\n//\n// @param {Object|Iterable} attrs Attributes to parse.\n// @returns {Map} Parsed attributes.\nfunction parseAttributes( attrs ) {\n\tattrs = toMap( attrs );\n\n\tfor ( const [ key, value ] of attrs ) {\n\t\tif ( value === null ) {\n\t\t\tattrs.delete( key );\n\t\t} else if ( typeof value != 'string' ) {\n\t\t\tattrs.set( key, String( value ) );\n\t\t}\n\t}\n\n\treturn attrs;\n}\n\n// Parses class attribute and puts all classes into classes set.\n// Classes set s cleared before insertion.\n//\n// @param {Set.<String>} classesSet Set to insert parsed classes.\n// @param {String} classesString String with classes to parse.\nfunction parseClasses( classesSet, classesString ) {\n\tconst classArray = classesString.split( /\\s+/ );\n\tclassesSet.clear();\n\tclassArray.forEach( name => classesSet.add( name ) );\n}\n\n// Converts strings to Text and non-iterables to arrays.\n//\n// @param {String|module:engine/view/item~Item|Iterable.<String|module:engine/view/item~Item>}\n// @returns {Iterable.<module:engine/view/node~Node>}\nfunction normalize( document, nodes ) {\n\t// Separate condition because string is iterable.\n\tif ( typeof nodes == 'string' ) {\n\t\treturn [ new Text( document, nodes ) ];\n\t}\n\n\tif ( !isIterable( nodes ) ) {\n\t\tnodes = [ nodes ];\n\t}\n\n\t// Array.from to enable .map() on non-arrays.\n\treturn Array.from( nodes )\n\t\t.map( node => {\n\t\t\tif ( typeof node == 'string' ) {\n\t\t\t\treturn new Text( document, node );\n\t\t\t}\n\n\t\t\tif ( node instanceof TextProxy ) {\n\t\t\t\treturn new Text( document, node.data );\n\t\t\t}\n\n\t\t\treturn node;\n\t\t} );\n}\n"]}]}