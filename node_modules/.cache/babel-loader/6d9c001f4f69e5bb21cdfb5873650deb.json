{"remainingRequest":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js?{}!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-ui/src/toolbar/balloon/balloontoolbar.js","dependencies":[{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-ui/src/toolbar/balloon/balloontoolbar.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvaG9tZS9la2ViZXJhdC9ZYW5kZXguRGlzay9Qcm9qZWxlcmltL0JlbmltUHJvamVsZXJpbS93ZWJzaXRlbS93ZWJzaXRlbS13ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvaG9tZS9la2ViZXJhdC9ZYW5kZXguRGlzay9Qcm9qZWxlcmltL0JlbmltUHJvamVsZXJpbS93ZWJzaXRlbS93ZWJzaXRlbS13ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvaG9tZS9la2ViZXJhdC9ZYW5kZXguRGlzay9Qcm9qZWxlcmltL0JlbmltUHJvamVsZXJpbS93ZWJzaXRlbS93ZWJzaXRlbS13ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9nZXQgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9nZXQiOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIi9ob21lL2VrZWJlcmF0L1lhbmRleC5EaXNrL1Byb2plbGVyaW0vQmVuaW1Qcm9qZWxlcmltL3dlYnNpdGVtL3dlYnNpdGVtLXdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9ob21lL2VrZWJlcmF0L1lhbmRleC5EaXNrL1Byb2plbGVyaW0vQmVuaW1Qcm9qZWxlcmltL3dlYnNpdGVtL3dlYnNpdGVtLXdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMiOwppbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gIi9ob21lL2VrZWJlcmF0L1lhbmRleC5EaXNrL1Byb2plbGVyaW0vQmVuaW1Qcm9qZWxlcmltL3dlYnNpdGVtL3dlYnNpdGVtLXdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mcm9tLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKCi8qKgogKiBAbGljZW5zZSBDb3B5cmlnaHQgKGMpIDIwMDMtMjAyMSwgQ0tTb3VyY2UgLSBGcmVkZXJpY28gS25hYmJlbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogRm9yIGxpY2Vuc2luZywgc2VlIExJQ0VOU0UubWQgb3IgaHR0cHM6Ly9ja2VkaXRvci5jb20vbGVnYWwvY2tlZGl0b3Itb3NzLWxpY2Vuc2UKICovCgovKioKICogQG1vZHVsZSB1aS90b29sYmFyL2JhbGxvb24vYmFsbG9vbnRvb2xiYXIKICovCmltcG9ydCB7IFBsdWdpbiB9IGZyb20gJ2NrZWRpdG9yNS9zcmMvY29yZSc7CmltcG9ydCBDb250ZXh0dWFsQmFsbG9vbiBmcm9tICcuLi8uLi9wYW5lbC9iYWxsb29uL2NvbnRleHR1YWxiYWxsb29uJzsKaW1wb3J0IFRvb2xiYXJWaWV3IGZyb20gJy4uL3Rvb2xiYXJ2aWV3JzsKaW1wb3J0IEJhbGxvb25QYW5lbFZpZXcgZnJvbSAnLi4vLi4vcGFuZWwvYmFsbG9vbi9iYWxsb29ucGFuZWx2aWV3LmpzJzsKaW1wb3J0IEZvY3VzVHJhY2tlciBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LXV0aWxzL3NyYy9mb2N1c3RyYWNrZXInOwppbXBvcnQgUmVjdCBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LXV0aWxzL3NyYy9kb20vcmVjdCc7CmltcG9ydCBub3JtYWxpemVUb29sYmFyQ29uZmlnIGZyb20gJy4uL25vcm1hbGl6ZXRvb2xiYXJjb25maWcnOwppbXBvcnQgeyBkZWJvdW5jZSB9IGZyb20gJ2xvZGFzaC1lcyc7CmltcG9ydCBSZXNpemVPYnNlcnZlciBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LXV0aWxzL3NyYy9kb20vcmVzaXplb2JzZXJ2ZXInOwppbXBvcnQgdG9Vbml0IGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtdXRpbHMvc3JjL2RvbS90b3VuaXQnOwp2YXIgdG9QeCA9IHRvVW5pdCgncHgnKTsKLyoqCiAqIFRoZSBjb250ZXh0dWFsIHRvb2xiYXIuCiAqCiAqIEl0IHVzZXMgdGhlIHtAbGluayBtb2R1bGU6dWkvcGFuZWwvYmFsbG9vbi9jb250ZXh0dWFsYmFsbG9vbn5Db250ZXh0dWFsQmFsbG9vbiBjb250ZXh0dWFsIGJhbGxvb24gcGx1Z2lufS4KICoKICogQGV4dGVuZHMgbW9kdWxlOmNvcmUvcGx1Z2luflBsdWdpbgogKi8KCnZhciBCYWxsb29uVG9vbGJhciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1BsdWdpbikgewogIF9pbmhlcml0cyhCYWxsb29uVG9vbGJhciwgX1BsdWdpbik7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoQmFsbG9vblRvb2xiYXIpOwoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogIGZ1bmN0aW9uIEJhbGxvb25Ub29sYmFyKGVkaXRvcikgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYWxsb29uVG9vbGJhcik7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBlZGl0b3IpOwogICAgLyoqCiAgICAgKiBBIGNhY2hlZCBhbmQgbm9ybWFsaXplZCBgY29uZmlnLmJhbGxvb25Ub29sYmFyYCBvYmplY3QuCiAgICAgKgogICAgICogQHR5cGUge21vZHVsZTpjb3JlL2VkaXRvci9lZGl0b3Jjb25maWd+RWRpdG9yQ29uZmlnI2JhbGxvb25Ub29sYmFyfQogICAgICogQHByaXZhdGUKICAgICAqLwoKICAgIF90aGlzLl9iYWxsb29uQ29uZmlnID0gbm9ybWFsaXplVG9vbGJhckNvbmZpZyhlZGl0b3IuY29uZmlnLmdldCgnYmFsbG9vblRvb2xiYXInKSk7CiAgICAvKioKICAgICAqIFRoZSB0b29sYmFyIHZpZXcgZGlzcGxheWVkIGluIHRoZSBiYWxsb29uLgogICAgICoKICAgICAqIEB0eXBlIHttb2R1bGU6dWkvdG9vbGJhci90b29sYmFydmlld35Ub29sYmFyVmlld30KICAgICAqLwoKICAgIF90aGlzLnRvb2xiYXJWaWV3ID0gX3RoaXMuX2NyZWF0ZVRvb2xiYXJWaWV3KCk7CiAgICAvKioKICAgICAqIFRyYWNrcyB0aGUgZm9jdXMgb2YgdGhlIHtAbGluayBtb2R1bGU6Y29yZS9lZGl0b3IvZWRpdG9ydWl+RWRpdG9yVUkjZ2V0RWRpdGFibGVFbGVtZW50IGVkaXRhYmxlIGVsZW1lbnR9CiAgICAgKiBhbmQgdGhlIHtAbGluayAjdG9vbGJhclZpZXd9LiBXaGVuIGJvdGggYXJlIGJsdXJyZWQgdGhlbiB0aGUgdG9vbGJhciBzaG91bGQgaGlkZS4KICAgICAqCiAgICAgKiBAcmVhZG9ubHkKICAgICAqIEB0eXBlIHttb2R1bGU6dXRpbHM6Zm9jdXN0cmFja2VyfkZvY3VzVHJhY2tlcn0KICAgICAqLwoKICAgIF90aGlzLmZvY3VzVHJhY2tlciA9IG5ldyBGb2N1c1RyYWNrZXIoKTsgLy8gV2FpdCBmb3IgdGhlIEVkaXRvclVJI2luaXQuIEVkaXRhYmxlRWxlbWVudCBpcyBub3QgYXZhaWxhYmxlIGJlZm9yZS4KCiAgICBlZGl0b3IudWkub25jZSgncmVhZHknLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLmZvY3VzVHJhY2tlci5hZGQoZWRpdG9yLnVpLmdldEVkaXRhYmxlRWxlbWVudCgpKTsKCiAgICAgIF90aGlzLmZvY3VzVHJhY2tlci5hZGQoX3RoaXMudG9vbGJhclZpZXcuZWxlbWVudCk7CiAgICB9KTsKICAgIC8qKgogICAgICogQW4gaW5zdGFuY2Ugb2YgdGhlIHJlc2l6ZSBvYnNlcnZlciB0aGF0IGFsbG93cyB0byByZXNwb25kIHRvIGNoYW5nZXMgaW4gZWRpdGFibGUncyBnZW9tZXRyeQogICAgICogc28gdGhlIHRvb2xiYXIgY2FuIHN0YXkgd2l0aGluIGl0cyBib3VuZGFyaWVzIChhbmQgZ3JvdXAgdG9vbGJhciBpdGVtcyB0aGF0IGRvIG5vdCBmaXQpLgogICAgICoKICAgICAqICoqTm90ZSoqOiBVc2VkIG9ubHkgd2hlbiBgc2hvdWxkTm90R3JvdXBXaGVuRnVsbGAgd2FzICoqbm90Kiogc2V0IGluIHRoZQogICAgICoge0BsaW5rIG1vZHVsZTpjb3JlL2VkaXRvci9lZGl0b3Jjb25maWd+RWRpdG9yQ29uZmlnI2JhbGxvb25Ub29sYmFyIGNvbmZpZ3VyYXRpb259LgogICAgICoKICAgICAqICoqTm90ZToqKiBDcmVhdGVkIGluIHtAbGluayAjaW5pdH0uCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQG1lbWJlciB7bW9kdWxlOnV0aWxzL2RvbS9yZXNpemVvYnNlcnZlcn5SZXNpemVPYnNlcnZlcn0KICAgICAqLwoKICAgIF90aGlzLl9yZXNpemVPYnNlcnZlciA9IG51bGw7CiAgICAvKioKICAgICAqIFRoZSBjb250ZXh0dWFsIGJhbGxvb24gcGx1Z2luIGluc3RhbmNlLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAdHlwZSB7bW9kdWxlOnVpL3BhbmVsL2JhbGxvb24vY29udGV4dHVhbGJhbGxvb25+Q29udGV4dHVhbEJhbGxvb259CiAgICAgKi8KCiAgICBfdGhpcy5fYmFsbG9vbiA9IGVkaXRvci5wbHVnaW5zLmdldChDb250ZXh0dWFsQmFsbG9vbik7CiAgICAvKioKICAgICAqIEZpcmVzIHtAbGluayAjZXZlbnQ6X3NlbGVjdGlvbkNoYW5nZURlYm91bmNlZH0gZXZlbnQgdXNpbmcgYGxvZGFzaCNkZWJvdW5jZWAuCiAgICAgKgogICAgICogVGhpcyBmdW5jdGlvbiBpcyBzdG9yZWQgYXMgYSBwbHVnaW4gcHJvcGVydHkgdG8gbWFrZSBwb3NzaWJsZSB0byBjYW5jZWwKICAgICAqIHRyYWlsaW5nIGRlYm91bmNlZCBpbnZvY2F0aW9uIG9uIGRlc3Ryb3kuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEB0eXBlIHtGdW5jdGlvbn0KICAgICAqLwoKICAgIF90aGlzLl9maXJlU2VsZWN0aW9uQ2hhbmdlRGVib3VuY2VkID0gZGVib3VuY2UoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX3RoaXMuZmlyZSgnX3NlbGVjdGlvbkNoYW5nZURlYm91bmNlZCcpOwogICAgfSwgMjAwKTsgLy8gVGhlIGFwcGVhcmFuY2Ugb2YgdGhlIEJhbGxvb25Ub29sYmFyIG1ldGhvZCBpcyBldmVudOKAk2RyaXZlbi4KICAgIC8vIEl0IGlzIHBvc3NpYmxlIHRvIHN0b3AgdGhlICNzaG93IGV2ZW50IGFuZCB0aGlzIHByZXZlbnQgdGhlIHRvb2xiYXIgZnJvbSBzaG93aW5nIHVwLgoKICAgIF90aGlzLmRlY29yYXRlKCdzaG93Jyk7CgogICAgcmV0dXJuIF90aGlzOwogIH0KICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKEJhbGxvb25Ub29sYmFyLCBbewogICAga2V5OiAiaW5pdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgZWRpdG9yID0gdGhpcy5lZGl0b3I7CiAgICAgIHZhciBzZWxlY3Rpb24gPSBlZGl0b3IubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uOyAvLyBTaG93L2hpZGUgdGhlIHRvb2xiYXIgb24gZWRpdGFibGUgZm9jdXMvYmx1ci4KCiAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5mb2N1c1RyYWNrZXIsICdjaGFuZ2U6aXNGb2N1c2VkJywgZnVuY3Rpb24gKGV2dCwgbmFtZSwgaXNGb2N1c2VkKSB7CiAgICAgICAgdmFyIGlzVG9vbGJhclZpc2libGUgPSBfdGhpczIuX2JhbGxvb24udmlzaWJsZVZpZXcgPT09IF90aGlzMi50b29sYmFyVmlldzsKCiAgICAgICAgaWYgKCFpc0ZvY3VzZWQgJiYgaXNUb29sYmFyVmlzaWJsZSkgewogICAgICAgICAgX3RoaXMyLmhpZGUoKTsKICAgICAgICB9IGVsc2UgaWYgKGlzRm9jdXNlZCkgewogICAgICAgICAgX3RoaXMyLnNob3coKTsKICAgICAgICB9CiAgICAgIH0pOyAvLyBIaWRlIHRoZSB0b29sYmFyIHdoZW4gdGhlIHNlbGVjdGlvbiBpcyBjaGFuZ2VkIGJ5IGEgZGlyZWN0IGNoYW5nZSBvciBoYXMgY2hhbmdlZCB0byBjb2xsYXBzZWQuCgogICAgICB0aGlzLmxpc3RlblRvKHNlbGVjdGlvbiwgJ2NoYW5nZTpyYW5nZScsIGZ1bmN0aW9uIChldnQsIGRhdGEpIHsKICAgICAgICBpZiAoZGF0YS5kaXJlY3RDaGFuZ2UgfHwgc2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7CiAgICAgICAgICBfdGhpczIuaGlkZSgpOwogICAgICAgIH0gLy8gRmlyZSBpbnRlcm5hbCBgX3NlbGVjdGlvbkNoYW5nZURlYm91bmNlZGAgZXZlbnQgdG8gdXNlIGl0IGZvciBzaG93aW5nCiAgICAgICAgLy8gdGhlIHRvb2xiYXIgYWZ0ZXIgdGhlIHNlbGVjdGlvbiBzdG9wcyBjaGFuZ2luZy4KCgogICAgICAgIF90aGlzMi5fZmlyZVNlbGVjdGlvbkNoYW5nZURlYm91bmNlZCgpOwogICAgICB9KTsgLy8gU2hvdyB0aGUgdG9vbGJhciB3aGVuIHRoZSBzZWxlY3Rpb24gc3RvcHMgY2hhbmdpbmcuCgogICAgICB0aGlzLmxpc3RlblRvKHRoaXMsICdfc2VsZWN0aW9uQ2hhbmdlRGVib3VuY2VkJywgZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChfdGhpczIuZWRpdG9yLmVkaXRpbmcudmlldy5kb2N1bWVudC5pc0ZvY3VzZWQpIHsKICAgICAgICAgIF90aGlzMi5zaG93KCk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmICghdGhpcy5fYmFsbG9vbkNvbmZpZy5zaG91bGROb3RHcm91cFdoZW5GdWxsKSB7CiAgICAgICAgdGhpcy5saXN0ZW5UbyhlZGl0b3IsICdyZWFkeScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlZGl0YWJsZUVsZW1lbnQgPSBlZGl0b3IudWkudmlldy5lZGl0YWJsZS5lbGVtZW50OyAvLyBTZXQgI3Rvb2xiYXJWaWV3J3MgbWF4LXdpZHRoIG9uIHRoZSBpbml0aWFsaXphdGlvbiBhbmQgdXBkYXRlIGl0IG9uIHRoZSBlZGl0YWJsZSByZXNpemUuCgogICAgICAgICAgX3RoaXMyLl9yZXNpemVPYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcihlZGl0YWJsZUVsZW1lbnQsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8gVGhlIG1heC13aWR0aCBlcXVhbHMgOTAlIG9mIHRoZSBlZGl0YWJsZSdzIHdpZHRoIGZvciB0aGUgYmVzdCB1c2VyIGV4cGVyaWVuY2UuCiAgICAgICAgICAgIC8vIFRoZSB2YWx1ZSBrZWVwcyB0aGUgYmFsbG9vbiB2ZXJ5IGNsb3NlIHRvIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBlZGl0YWJsZSBhbmQgbGltaXRzIHRoZSBjYXNlcwogICAgICAgICAgICAvLyB3aGVuIHRoZSBiYWxsb29uIGp1dHMgb3V0IGZyb20gdGhlIGVkaXRhYmxlIGVsZW1lbnQgaXQgYmVsb25ncyB0by4KICAgICAgICAgICAgX3RoaXMyLnRvb2xiYXJWaWV3Lm1heFdpZHRoID0gdG9QeChuZXcgUmVjdChlZGl0YWJsZUVsZW1lbnQpLndpZHRoICogLjkpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0gLy8gTGlzdGVuIHRvIHRoZSB0b29sYmFyIHZpZXcgYW5kIHdoZW5ldmVyIGl0IGNoYW5nZXMgaXRzIGdlb21ldHJ5IGR1ZSB0byBzb21lIGl0ZW1zIGJlaW5nCiAgICAgIC8vIGdyb3VwZWQgb3IgdW5ncm91cGVkLCB1cGRhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBiYWxsb29uIGJlY2F1c2UgYSBzaG9ydGVyL2xvbmdlciB0b29sYmFyCiAgICAgIC8vIG1lYW5zIHRoZSBiYWxsb29uIGNvdWxkIGJlIHBvaW50aW5nIGF0IHRoZSB3cm9uZyBwbGFjZS4gT25jZSB1cGRhdGVkLCB0aGUgYmFsbG9vbiB3aWxsIHBvaW50CiAgICAgIC8vIGF0IHRoZSByaWdodCBzZWxlY3Rpb24gaW4gdGhlIGNvbnRlbnQgYWdhaW4uCiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ja2VkaXRvci9ja2VkaXRvcjUvaXNzdWVzLzY0NDQKCgogICAgICB0aGlzLmxpc3RlblRvKHRoaXMudG9vbGJhclZpZXcsICdncm91cGVkSXRlbXNVcGRhdGUnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMyLl91cGRhdGVQb3NpdGlvbigpOwogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogQ3JlYXRlcyB0b29sYmFyIGNvbXBvbmVudHMgYmFzZWQgb24gZ2l2ZW4gY29uZmlndXJhdGlvbi4KICAgICAqIFRoaXMgbmVlZHMgdG8gYmUgZG9uZSB3aGVuIGFsbCBwbHVnaW5zIGFyZSByZWFkeS4KICAgICAqCiAgICAgKiBAaW5oZXJpdERvYwogICAgICovCgogIH0sIHsKICAgIGtleTogImFmdGVySW5pdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWZ0ZXJJbml0KCkgewogICAgICB2YXIgZmFjdG9yeSA9IHRoaXMuZWRpdG9yLnVpLmNvbXBvbmVudEZhY3Rvcnk7CiAgICAgIHRoaXMudG9vbGJhclZpZXcuZmlsbEZyb21Db25maWcodGhpcy5fYmFsbG9vbkNvbmZpZywgZmFjdG9yeSk7CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZXMgdGhlIHRvb2xiYXIgdmlldyBpbnN0YW5jZS4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHJldHVybnMge21vZHVsZTp1aS90b29sYmFyL3Rvb2xiYXJ2aWV3flRvb2xiYXJWaWV3fQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9jcmVhdGVUb29sYmFyVmlldyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZVRvb2xiYXJWaWV3KCkgewogICAgICB2YXIgc2hvdWxkR3JvdXBXaGVuRnVsbCA9ICF0aGlzLl9iYWxsb29uQ29uZmlnLnNob3VsZE5vdEdyb3VwV2hlbkZ1bGw7CiAgICAgIHZhciB0b29sYmFyVmlldyA9IG5ldyBUb29sYmFyVmlldyh0aGlzLmVkaXRvci5sb2NhbGUsIHsKICAgICAgICBzaG91bGRHcm91cFdoZW5GdWxsOiBzaG91bGRHcm91cFdoZW5GdWxsLAogICAgICAgIGlzRmxvYXRpbmc6IHRydWUKICAgICAgfSk7CiAgICAgIHRvb2xiYXJWaWV3LnJlbmRlcigpOwogICAgICByZXR1cm4gdG9vbGJhclZpZXc7CiAgICB9CiAgICAvKioKICAgICAqIFNob3dzIHRoZSB0b29sYmFyIGFuZCBhdHRhY2hlcyBpdCB0byB0aGUgc2VsZWN0aW9uLgogICAgICoKICAgICAqIEZpcmVzIHtAbGluayAjZXZlbnQ6c2hvd30gZXZlbnQgd2hpY2ggY2FuIGJlIHN0b3BwZWQgdG8gcHJldmVudCB0aGUgdG9vbGJhciBmcm9tIHNob3dpbmcgdXAuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic2hvdyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdygpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgZWRpdG9yID0gdGhpcy5lZGl0b3I7CiAgICAgIHZhciBzZWxlY3Rpb24gPSBlZGl0b3IubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uOwogICAgICB2YXIgc2NoZW1hID0gZWRpdG9yLm1vZGVsLnNjaGVtYTsgLy8gRG8gbm90IGFkZCB0aGUgdG9vbGJhciB0byB0aGUgYmFsbG9vbiBzdGFjayB0d2ljZS4KCiAgICAgIGlmICh0aGlzLl9iYWxsb29uLmhhc1ZpZXcodGhpcy50b29sYmFyVmlldykpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gRG8gbm90IHNob3cgdGhlIHRvb2xiYXIgd2hlbiB0aGUgc2VsZWN0aW9uIGlzIGNvbGxhcHNlZC4KCgogICAgICBpZiAoc2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIERvIG5vdCBzaG93IHRoZSB0b29sYmFyIHdoZW4gdGhlcmUgaXMgbW9yZSB0aGFuIG9uZSByYW5nZSBpbiB0aGUgc2VsZWN0aW9uIGFuZCB0aGV5IGZ1bGx5IGNvbnRhaW4gc2VsZWN0YWJsZSBlbGVtZW50cy4KICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ja2VkaXRvci9ja2VkaXRvcjUvaXNzdWVzLzY0NDMuCgoKICAgICAgaWYgKHNlbGVjdGlvbkNvbnRhaW5zT25seU11bHRpcGxlU2VsZWN0YWJsZXMoc2VsZWN0aW9uLCBzY2hlbWEpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIERvbiBub3Qgc2hvdyB0aGUgdG9vbGJhciB3aGVuIGFsbCBjb21wb25lbnRzIGluc2lkZSBhcmUgZGlzYWJsZWQKICAgICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ja2VkaXRvci9ja2VkaXRvcjUtdWkvaXNzdWVzLzI2OS4KCgogICAgICBpZiAoQXJyYXkuZnJvbSh0aGlzLnRvb2xiYXJWaWV3Lml0ZW1zKS5ldmVyeShmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLmlzRW5hYmxlZCAhPT0gdW5kZWZpbmVkICYmICFpdGVtLmlzRW5hYmxlZDsKICAgICAgfSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gVXBkYXRlIHRoZSB0b29sYmFyIHBvc2l0aW9uIHdoZW4gdGhlIGVkaXRvciB1aSBzaG91bGQgYmUgcmVmcmVzaGVkLgoKCiAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5lZGl0b3IudWksICd1cGRhdGUnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMzLl91cGRhdGVQb3NpdGlvbigpOwogICAgICB9KTsgLy8gQWRkIHRoZSB0b29sYmFyIHRvIHRoZSBjb21tb24gZWRpdG9yIGNvbnRleHR1YWwgYmFsbG9vbi4KCiAgICAgIHRoaXMuX2JhbGxvb24uYWRkKHsKICAgICAgICB2aWV3OiB0aGlzLnRvb2xiYXJWaWV3LAogICAgICAgIHBvc2l0aW9uOiB0aGlzLl9nZXRCYWxsb29uUG9zaXRpb25EYXRhKCksCiAgICAgICAgYmFsbG9vbkNsYXNzTmFtZTogJ2NrLXRvb2xiYXItY29udGFpbmVyJwogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogSGlkZXMgdGhlIHRvb2xiYXIuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaGlkZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGlkZSgpIHsKICAgICAgaWYgKHRoaXMuX2JhbGxvb24uaGFzVmlldyh0aGlzLnRvb2xiYXJWaWV3KSkgewogICAgICAgIHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLmVkaXRvci51aSwgJ3VwZGF0ZScpOwoKICAgICAgICB0aGlzLl9iYWxsb29uLnJlbW92ZSh0aGlzLnRvb2xiYXJWaWV3KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHBvc2l0aW9uaW5nIG9wdGlvbnMgZm9yIHRoZSB7QGxpbmsgI19iYWxsb29ufS4gVGhleSBjb250cm9sIHRoZSB3YXkgYmFsbG9vbiBpcyBhdHRhY2hlZAogICAgICogdG8gdGhlIHNlbGVjdGlvbi4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHJldHVybnMge21vZHVsZTp1dGlscy9kb20vcG9zaXRpb25+T3B0aW9uc30KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfZ2V0QmFsbG9vblBvc2l0aW9uRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2dldEJhbGxvb25Qb3NpdGlvbkRhdGEoKSB7CiAgICAgIHZhciBlZGl0b3IgPSB0aGlzLmVkaXRvcjsKICAgICAgdmFyIHZpZXcgPSBlZGl0b3IuZWRpdGluZy52aWV3OwogICAgICB2YXIgdmlld0RvY3VtZW50ID0gdmlldy5kb2N1bWVudDsKICAgICAgdmFyIHZpZXdTZWxlY3Rpb24gPSB2aWV3RG9jdW1lbnQuc2VsZWN0aW9uOyAvLyBHZXQgZGlyZWN0aW9uIG9mIHRoZSBzZWxlY3Rpb24uCgogICAgICB2YXIgaXNCYWNrd2FyZCA9IHZpZXdEb2N1bWVudC5zZWxlY3Rpb24uaXNCYWNrd2FyZDsKICAgICAgcmV0dXJuIHsKICAgICAgICAvLyBCZWNhdXNlIHRoZSB0YXJnZXQgZm9yIEJhbGxvb25QYW5lbFZpZXcgaXMgYSBSZWN0IChub3QgRE9NUmFuZ2UpLCBpdCdzIGdlb21ldHJ5IHdpbGwgc3RheSBmaXhlZAogICAgICAgIC8vIGFzIHRoZSB3aW5kb3cgc2Nyb2xscy4gVG8gbGV0IHRoZSBCYWxsb29uUGFuZWxWaWV3IGZvbGxvdyBzdWNoIFJlY3QsIGlzIG11c3QgYmUgY29udGludW91c2x5CiAgICAgICAgLy8gY29tcHV0ZWQgYW5kIGhlbmNlLCB0aGUgdGFyZ2V0IGlzIGRlZmluZWQgYXMgYSBmdW5jdGlvbiBpbnN0ZWFkIG9mIGEgc3RhdGljIHZhbHVlLgogICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ja2VkaXRvci9ja2VkaXRvcjUtdWkvaXNzdWVzLzE5NQogICAgICAgIHRhcmdldDogZnVuY3Rpb24gdGFyZ2V0KCkgewogICAgICAgICAgdmFyIHJhbmdlID0gaXNCYWNrd2FyZCA/IHZpZXdTZWxlY3Rpb24uZ2V0Rmlyc3RSYW5nZSgpIDogdmlld1NlbGVjdGlvbi5nZXRMYXN0UmFuZ2UoKTsKICAgICAgICAgIHZhciByYW5nZVJlY3RzID0gUmVjdC5nZXREb21SYW5nZVJlY3RzKHZpZXcuZG9tQ29udmVydGVyLnZpZXdSYW5nZVRvRG9tKHJhbmdlKSk7IC8vIFNlbGVjdCB0aGUgcHJvcGVyIHJhbmdlIHJlY3QgZGVwZW5kaW5nIG9uIHRoZSBkaXJlY3Rpb24gb2YgdGhlIHNlbGVjdGlvbi4KCiAgICAgICAgICBpZiAoaXNCYWNrd2FyZCkgewogICAgICAgICAgICByZXR1cm4gcmFuZ2VSZWN0c1swXTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIERpdGNoIHRoZSB6ZXJvLXdpZHRoICJvcnBoYW4iIHJlY3QgaW4gdGhlIG5leHQgbGluZSBmb3IgdGhlIGZvcndhcmQgc2VsZWN0aW9uIGlmIHRoZXJlJ3MKICAgICAgICAgICAgLy8gYW5vdGhlciBvbmUgcHJlY2VkaW5nIGl0LiBJdCBpcyBub3QgcmVuZGVyZWQgYXMgYSBzZWxlY3Rpb24gYnkgdGhlIHdlYiBicm93c2VyIGFueXdheS4KICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2NrZWRpdG9yL2NrZWRpdG9yNS11aS9pc3N1ZXMvMzA4CiAgICAgICAgICAgIGlmIChyYW5nZVJlY3RzLmxlbmd0aCA+IDEgJiYgcmFuZ2VSZWN0c1tyYW5nZVJlY3RzLmxlbmd0aCAtIDFdLndpZHRoID09PSAwKSB7CiAgICAgICAgICAgICAgcmFuZ2VSZWN0cy5wb3AoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJhbmdlUmVjdHNbcmFuZ2VSZWN0cy5sZW5ndGggLSAxXTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHBvc2l0aW9uczogZ2V0QmFsbG9vblBvc2l0aW9ucyhpc0JhY2t3YXJkKQogICAgICB9OwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSBwb3NpdGlvbiBvZiB0aGUge0BsaW5rICNfYmFsbG9vbn0gdG8gbWFrZSB1cCBmb3IgY2hhbmdlczoKICAgICAqCiAgICAgKiAqIGluIHRoZSBnZW9tZXRyeSBvZiB0aGUgc2VsZWN0aW9uIGl0IGlzIGF0dGFjaGVkIHRvIChlLmcuIHRoZSBzZWxlY3Rpb24gbW92ZWQgaW4gdGhlIHZpZXdwb3J0IG9yIGV4cGFuZGVkIG9yIHNocnVuayksCiAgICAgKiAqIG9yIHRoZSBnZW9tZXRyeSBvZiB0aGUgYmFsbG9vbiB0b29sYmFyIGl0c2VsZiAoZS5nLiB0aGUgdG9vbGJhciBoYXMgZ3JvdXBlZCBvciB1bmdyb3VwZWQgc29tZSBpdGVtcyBhbmQgaXQgaXMgc2hvcnRlciBvciBsb25nZXIpLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3VwZGF0ZVBvc2l0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlUG9zaXRpb24oKSB7CiAgICAgIHRoaXMuX2JhbGxvb24udXBkYXRlUG9zaXRpb24odGhpcy5fZ2V0QmFsbG9vblBvc2l0aW9uRGF0YSgpKTsKICAgIH0KICAgIC8qKgogICAgICogQGluaGVyaXREb2MKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkZXN0cm95IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihCYWxsb29uVG9vbGJhci5wcm90b3R5cGUpLCAiZGVzdHJveSIsIHRoaXMpLmNhbGwodGhpcyk7CgogICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKTsKCiAgICAgIHRoaXMuX2ZpcmVTZWxlY3Rpb25DaGFuZ2VEZWJvdW5jZWQuY2FuY2VsKCk7CgogICAgICB0aGlzLnRvb2xiYXJWaWV3LmRlc3Ryb3koKTsKICAgICAgdGhpcy5mb2N1c1RyYWNrZXIuZGVzdHJveSgpOwoKICAgICAgaWYgKHRoaXMuX3Jlc2l6ZU9ic2VydmVyKSB7CiAgICAgICAgdGhpcy5fcmVzaXplT2JzZXJ2ZXIuZGVzdHJveSgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFRoaXMgZXZlbnQgaXMgZmlyZWQganVzdCBiZWZvcmUgdGhlIHRvb2xiYXIgc2hvd3MgdXAuIFN0b3BwaW5nIHRoaXMgZXZlbnQgd2lsbCBwcmV2ZW50IHRoaXMuCiAgICAgKgogICAgICogQGV2ZW50IHNob3cKICAgICAqLwoKICAgIC8qKgogICAgICogVGhpcyBpcyBpbnRlcm5hbCBwbHVnaW4gZXZlbnQgd2hpY2ggaXMgZmlyZWQgMjAwIG1zIGFmdGVyIG1vZGVsIHNlbGVjdGlvbiBsYXN0IGNoYW5nZS4KICAgICAqIFRoaXMgaXMgdG8gbWFrZXMgZWFzeSB0ZXN0IGRlYm91bmNlZCBhY3Rpb24gd2l0aG91dCBuZWVkIHRvIHVzZSBgc2V0VGltZW91dGAuCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQGV2ZW50IF9zZWxlY3Rpb25DaGFuZ2VEZWJvdW5jZWQKICAgICAqLwoKICB9XSwgW3sKICAgIGtleTogInBsdWdpbk5hbWUiLAogICAgZ2V0OgogICAgLyoqCiAgICAgKiBAaW5oZXJpdERvYwogICAgICovCiAgICBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiAnQmFsbG9vblRvb2xiYXInOwogICAgfQogICAgLyoqCiAgICAgKiBAaW5oZXJpdERvYwogICAgICovCgogIH0sIHsKICAgIGtleTogInJlcXVpcmVzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gW0NvbnRleHR1YWxCYWxsb29uXTsKICAgIH0KICB9XSk7CgogIHJldHVybiBCYWxsb29uVG9vbGJhcjsKfShQbHVnaW4pOyAvLyBSZXR1cm5zIHRvb2xiYXIgcG9zaXRpb25zIGZvciB0aGUgZ2l2ZW4gZGlyZWN0aW9uIG9mIHRoZSBzZWxlY3Rpb24uCi8vCi8vIEBwcml2YXRlCi8vIEBwYXJhbSB7Qm9vbGVhbn0gaXNCYWNrd2FyZAovLyBAcmV0dXJucyB7QXJyYXkuPG1vZHVsZTp1dGlscy9kb20vcG9zaXRpb25+UG9zaXRpb24+fQoKCmV4cG9ydCB7IEJhbGxvb25Ub29sYmFyIGFzIGRlZmF1bHQgfTsKCmZ1bmN0aW9uIGdldEJhbGxvb25Qb3NpdGlvbnMoaXNCYWNrd2FyZCkgewogIHZhciBkZWZhdWx0UG9zaXRpb25zID0gQmFsbG9vblBhbmVsVmlldy5kZWZhdWx0UG9zaXRpb25zOwogIHJldHVybiBpc0JhY2t3YXJkID8gW2RlZmF1bHRQb3NpdGlvbnMubm9ydGhXZXN0QXJyb3dTb3V0aCwgZGVmYXVsdFBvc2l0aW9ucy5ub3J0aFdlc3RBcnJvd1NvdXRoV2VzdCwgZGVmYXVsdFBvc2l0aW9ucy5ub3J0aFdlc3RBcnJvd1NvdXRoRWFzdCwgZGVmYXVsdFBvc2l0aW9ucy5ub3J0aFdlc3RBcnJvd1NvdXRoTWlkZGxlRWFzdCwgZGVmYXVsdFBvc2l0aW9ucy5ub3J0aFdlc3RBcnJvd1NvdXRoTWlkZGxlV2VzdCwgZGVmYXVsdFBvc2l0aW9ucy5zb3V0aFdlc3RBcnJvd05vcnRoLCBkZWZhdWx0UG9zaXRpb25zLnNvdXRoV2VzdEFycm93Tm9ydGhXZXN0LCBkZWZhdWx0UG9zaXRpb25zLnNvdXRoV2VzdEFycm93Tm9ydGhFYXN0LCBkZWZhdWx0UG9zaXRpb25zLnNvdXRoV2VzdEFycm93Tm9ydGhNaWRkbGVXZXN0LCBkZWZhdWx0UG9zaXRpb25zLnNvdXRoV2VzdEFycm93Tm9ydGhNaWRkbGVFYXN0XSA6IFtkZWZhdWx0UG9zaXRpb25zLnNvdXRoRWFzdEFycm93Tm9ydGgsIGRlZmF1bHRQb3NpdGlvbnMuc291dGhFYXN0QXJyb3dOb3J0aEVhc3QsIGRlZmF1bHRQb3NpdGlvbnMuc291dGhFYXN0QXJyb3dOb3J0aFdlc3QsIGRlZmF1bHRQb3NpdGlvbnMuc291dGhFYXN0QXJyb3dOb3J0aE1pZGRsZUVhc3QsIGRlZmF1bHRQb3NpdGlvbnMuc291dGhFYXN0QXJyb3dOb3J0aE1pZGRsZVdlc3QsIGRlZmF1bHRQb3NpdGlvbnMubm9ydGhFYXN0QXJyb3dTb3V0aCwgZGVmYXVsdFBvc2l0aW9ucy5ub3J0aEVhc3RBcnJvd1NvdXRoRWFzdCwgZGVmYXVsdFBvc2l0aW9ucy5ub3J0aEVhc3RBcnJvd1NvdXRoV2VzdCwgZGVmYXVsdFBvc2l0aW9ucy5ub3J0aEVhc3RBcnJvd1NvdXRoTWlkZGxlRWFzdCwgZGVmYXVsdFBvc2l0aW9ucy5ub3J0aEVhc3RBcnJvd1NvdXRoTWlkZGxlV2VzdF07Cn0gLy8gUmV0dXJucyAidHJ1ZSIgd2hlbiB0aGUgc2VsZWN0aW9uIGhhcyBtdWx0aXBsZSByYW5nZXMgYW5kIGVhY2ggcmFuZ2UgY29udGFpbnMgYSBzZWxlY3RhYmxlIGVsZW1lbnQKLy8gYW5kIG5vdGhpbmcgZWxzZS4KLy8KLy8gQHByaXZhdGUKLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL3NlbGVjdGlvbn5TZWxlY3Rpb259IHNlbGVjdGlvbgovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvbW9kZWwvc2NoZW1hflNjaGVtYX0gc2NoZW1hCi8vIEByZXR1cm5zIHtCb29sZWFufQoKCmZ1bmN0aW9uIHNlbGVjdGlvbkNvbnRhaW5zT25seU11bHRpcGxlU2VsZWN0YWJsZXMoc2VsZWN0aW9uLCBzY2hlbWEpIHsKICAvLyBJdCBkb2Vzbid0IGNvbnRhaW4gbXVsdGlwbGUgb2JqZWN0cyBpZiB0aGVyZSBpcyBvbmx5IG9uZSByYW5nZS4KICBpZiAoc2VsZWN0aW9uLnJhbmdlQ291bnQgPT09IDEpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHJldHVybiBfdG9Db25zdW1hYmxlQXJyYXkoc2VsZWN0aW9uLmdldFJhbmdlcygpKS5ldmVyeShmdW5jdGlvbiAocmFuZ2UpIHsKICAgIHZhciBlbGVtZW50ID0gcmFuZ2UuZ2V0Q29udGFpbmVkRWxlbWVudCgpOwogICAgcmV0dXJuIGVsZW1lbnQgJiYgc2NoZW1hLmlzU2VsZWN0YWJsZShlbGVtZW50KTsKICB9KTsKfQovKioKICogQ29udGV4dHVhbCB0b29sYmFyIGNvbmZpZ3VyYXRpb24uIFVzZWQgYnkgdGhlIHtAbGluayBtb2R1bGU6dWkvdG9vbGJhci9iYWxsb29uL2JhbGxvb250b29sYmFyfkJhbGxvb25Ub29sYmFyfQogKiBmZWF0dXJlLgogKgogKiAjIyBDb25maWd1cmluZyB0b29sYmFyIGl0ZW1zCiAqCiAqCQljb25zdCBjb25maWcgPSB7CiAqCQkJYmFsbG9vblRvb2xiYXI6IFsgJ2JvbGQnLCAnaXRhbGljJywgJ3VuZG8nLCAncmVkbycgXQogKgkJfTsKICoKICogWW91IGNhbiBhbHNvIHVzZSBgJ3wnYCB0byBjcmVhdGUgYSBzZXBhcmF0b3IgYmV0d2VlbiBncm91cHMgb2YgaXRlbXM6CiAqCiAqCQljb25zdCBjb25maWcgPSB7CiAqCQkJYmFsbG9vblRvb2xiYXI6IFsgJ2JvbGQnLCAnaXRhbGljJywgfCAndW5kbycsICdyZWRvJyBdCiAqCQl9OwogKgogKiBSZWFkIGFsc28gYWJvdXQgY29uZmlndXJpbmcgdGhlIG1haW4gZWRpdG9yIHRvb2xiYXIgaW4ge0BsaW5rIG1vZHVsZTpjb3JlL2VkaXRvci9lZGl0b3Jjb25maWd+RWRpdG9yQ29uZmlnI3Rvb2xiYXJ9LgogKgogKiAjIyBDb25maWd1cmluZyBpdGVtcyBncm91cGluZwogKgogKiBZb3UgY2FuIHByZXZlbnQgYXV0b21hdGljIGl0ZW1zIGdyb3VwaW5nIGJ5IHNldHRpbmcgdGhlIGBzaG91bGROb3RHcm91cFdoZW5GdWxsYCBvcHRpb246CiAqCiAqCQljb25zdCBjb25maWcgPSB7CiAqCQkJYmFsbG9vblRvb2xiYXI6IHsKICoJCQkJaXRlbXM6IFsgJ2JvbGQnLCAnaXRhbGljJywgJ3VuZG8nLCAncmVkbycgXSwKICoJCQkJc2hvdWxkTm90R3JvdXBXaGVuRnVsbDogdHJ1ZQogKgkJCX0sCiAqCQl9OwogKgogKiBAbWVtYmVyIHtBcnJheS48U3RyaW5nPnxPYmplY3R9IG1vZHVsZTpjb3JlL2VkaXRvci9lZGl0b3Jjb25maWd+RWRpdG9yQ29uZmlnI2JhbGxvb25Ub29sYmFyCiAqLw=="},{"version":3,"sources":["/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-ui/src/toolbar/balloon/balloontoolbar.js"],"names":["Plugin","ContextualBalloon","ToolbarView","BalloonPanelView","FocusTracker","Rect","normalizeToolbarConfig","debounce","ResizeObserver","toUnit","toPx","BalloonToolbar","editor","_balloonConfig","config","get","toolbarView","_createToolbarView","focusTracker","ui","once","add","getEditableElement","element","_resizeObserver","_balloon","plugins","_fireSelectionChangeDebounced","fire","decorate","selection","model","document","listenTo","evt","name","isFocused","isToolbarVisible","visibleView","hide","show","data","directChange","isCollapsed","editing","view","shouldNotGroupWhenFull","editableElement","editable","maxWidth","width","_updatePosition","factory","componentFactory","fillFromConfig","shouldGroupWhenFull","locale","isFloating","render","schema","hasView","selectionContainsOnlyMultipleSelectables","Array","from","items","every","item","isEnabled","undefined","position","_getBalloonPositionData","balloonClassName","stopListening","remove","viewDocument","viewSelection","isBackward","target","range","getFirstRange","getLastRange","rangeRects","getDomRangeRects","domConverter","viewRangeToDom","length","pop","positions","getBalloonPositions","updatePosition","cancel","destroy","defaultPositions","northWestArrowSouth","northWestArrowSouthWest","northWestArrowSouthEast","northWestArrowSouthMiddleEast","northWestArrowSouthMiddleWest","southWestArrowNorth","southWestArrowNorthWest","southWestArrowNorthEast","southWestArrowNorthMiddleWest","southWestArrowNorthMiddleEast","southEastArrowNorth","southEastArrowNorthEast","southEastArrowNorthWest","southEastArrowNorthMiddleEast","southEastArrowNorthMiddleWest","northEastArrowSouth","northEastArrowSouthEast","northEastArrowSouthWest","northEastArrowSouthMiddleEast","northEastArrowSouthMiddleWest","rangeCount","getRanges","getContainedElement","isSelectable"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module ui/toolbar/balloon/balloontoolbar\n */\n\nimport { Plugin } from 'ckeditor5/src/core';\nimport ContextualBalloon from '../../panel/balloon/contextualballoon';\nimport ToolbarView from '../toolbarview';\nimport BalloonPanelView from '../../panel/balloon/balloonpanelview.js';\nimport FocusTracker from '@ckeditor/ckeditor5-utils/src/focustracker';\nimport Rect from '@ckeditor/ckeditor5-utils/src/dom/rect';\nimport normalizeToolbarConfig from '../normalizetoolbarconfig';\nimport { debounce } from 'lodash-es';\nimport ResizeObserver from '@ckeditor/ckeditor5-utils/src/dom/resizeobserver';\nimport toUnit from '@ckeditor/ckeditor5-utils/src/dom/tounit';\n\nconst toPx = toUnit( 'px' );\n\n/**\n * The contextual toolbar.\n *\n * It uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon plugin}.\n *\n * @extends module:core/plugin~Plugin\n */\nexport default class BalloonToolbar extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic get pluginName() {\n\t\treturn 'BalloonToolbar';\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic get requires() {\n\t\treturn [ ContextualBalloon ];\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor ) {\n\t\tsuper( editor );\n\n\t\t/**\n\t\t * A cached and normalized `config.balloonToolbar` object.\n\t\t *\n\t\t * @type {module:core/editor/editorconfig~EditorConfig#balloonToolbar}\n\t\t * @private\n\t\t */\n\t\tthis._balloonConfig = normalizeToolbarConfig( editor.config.get( 'balloonToolbar' ) );\n\n\t\t/**\n\t\t * The toolbar view displayed in the balloon.\n\t\t *\n\t\t * @type {module:ui/toolbar/toolbarview~ToolbarView}\n\t\t */\n\t\tthis.toolbarView = this._createToolbarView();\n\n\t\t/**\n\t\t * Tracks the focus of the {@link module:core/editor/editorui~EditorUI#getEditableElement editable element}\n\t\t * and the {@link #toolbarView}. When both are blurred then the toolbar should hide.\n\t\t *\n\t\t * @readonly\n\t\t * @type {module:utils:focustracker~FocusTracker}\n\t\t */\n\t\tthis.focusTracker = new FocusTracker();\n\n\t\t// Wait for the EditorUI#init. EditableElement is not available before.\n\t\teditor.ui.once( 'ready', () => {\n\t\t\tthis.focusTracker.add( editor.ui.getEditableElement() );\n\t\t\tthis.focusTracker.add( this.toolbarView.element );\n\t\t} );\n\n\t\t/**\n\t\t * An instance of the resize observer that allows to respond to changes in editable's geometry\n\t\t * so the toolbar can stay within its boundaries (and group toolbar items that do not fit).\n\t\t *\n\t\t * **Note**: Used only when `shouldNotGroupWhenFull` was **not** set in the\n\t\t * {@link module:core/editor/editorconfig~EditorConfig#balloonToolbar configuration}.\n\t\t *\n\t\t * **Note:** Created in {@link #init}.\n\t\t *\n\t\t * @protected\n\t\t * @member {module:utils/dom/resizeobserver~ResizeObserver}\n\t\t */\n\t\tthis._resizeObserver = null;\n\n\t\t/**\n\t\t * The contextual balloon plugin instance.\n\t\t *\n\t\t * @private\n\t\t * @type {module:ui/panel/balloon/contextualballoon~ContextualBalloon}\n\t\t */\n\t\tthis._balloon = editor.plugins.get( ContextualBalloon );\n\n\t\t/**\n\t\t * Fires {@link #event:_selectionChangeDebounced} event using `lodash#debounce`.\n\t\t *\n\t\t * This function is stored as a plugin property to make possible to cancel\n\t\t * trailing debounced invocation on destroy.\n\t\t *\n\t\t * @private\n\t\t * @type {Function}\n\t\t */\n\t\tthis._fireSelectionChangeDebounced = debounce( () => this.fire( '_selectionChangeDebounced' ), 200 );\n\n\t\t// The appearance of the BalloonToolbar method is event–driven.\n\t\t// It is possible to stop the #show event and this prevent the toolbar from showing up.\n\t\tthis.decorate( 'show' );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tinit() {\n\t\tconst editor = this.editor;\n\t\tconst selection = editor.model.document.selection;\n\n\t\t// Show/hide the toolbar on editable focus/blur.\n\t\tthis.listenTo( this.focusTracker, 'change:isFocused', ( evt, name, isFocused ) => {\n\t\t\tconst isToolbarVisible = this._balloon.visibleView === this.toolbarView;\n\n\t\t\tif ( !isFocused && isToolbarVisible ) {\n\t\t\t\tthis.hide();\n\t\t\t} else if ( isFocused ) {\n\t\t\t\tthis.show();\n\t\t\t}\n\t\t} );\n\n\t\t// Hide the toolbar when the selection is changed by a direct change or has changed to collapsed.\n\t\tthis.listenTo( selection, 'change:range', ( evt, data ) => {\n\t\t\tif ( data.directChange || selection.isCollapsed ) {\n\t\t\t\tthis.hide();\n\t\t\t}\n\n\t\t\t// Fire internal `_selectionChangeDebounced` event to use it for showing\n\t\t\t// the toolbar after the selection stops changing.\n\t\t\tthis._fireSelectionChangeDebounced();\n\t\t} );\n\n\t\t// Show the toolbar when the selection stops changing.\n\t\tthis.listenTo( this, '_selectionChangeDebounced', () => {\n\t\t\tif ( this.editor.editing.view.document.isFocused ) {\n\t\t\t\tthis.show();\n\t\t\t}\n\t\t} );\n\n\t\tif ( !this._balloonConfig.shouldNotGroupWhenFull ) {\n\t\t\tthis.listenTo( editor, 'ready', () => {\n\t\t\t\tconst editableElement = editor.ui.view.editable.element;\n\n\t\t\t\t// Set #toolbarView's max-width on the initialization and update it on the editable resize.\n\t\t\t\tthis._resizeObserver = new ResizeObserver( editableElement, () => {\n\t\t\t\t\t// The max-width equals 90% of the editable's width for the best user experience.\n\t\t\t\t\t// The value keeps the balloon very close to the boundaries of the editable and limits the cases\n\t\t\t\t\t// when the balloon juts out from the editable element it belongs to.\n\t\t\t\t\tthis.toolbarView.maxWidth = toPx( new Rect( editableElement ).width * .9 );\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\n\t\t// Listen to the toolbar view and whenever it changes its geometry due to some items being\n\t\t// grouped or ungrouped, update the position of the balloon because a shorter/longer toolbar\n\t\t// means the balloon could be pointing at the wrong place. Once updated, the balloon will point\n\t\t// at the right selection in the content again.\n\t\t// https://github.com/ckeditor/ckeditor5/issues/6444\n\t\tthis.listenTo( this.toolbarView, 'groupedItemsUpdate', () => {\n\t\t\tthis._updatePosition();\n\t\t} );\n\t}\n\n\t/**\n\t * Creates toolbar components based on given configuration.\n\t * This needs to be done when all plugins are ready.\n\t *\n\t * @inheritDoc\n\t */\n\tafterInit() {\n\t\tconst factory = this.editor.ui.componentFactory;\n\n\t\tthis.toolbarView.fillFromConfig( this._balloonConfig, factory );\n\t}\n\n\t/**\n\t * Creates the toolbar view instance.\n\t *\n\t * @private\n\t * @returns {module:ui/toolbar/toolbarview~ToolbarView}\n\t */\n\t_createToolbarView() {\n\t\tconst shouldGroupWhenFull = !this._balloonConfig.shouldNotGroupWhenFull;\n\t\tconst toolbarView = new ToolbarView( this.editor.locale, {\n\t\t\tshouldGroupWhenFull,\n\t\t\tisFloating: true\n\t\t} );\n\n\t\ttoolbarView.render();\n\n\t\treturn toolbarView;\n\t}\n\n\t/**\n\t * Shows the toolbar and attaches it to the selection.\n\t *\n\t * Fires {@link #event:show} event which can be stopped to prevent the toolbar from showing up.\n\t */\n\tshow() {\n\t\tconst editor = this.editor;\n\t\tconst selection = editor.model.document.selection;\n\t\tconst schema = editor.model.schema;\n\n\t\t// Do not add the toolbar to the balloon stack twice.\n\t\tif ( this._balloon.hasView( this.toolbarView ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Do not show the toolbar when the selection is collapsed.\n\t\tif ( selection.isCollapsed ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Do not show the toolbar when there is more than one range in the selection and they fully contain selectable elements.\n\t\t// See https://github.com/ckeditor/ckeditor5/issues/6443.\n\t\tif ( selectionContainsOnlyMultipleSelectables( selection, schema ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Don not show the toolbar when all components inside are disabled\n\t\t// see https://github.com/ckeditor/ckeditor5-ui/issues/269.\n\t\tif ( Array.from( this.toolbarView.items ).every( item => item.isEnabled !== undefined && !item.isEnabled ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Update the toolbar position when the editor ui should be refreshed.\n\t\tthis.listenTo( this.editor.ui, 'update', () => {\n\t\t\tthis._updatePosition();\n\t\t} );\n\n\t\t// Add the toolbar to the common editor contextual balloon.\n\t\tthis._balloon.add( {\n\t\t\tview: this.toolbarView,\n\t\t\tposition: this._getBalloonPositionData(),\n\t\t\tballoonClassName: 'ck-toolbar-container'\n\t\t} );\n\t}\n\n\t/**\n\t * Hides the toolbar.\n\t */\n\thide() {\n\t\tif ( this._balloon.hasView( this.toolbarView ) ) {\n\t\t\tthis.stopListening( this.editor.ui, 'update' );\n\t\t\tthis._balloon.remove( this.toolbarView );\n\t\t}\n\t}\n\n\t/**\n\t * Returns positioning options for the {@link #_balloon}. They control the way balloon is attached\n\t * to the selection.\n\t *\n\t * @private\n\t * @returns {module:utils/dom/position~Options}\n\t */\n\t_getBalloonPositionData() {\n\t\tconst editor = this.editor;\n\t\tconst view = editor.editing.view;\n\t\tconst viewDocument = view.document;\n\t\tconst viewSelection = viewDocument.selection;\n\n\t\t// Get direction of the selection.\n\t\tconst isBackward = viewDocument.selection.isBackward;\n\n\t\treturn {\n\t\t\t// Because the target for BalloonPanelView is a Rect (not DOMRange), it's geometry will stay fixed\n\t\t\t// as the window scrolls. To let the BalloonPanelView follow such Rect, is must be continuously\n\t\t\t// computed and hence, the target is defined as a function instead of a static value.\n\t\t\t// https://github.com/ckeditor/ckeditor5-ui/issues/195\n\t\t\ttarget: () => {\n\t\t\t\tconst range = isBackward ? viewSelection.getFirstRange() : viewSelection.getLastRange();\n\t\t\t\tconst rangeRects = Rect.getDomRangeRects( view.domConverter.viewRangeToDom( range ) );\n\n\t\t\t\t// Select the proper range rect depending on the direction of the selection.\n\t\t\t\tif ( isBackward ) {\n\t\t\t\t\treturn rangeRects[ 0 ];\n\t\t\t\t} else {\n\t\t\t\t\t// Ditch the zero-width \"orphan\" rect in the next line for the forward selection if there's\n\t\t\t\t\t// another one preceding it. It is not rendered as a selection by the web browser anyway.\n\t\t\t\t\t// https://github.com/ckeditor/ckeditor5-ui/issues/308\n\t\t\t\t\tif ( rangeRects.length > 1 && rangeRects[ rangeRects.length - 1 ].width === 0 ) {\n\t\t\t\t\t\trangeRects.pop();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn rangeRects[ rangeRects.length - 1 ];\n\t\t\t\t}\n\t\t\t},\n\t\t\tpositions: getBalloonPositions( isBackward )\n\t\t};\n\t}\n\n\t/**\n\t * Updates the position of the {@link #_balloon} to make up for changes:\n\t *\n\t * * in the geometry of the selection it is attached to (e.g. the selection moved in the viewport or expanded or shrunk),\n\t * * or the geometry of the balloon toolbar itself (e.g. the toolbar has grouped or ungrouped some items and it is shorter or longer).\n\t *\n\t * @private\n\t */\n\t_updatePosition() {\n\t\tthis._balloon.updatePosition( this._getBalloonPositionData() );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdestroy() {\n\t\tsuper.destroy();\n\n\t\tthis.stopListening();\n\t\tthis._fireSelectionChangeDebounced.cancel();\n\t\tthis.toolbarView.destroy();\n\t\tthis.focusTracker.destroy();\n\n\t\tif ( this._resizeObserver ) {\n\t\t\tthis._resizeObserver.destroy();\n\t\t}\n\t}\n\n\t/**\n\t * This event is fired just before the toolbar shows up. Stopping this event will prevent this.\n\t *\n\t * @event show\n\t */\n\n\t/**\n\t * This is internal plugin event which is fired 200 ms after model selection last change.\n\t * This is to makes easy test debounced action without need to use `setTimeout`.\n\t *\n\t * @protected\n\t * @event _selectionChangeDebounced\n\t */\n}\n\n// Returns toolbar positions for the given direction of the selection.\n//\n// @private\n// @param {Boolean} isBackward\n// @returns {Array.<module:utils/dom/position~Position>}\nfunction getBalloonPositions( isBackward ) {\n\tconst defaultPositions = BalloonPanelView.defaultPositions;\n\n\treturn isBackward ? [\n\t\tdefaultPositions.northWestArrowSouth,\n\t\tdefaultPositions.northWestArrowSouthWest,\n\t\tdefaultPositions.northWestArrowSouthEast,\n\t\tdefaultPositions.northWestArrowSouthMiddleEast,\n\t\tdefaultPositions.northWestArrowSouthMiddleWest,\n\t\tdefaultPositions.southWestArrowNorth,\n\t\tdefaultPositions.southWestArrowNorthWest,\n\t\tdefaultPositions.southWestArrowNorthEast,\n\t\tdefaultPositions.southWestArrowNorthMiddleWest,\n\t\tdefaultPositions.southWestArrowNorthMiddleEast\n\t] : [\n\t\tdefaultPositions.southEastArrowNorth,\n\t\tdefaultPositions.southEastArrowNorthEast,\n\t\tdefaultPositions.southEastArrowNorthWest,\n\t\tdefaultPositions.southEastArrowNorthMiddleEast,\n\t\tdefaultPositions.southEastArrowNorthMiddleWest,\n\t\tdefaultPositions.northEastArrowSouth,\n\t\tdefaultPositions.northEastArrowSouthEast,\n\t\tdefaultPositions.northEastArrowSouthWest,\n\t\tdefaultPositions.northEastArrowSouthMiddleEast,\n\t\tdefaultPositions.northEastArrowSouthMiddleWest\n\t];\n}\n\n// Returns \"true\" when the selection has multiple ranges and each range contains a selectable element\n// and nothing else.\n//\n// @private\n// @param {module:engine/model/selection~Selection} selection\n// @param {module:engine/model/schema~Schema} schema\n// @returns {Boolean}\nfunction selectionContainsOnlyMultipleSelectables( selection, schema ) {\n\t// It doesn't contain multiple objects if there is only one range.\n\tif ( selection.rangeCount === 1 ) {\n\t\treturn false;\n\t}\n\n\treturn [ ...selection.getRanges() ].every( range => {\n\t\tconst element = range.getContainedElement();\n\n\t\treturn element && schema.isSelectable( element );\n\t} );\n}\n\n/**\n * Contextual toolbar configuration. Used by the {@link module:ui/toolbar/balloon/balloontoolbar~BalloonToolbar}\n * feature.\n *\n * ## Configuring toolbar items\n *\n *\t\tconst config = {\n *\t\t\tballoonToolbar: [ 'bold', 'italic', 'undo', 'redo' ]\n *\t\t};\n *\n * You can also use `'|'` to create a separator between groups of items:\n *\n *\t\tconst config = {\n *\t\t\tballoonToolbar: [ 'bold', 'italic', | 'undo', 'redo' ]\n *\t\t};\n *\n * Read also about configuring the main editor toolbar in {@link module:core/editor/editorconfig~EditorConfig#toolbar}.\n *\n * ## Configuring items grouping\n *\n * You can prevent automatic items grouping by setting the `shouldNotGroupWhenFull` option:\n *\n *\t\tconst config = {\n *\t\t\tballoonToolbar: {\n *\t\t\t\titems: [ 'bold', 'italic', 'undo', 'redo' ],\n *\t\t\t\tshouldNotGroupWhenFull: true\n *\t\t\t},\n *\t\t};\n *\n * @member {Array.<String>|Object} module:core/editor/editorconfig~EditorConfig#balloonToolbar\n */\n"]}]}