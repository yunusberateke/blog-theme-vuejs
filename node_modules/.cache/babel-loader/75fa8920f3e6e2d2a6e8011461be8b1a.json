{"remainingRequest":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js?{}!/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-engine/src/view/selection.js","dependencies":[{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-engine/src/view/selection.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-dev-webpack-plugin/lib/translatesourceloader.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9ob21lL2VrZWJlcmF0L1lhbmRleC5EaXNrL1Byb2plbGVyaW0vQmVuaW1Qcm9qZWxlcmltL3dlYnNpdGVtL3dlYnNpdGVtLXdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL2hvbWUvZWtlYmVyYXQvWWFuZGV4LkRpc2svUHJvamVsZXJpbS9CZW5pbVByb2plbGVyaW0vd2Vic2l0ZW0vd2Vic2l0ZW0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmFuY2hvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZyb20uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwoKLyoqCiAqIEBsaWNlbnNlIENvcHlyaWdodCAoYykgMjAwMy0yMDIxLCBDS1NvdXJjZSAtIEZyZWRlcmljbyBLbmFiYmVuLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiBGb3IgbGljZW5zaW5nLCBzZWUgTElDRU5TRS5tZCBvciBodHRwczovL2NrZWRpdG9yLmNvbS9sZWdhbC9ja2VkaXRvci1vc3MtbGljZW5zZQogKi8KCi8qKgogKiBAbW9kdWxlIGVuZ2luZS92aWV3L3NlbGVjdGlvbgogKi8KaW1wb3J0IENLRWRpdG9yRXJyb3IgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvY2tlZGl0b3JlcnJvcic7CmltcG9ydCBSYW5nZSBmcm9tICcuL3JhbmdlJzsKaW1wb3J0IFBvc2l0aW9uIGZyb20gJy4vcG9zaXRpb24nOwppbXBvcnQgbWl4IGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtdXRpbHMvc3JjL21peCc7CmltcG9ydCBFbWl0dGVyTWl4aW4gZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvZW1pdHRlcm1peGluJzsKaW1wb3J0IE5vZGUgZnJvbSAnLi9ub2RlJzsKaW1wb3J0IGNvdW50IGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtdXRpbHMvc3JjL2NvdW50JzsKaW1wb3J0IGlzSXRlcmFibGUgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvaXNpdGVyYWJsZSc7CmltcG9ydCBEb2N1bWVudFNlbGVjdGlvbiBmcm9tICcuL2RvY3VtZW50c2VsZWN0aW9uJzsKLyoqCiAqIENsYXNzIHJlcHJlc2VudGluZyBhbiBhcmJpcnRhcnkgc2VsZWN0aW9uIGluIHRoZSB2aWV3LgogKiBTZWUgYWxzbyB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2RvY3VtZW50c2VsZWN0aW9ufkRvY3VtZW50U2VsZWN0aW9ufS4KICoKICogTmV3IHNlbGVjdGlvbiBpbnN0YW5jZXMgY2FuIGJlIGNyZWF0ZWQgdmlhIHRoZSBjb25zdHJ1Y3RvciBvciBvbmUgdGhlc2UgbWV0aG9kczoKICoKICogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3ZpZXd+VmlldyNjcmVhdGVTZWxlY3Rpb24gYFZpZXcjY3JlYXRlU2VsZWN0aW9uKClgfSwKICogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3VwY2FzdHdyaXRlcn5VcGNhc3RXcml0ZXIjY3JlYXRlU2VsZWN0aW9uIGBVcGNhc3RXcml0ZXIjY3JlYXRlU2VsZWN0aW9uKClgfS4KICoKICogQSBzZWxlY3Rpb24gY2FuIGNvbnNpc3Qgb2Yge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9yYW5nZX5SYW5nZSByYW5nZXN9IHRoYXQgY2FuIGJlIHNldCBieSB1c2luZwogKiB0aGUge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9zZWxlY3Rpb25+U2VsZWN0aW9uI3NldFRvIGBTZWxlY3Rpb24jc2V0VG8oKWB9IG1ldGhvZC4KICovCgp2YXIgU2VsZWN0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAvKioKICAgKiBDcmVhdGVzIG5ldyBzZWxlY3Rpb24gaW5zdGFuY2UuCiAgICoKICAgKiAqKk5vdGUqKjogVGhlIHNlbGVjdGlvbiBjb25zdHJ1Y3RvciBpcyBhdmFpbGFibGUgYXMgYSBmYWN0b3J5IG1ldGhvZDoKICAgKgogICAqICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy92aWV3flZpZXcjY3JlYXRlU2VsZWN0aW9uIGBWaWV3I2NyZWF0ZVNlbGVjdGlvbigpYH0sCiAgICogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3VwY2FzdHdyaXRlcn5VcGNhc3RXcml0ZXIjY3JlYXRlU2VsZWN0aW9uIGBVcGNhc3RXcml0ZXIjY3JlYXRlU2VsZWN0aW9uKClgfS4KICAgKgogICAqIAkJLy8gQ3JlYXRlcyBlbXB0eSBzZWxlY3Rpb24gd2l0aG91dCByYW5nZXMuCiAgICoJCWNvbnN0IHNlbGVjdGlvbiA9IHdyaXRlci5jcmVhdGVTZWxlY3Rpb24oKTsKICAgKgogICAqCQkvLyBDcmVhdGVzIHNlbGVjdGlvbiBhdCB0aGUgZ2l2ZW4gcmFuZ2UuCiAgICoJCWNvbnN0IHJhbmdlID0gd3JpdGVyLmNyZWF0ZVJhbmdlKCBzdGFydCwgZW5kICk7CiAgICoJCWNvbnN0IHNlbGVjdGlvbiA9IHdyaXRlci5jcmVhdGVTZWxlY3Rpb24oIHJhbmdlICk7CiAgICoKICAgKgkJLy8gQ3JlYXRlcyBzZWxlY3Rpb24gYXQgdGhlIGdpdmVuIHJhbmdlcwogICAqIAkJY29uc3QgcmFuZ2VzID0gWyB3cml0ZXIuY3JlYXRlUmFuZ2UoIHN0YXJ0MSwgZW5kMiApLCB3cml0ZXIuY3JlYXRlUmFuZ2UoIHN0YXIyLCBlbmQyICkgXTsKICAgKgkJY29uc3Qgc2VsZWN0aW9uID0gd3JpdGVyLmNyZWF0ZVNlbGVjdGlvbiggcmFuZ2VzICk7CiAgICoKICAgKgkJLy8gQ3JlYXRlcyBzZWxlY3Rpb24gZnJvbSB0aGUgb3RoZXIgc2VsZWN0aW9uLgogICAqCQljb25zdCBvdGhlclNlbGVjdGlvbiA9IHdyaXRlci5jcmVhdGVTZWxlY3Rpb24oKTsKICAgKgkJY29uc3Qgc2VsZWN0aW9uID0gd3JpdGVyLmNyZWF0ZVNlbGVjdGlvbiggb3RoZXJTZWxlY3Rpb24gKTsKICAgKgogICAqCQkvLyBDcmVhdGVzIHNlbGVjdGlvbiBmcm9tIHRoZSBkb2N1bWVudCBzZWxlY3Rpb24uCiAgICoJCWNvbnN0IHNlbGVjdGlvbiA9IHdyaXRlci5jcmVhdGVTZWxlY3Rpb24oIGVkaXRvci5lZGl0aW5nLnZpZXcuZG9jdW1lbnQuc2VsZWN0aW9uICk7CiAgICoKICAgKiAJCS8vIENyZWF0ZXMgc2VsZWN0aW9uIGF0IHRoZSBnaXZlbiBwb3NpdGlvbi4KICAgKgkJY29uc3QgcG9zaXRpb24gPSB3cml0ZXIuY3JlYXRlUG9zaXRpb25Gcm9tUGF0aCggcm9vdCwgcGF0aCApOwogICAqCQljb25zdCBzZWxlY3Rpb24gPSB3cml0ZXIuY3JlYXRlU2VsZWN0aW9uKCBwb3NpdGlvbiApOwogICAqCiAgICoJCS8vIENyZWF0ZXMgY29sbGFwc2VkIHNlbGVjdGlvbiBhdCB0aGUgcG9zaXRpb24gb2YgZ2l2ZW4gaXRlbSBhbmQgb2Zmc2V0LgogICAqCQljb25zdCBwYXJhZ3JhcGggPSB3cml0ZXIuY3JlYXRlQ29udGFpbmVyRWxlbWVudCggJ3BhcmFncmFwaCcgKTsKICAgKgkJY29uc3Qgc2VsZWN0aW9uID0gd3JpdGVyLmNyZWF0ZVNlbGVjdGlvbiggcGFyYWdyYXBoLCBvZmZzZXQgKTsKICAgKgogICAqCQkvLyBDcmVhdGVzIGEgcmFuZ2UgaW5zaWRlIGFuIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50IGVsZW1lbnR9IHdoaWNoIHN0YXJ0cyBiZWZvcmUgdGhlCiAgICoJCS8vIGZpcnN0IGNoaWxkIG9mIHRoYXQgZWxlbWVudCBhbmQgZW5kcyBhZnRlciB0aGUgbGFzdCBjaGlsZCBvZiB0aGF0IGVsZW1lbnQuCiAgICoJCWNvbnN0IHNlbGVjdGlvbiA9IHdyaXRlci5jcmVhdGVTZWxlY3Rpb24oIHBhcmFncmFwaCwgJ2luJyApOwogICAqCiAgICoJCS8vIENyZWF0ZXMgYSByYW5nZSBvbiBhbiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2l0ZW1+SXRlbSBpdGVtfSB3aGljaCBzdGFydHMgYmVmb3JlIHRoZSBpdGVtIGFuZCBlbmRzCiAgICoJCS8vIGp1c3QgYWZ0ZXIgdGhlIGl0ZW0uCiAgICoJCWNvbnN0IHNlbGVjdGlvbiA9IHdyaXRlci5jcmVhdGVTZWxlY3Rpb24oIHBhcmFncmFwaCwgJ29uJyApOwogICAqCiAgICogYFNlbGVjdGlvbmAncyBjb25zdHJ1Y3RvciBhbGxvdyBwYXNzaW5nIGFkZGl0aW9uYWwgb3B0aW9ucyAoYGJhY2t3YXJkYCwgYGZha2VgIGFuZCBgbGFiZWxgKSBhcyB0aGUgbGFzdCBhcmd1bWVudC4KICAgKgogICAqCQkvLyBDcmVhdGVzIGJhY2t3YXJkIHNlbGVjdGlvbi4KICAgKgkJY29uc3Qgc2VsZWN0aW9uID0gd3JpdGVyLmNyZWF0ZVNlbGVjdGlvbiggcmFuZ2UsIHsgYmFja3dhcmQ6IHRydWUgfSApOwogICAqCiAgICogRmFrZSBzZWxlY3Rpb24gZG9lcyBub3QgcmVuZGVyIGFzIGJyb3dzZXIgbmF0aXZlIHNlbGVjdGlvbiBvdmVyIHNlbGVjdGVkIGVsZW1lbnRzIGFuZCBpcyBoaWRkZW4gdG8gdGhlIHVzZXIuCiAgICogVGhpcyB3YXksIG5vIG5hdGl2ZSBzZWxlY3Rpb24gVUkgYXJ0aWZhY3RzIGFyZSBkaXNwbGF5ZWQgdG8gdGhlIHVzZXIgYW5kIHNlbGVjdGlvbiBvdmVyIGVsZW1lbnRzIGNhbiBiZQogICAqIHJlcHJlc2VudGVkIGluIG90aGVyIHdheSwgZm9yIGV4YW1wbGUgYnkgYXBwbHlpbmcgcHJvcGVyIENTUyBjbGFzcy4KICAgKgogICAqIEFkZGl0aW9uYWxseSBmYWtlJ3Mgc2VsZWN0aW9uIGxhYmVsIGNhbiBiZSBwcm92aWRlZC4gSXQgd2lsbCBiZSB1c2VkIHRvIGRlc2NyaWJlIGZha2Ugc2VsZWN0aW9uIGluIERPTQogICAqIChhbmQgYmUgIHByb3Blcmx5IGhhbmRsZWQgYnkgc2NyZWVuIHJlYWRlcnMpLgogICAqCiAgICoJCS8vIENyZWF0ZXMgZmFrZSBzZWxlY3Rpb24gd2l0aCBsYWJlbC4KICAgKgkJY29uc3Qgc2VsZWN0aW9uID0gd3JpdGVyLmNyZWF0ZVNlbGVjdGlvbiggcmFuZ2UsIHsgZmFrZTogdHJ1ZSwgbGFiZWw6ICdmb28nIH0gKTsKICAgKgogICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L3NlbGVjdGlvbn5TZWxlY3RhYmxlfSBbc2VsZWN0YWJsZT1udWxsXQogICAqIEBwYXJhbSB7TnVtYmVyfCdiZWZvcmUnfCdlbmQnfCdhZnRlcid8J29uJ3wnaW4nfSBbcGxhY2VPck9mZnNldF0gT2Zmc2V0IG9yIHBsYWNlIHdoZW4gc2VsZWN0YWJsZSBpcyBhbiBgSXRlbWAuCiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXQogICAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuYmFja3dhcmRdIFNldHMgdGhpcyBzZWxlY3Rpb24gaW5zdGFuY2UgdG8gYmUgYmFja3dhcmQuCiAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5mYWtlXSBTZXRzIHRoaXMgc2VsZWN0aW9uIGluc3RhbmNlIHRvIGJlIG1hcmtlZCBhcyBgZmFrZWAuCiAgICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLmxhYmVsXSBMYWJlbCBmb3IgdGhlIGZha2Ugc2VsZWN0aW9uLgogICAqLwogIGZ1bmN0aW9uIFNlbGVjdGlvbigpIHsKICAgIHZhciBzZWxlY3RhYmxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwogICAgdmFyIHBsYWNlT3JPZmZzZXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDsKICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNlbGVjdGlvbik7CgogICAgLyoqCiAgICAgKiBTdG9yZXMgYWxsIHJhbmdlcyB0aGF0IGFyZSBzZWxlY3RlZC4KICAgICAqCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAbWVtYmVyIHtBcnJheS48bW9kdWxlOmVuZ2luZS92aWV3L3JhbmdlflJhbmdlPn0KICAgICAqLwogICAgdGhpcy5fcmFuZ2VzID0gW107CiAgICAvKioKICAgICAqIFNwZWNpZmllcyB3aGV0aGVyIHRoZSBsYXN0IGFkZGVkIHJhbmdlIHdhcyBhZGRlZCBhcyBhIGJhY2t3YXJkIG9yIGZvcndhcmQgcmFuZ2UuCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQG1lbWJlciB7Qm9vbGVhbn0KICAgICAqLwoKICAgIHRoaXMuX2xhc3RSYW5nZUJhY2t3YXJkID0gZmFsc2U7CiAgICAvKioKICAgICAqIFNwZWNpZmllcyB3aGV0aGVyIHNlbGVjdGlvbiBpbnN0YW5jZSBpcyBmYWtlLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAbWVtYmVyIHtCb29sZWFufQogICAgICovCgogICAgdGhpcy5faXNGYWtlID0gZmFsc2U7CiAgICAvKioKICAgICAqIEZha2Ugc2VsZWN0aW9uJ3MgbGFiZWwuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEBtZW1iZXIge1N0cmluZ30KICAgICAqLwoKICAgIHRoaXMuX2Zha2VTZWxlY3Rpb25MYWJlbCA9ICcnOwogICAgdGhpcy5zZXRUbyhzZWxlY3RhYmxlLCBwbGFjZU9yT2Zmc2V0LCBvcHRpb25zKTsKICB9CiAgLyoqCiAgICogUmV0dXJucyB0cnVlIGlmIHNlbGVjdGlvbiBpbnN0YW5jZSBpcyBtYXJrZWQgYXMgYGZha2VgLgogICAqCiAgICogQHNlZSAjc2V0VG8KICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhTZWxlY3Rpb24sIFt7CiAgICBrZXk6ICJpc0Zha2UiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9pc0Zha2U7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgZmFrZSBzZWxlY3Rpb24gbGFiZWwuCiAgICAgKgogICAgICogQHNlZSAjc2V0VG8KICAgICAqIEByZXR1cm5zIHtTdHJpbmd9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZmFrZVNlbGVjdGlvbkxhYmVsIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fZmFrZVNlbGVjdGlvbkxhYmVsOwogICAgfQogICAgLyoqCiAgICAgKiBTZWxlY3Rpb24gYW5jaG9yLiBBbmNob3IgbWF5IGJlIGRlc2NyaWJlZCBhcyBhIHBvc2l0aW9uIHdoZXJlIHRoZSBzZWxlY3Rpb24gc3RhcnRzLiBUb2dldGhlciB3aXRoCiAgICAgKiB7QGxpbmsgI2ZvY3VzIGZvY3VzfSB0aGV5IGRlZmluZSB0aGUgZGlyZWN0aW9uIG9mIHNlbGVjdGlvbiwgd2hpY2ggaXMgaW1wb3J0YW50CiAgICAgKiB3aGVuIGV4cGFuZGluZy9zaHJpbmtpbmcgc2VsZWN0aW9uLiBBbmNob3IgaXMgYWx3YXlzIHRoZSBzdGFydCBvciBlbmQgb2YgdGhlIG1vc3QgcmVjZW50IGFkZGVkIHJhbmdlLgogICAgICogSXQgbWF5IGJlIGEgYml0IHVuaW50dWl0aXZlIHdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIHJhbmdlcyBpbiBzZWxlY3Rpb24uCiAgICAgKgogICAgICogQHNlZSAjZm9jdXMKICAgICAqIEB0eXBlIHttb2R1bGU6ZW5naW5lL3ZpZXcvcG9zaXRpb25+UG9zaXRpb259CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiYW5jaG9yIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICBpZiAoIXRoaXMuX3Jhbmdlcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFyIHJhbmdlID0gdGhpcy5fcmFuZ2VzW3RoaXMuX3Jhbmdlcy5sZW5ndGggLSAxXTsKICAgICAgdmFyIGFuY2hvciA9IHRoaXMuX2xhc3RSYW5nZUJhY2t3YXJkID8gcmFuZ2UuZW5kIDogcmFuZ2Uuc3RhcnQ7CiAgICAgIHJldHVybiBhbmNob3IuY2xvbmUoKTsKICAgIH0KICAgIC8qKgogICAgICogU2VsZWN0aW9uIGZvY3VzLiBGb2N1cyBpcyBhIHBvc2l0aW9uIHdoZXJlIHRoZSBzZWxlY3Rpb24gZW5kcy4KICAgICAqCiAgICAgKiBAc2VlICNhbmNob3IKICAgICAqIEB0eXBlIHttb2R1bGU6ZW5naW5lL3ZpZXcvcG9zaXRpb25+UG9zaXRpb259CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZm9jdXMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIGlmICghdGhpcy5fcmFuZ2VzLmxlbmd0aCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgcmFuZ2UgPSB0aGlzLl9yYW5nZXNbdGhpcy5fcmFuZ2VzLmxlbmd0aCAtIDFdOwogICAgICB2YXIgZm9jdXMgPSB0aGlzLl9sYXN0UmFuZ2VCYWNrd2FyZCA/IHJhbmdlLnN0YXJ0IDogcmFuZ2UuZW5kOwogICAgICByZXR1cm4gZm9jdXMuY2xvbmUoKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBzZWxlY3Rpb24gaXMgY29sbGFwc2VkLiBTZWxlY3Rpb24gaXMgY29sbGFwc2VkIHdoZW4gdGhlcmUgaXMgZXhhY3RseSBvbmUgcmFuZ2Ugd2hpY2ggaXMKICAgICAqIGNvbGxhcHNlZC4KICAgICAqCiAgICAgKiBAdHlwZSB7Qm9vbGVhbn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpc0NvbGxhcHNlZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMucmFuZ2VDb3VudCA9PT0gMSAmJiB0aGlzLl9yYW5nZXNbMF0uaXNDb2xsYXBzZWQ7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgbnVtYmVyIG9mIHJhbmdlcyBpbiBzZWxlY3Rpb24uCiAgICAgKgogICAgICogQHR5cGUge051bWJlcn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyYW5nZUNvdW50IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fcmFuZ2VzLmxlbmd0aDsKICAgIH0KICAgIC8qKgogICAgICogU3BlY2lmaWVzIHdoZXRoZXIgdGhlIHtAbGluayAjZm9jdXN9IHByZWNlZGVzIHtAbGluayAjYW5jaG9yfS4KICAgICAqCiAgICAgKiBAdHlwZSB7Qm9vbGVhbn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpc0JhY2t3YXJkIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gIXRoaXMuaXNDb2xsYXBzZWQgJiYgdGhpcy5fbGFzdFJhbmdlQmFja3dhcmQ7CiAgICB9CiAgICAvKioKICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZWRpdGFibGVlbGVtZW50fkVkaXRhYmxlRWxlbWVudCBFZGl0YWJsZUVsZW1lbnR9IGluc3RhbmNlIHRoYXQgY29udGFpbnMgdGhpcyBzZWxlY3Rpb24sIG9yIGBudWxsYAogICAgICogaWYgdGhlIHNlbGVjdGlvbiBpcyBub3QgaW5zaWRlIGFuIGVkaXRhYmxlIGVsZW1lbnQuCiAgICAgKgogICAgICogQHR5cGUge21vZHVsZTplbmdpbmUvdmlldy9lZGl0YWJsZWVsZW1lbnR+RWRpdGFibGVFbGVtZW50fG51bGx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZWRpdGFibGVFbGVtZW50IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICBpZiAodGhpcy5hbmNob3IpIHsKICAgICAgICByZXR1cm4gdGhpcy5hbmNob3IuZWRpdGFibGVFbGVtZW50OwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbiBpdGVyYWJsZSB0aGF0IGNvbnRhaW5zIGNvcGllcyBvZiBhbGwgcmFuZ2VzIGFkZGVkIHRvIHRoZSBzZWxlY3Rpb24uCiAgICAgKgogICAgICogQHJldHVybnMge0l0ZXJhYmxlLjxtb2R1bGU6ZW5naW5lL3ZpZXcvcmFuZ2V+UmFuZ2U+fQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldFJhbmdlcyIsCiAgICB2YWx1ZToKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIGdldFJhbmdlcygpIHsKICAgICAgdmFyIF9pdGVyYXRvciwgX3N0ZXAsIHJhbmdlOwoKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIGdldFJhbmdlcyQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5fcmFuZ2VzKTsKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTsKCiAgICAgICAgICAgICAgX2l0ZXJhdG9yLnMoKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBpZiAoKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJhbmdlID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIHJhbmdlLmNsb25lKCk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTE7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxKTsKCiAgICAgICAgICAgICAgX2l0ZXJhdG9yLmUoX2NvbnRleHQudDApOwoKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTQ7CgogICAgICAgICAgICAgIF9pdGVyYXRvci5mKCk7CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goMTQpOwoKICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgZ2V0UmFuZ2VzLCB0aGlzLCBbWzEsIDExLCAxNCwgMTddXSk7CiAgICB9KQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGNvcHkgb2YgdGhlIGZpcnN0IHJhbmdlIGluIHRoZSBzZWxlY3Rpb24uIEZpcnN0IHJhbmdlIGlzIHRoZSBvbmUgd2hpY2gKICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvcmFuZ2V+UmFuZ2Ujc3RhcnQgc3RhcnR9IHBvc2l0aW9uIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvcG9zaXRpb25+UG9zaXRpb24jaXNCZWZvcmUgaXMgYmVmb3JlfSBzdGFydAogICAgICogcG9zaXRpb24gb2YgYWxsIG90aGVyIHJhbmdlcyAobm90IHRvIGNvbmZ1c2Ugd2l0aCB0aGUgZmlyc3QgcmFuZ2UgYWRkZWQgdG8gdGhlIHNlbGVjdGlvbikuCiAgICAgKiBSZXR1cm5zIGBudWxsYCBpZiBubyByYW5nZXMgYXJlIGFkZGVkIHRvIHNlbGVjdGlvbi4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7bW9kdWxlOmVuZ2luZS92aWV3L3JhbmdlflJhbmdlfG51bGx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Rmlyc3RSYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Rmlyc3RSYW5nZSgpIHsKICAgICAgdmFyIGZpcnN0ID0gbnVsbDsKCiAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5fcmFuZ2VzKSwKICAgICAgICAgIF9zdGVwMjsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciByYW5nZSA9IF9zdGVwMi52YWx1ZTsKCiAgICAgICAgICBpZiAoIWZpcnN0IHx8IHJhbmdlLnN0YXJ0LmlzQmVmb3JlKGZpcnN0LnN0YXJ0KSkgewogICAgICAgICAgICBmaXJzdCA9IHJhbmdlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yMi5mKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmaXJzdCA/IGZpcnN0LmNsb25lKCkgOiBudWxsOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGNvcHkgb2YgdGhlIGxhc3QgcmFuZ2UgaW4gdGhlIHNlbGVjdGlvbi4gTGFzdCByYW5nZSBpcyB0aGUgb25lIHdoaWNoIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvcmFuZ2V+UmFuZ2UjZW5kIGVuZH0KICAgICAqIHBvc2l0aW9uIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvcG9zaXRpb25+UG9zaXRpb24jaXNBZnRlciBpcyBhZnRlcn0gZW5kIHBvc2l0aW9uIG9mIGFsbCBvdGhlciByYW5nZXMgKG5vdCB0byBjb25mdXNlCiAgICAgKiB3aXRoIHRoZSBsYXN0IHJhbmdlIGFkZGVkIHRvIHRoZSBzZWxlY3Rpb24pLiBSZXR1cm5zIGBudWxsYCBpZiBubyByYW5nZXMgYXJlIGFkZGVkIHRvIHNlbGVjdGlvbi4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7bW9kdWxlOmVuZ2luZS92aWV3L3JhbmdlflJhbmdlfG51bGx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0TGFzdFJhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMYXN0UmFuZ2UoKSB7CiAgICAgIHZhciBsYXN0ID0gbnVsbDsKCiAgICAgIHZhciBfaXRlcmF0b3IzID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5fcmFuZ2VzKSwKICAgICAgICAgIF9zdGVwMzsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IzLnMoKTsgIShfc3RlcDMgPSBfaXRlcmF0b3IzLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciByYW5nZSA9IF9zdGVwMy52YWx1ZTsKCiAgICAgICAgICBpZiAoIWxhc3QgfHwgcmFuZ2UuZW5kLmlzQWZ0ZXIobGFzdC5lbmQpKSB7CiAgICAgICAgICAgIGxhc3QgPSByYW5nZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjMuZigpOwogICAgICB9CgogICAgICByZXR1cm4gbGFzdCA/IGxhc3QuY2xvbmUoKSA6IG51bGw7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgY29weSBvZiB0aGUgZmlyc3QgcG9zaXRpb24gaW4gdGhlIHNlbGVjdGlvbi4gRmlyc3QgcG9zaXRpb24gaXMgdGhlIHBvc2l0aW9uIHRoYXQKICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvcG9zaXRpb25+UG9zaXRpb24jaXNCZWZvcmUgaXMgYmVmb3JlfSBhbnkgb3RoZXIgcG9zaXRpb24gaW4gdGhlIHNlbGVjdGlvbiByYW5nZXMuCiAgICAgKiBSZXR1cm5zIGBudWxsYCBpZiBubyByYW5nZXMgYXJlIGFkZGVkIHRvIHNlbGVjdGlvbi4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7bW9kdWxlOmVuZ2luZS92aWV3L3Bvc2l0aW9uflBvc2l0aW9ufG51bGx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Rmlyc3RQb3NpdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Rmlyc3RQb3NpdGlvbigpIHsKICAgICAgdmFyIGZpcnN0UmFuZ2UgPSB0aGlzLmdldEZpcnN0UmFuZ2UoKTsKICAgICAgcmV0dXJuIGZpcnN0UmFuZ2UgPyBmaXJzdFJhbmdlLnN0YXJ0LmNsb25lKCkgOiBudWxsOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGNvcHkgb2YgdGhlIGxhc3QgcG9zaXRpb24gaW4gdGhlIHNlbGVjdGlvbi4gTGFzdCBwb3NpdGlvbiBpcyB0aGUgcG9zaXRpb24gdGhhdAogICAgICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9wb3NpdGlvbn5Qb3NpdGlvbiNpc0FmdGVyIGlzIGFmdGVyfSBhbnkgb3RoZXIgcG9zaXRpb24gaW4gdGhlIHNlbGVjdGlvbiByYW5nZXMuCiAgICAgKiBSZXR1cm5zIGBudWxsYCBpZiBubyByYW5nZXMgYXJlIGFkZGVkIHRvIHNlbGVjdGlvbi4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7bW9kdWxlOmVuZ2luZS92aWV3L3Bvc2l0aW9uflBvc2l0aW9ufG51bGx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0TGFzdFBvc2l0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMYXN0UG9zaXRpb24oKSB7CiAgICAgIHZhciBsYXN0UmFuZ2UgPSB0aGlzLmdldExhc3RSYW5nZSgpOwogICAgICByZXR1cm4gbGFzdFJhbmdlID8gbGFzdFJhbmdlLmVuZC5jbG9uZSgpIDogbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2tzIHdoZXRoZXIsIHRoaXMgc2VsZWN0aW9uIGlzIGVxdWFsIHRvIGdpdmVuIHNlbGVjdGlvbi4gU2VsZWN0aW9ucyBhcmUgZXF1YWwgaWYgdGhleSBoYXZlIHNhbWUgZGlyZWN0aW9ucywKICAgICAqIHNhbWUgbnVtYmVyIG9mIHJhbmdlcyBhbmQgYWxsIHJhbmdlcyBmcm9tIG9uZSBzZWxlY3Rpb24gZXF1YWwgdG8gYSByYW5nZSBmcm9tIG90aGVyIHNlbGVjdGlvbi4KICAgICAqCiAgICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9zZWxlY3Rpb25+U2VsZWN0aW9ufG1vZHVsZTplbmdpbmUvdmlldy9kb2N1bWVudHNlbGVjdGlvbn5Eb2N1bWVudFNlbGVjdGlvbn0gb3RoZXJTZWxlY3Rpb24KICAgICAqIFNlbGVjdGlvbiB0byBjb21wYXJlIHdpdGguCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gYHRydWVgIGlmIHNlbGVjdGlvbnMgYXJlIGVxdWFsLCBgZmFsc2VgIG90aGVyd2lzZS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpc0VxdWFsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0VxdWFsKG90aGVyU2VsZWN0aW9uKSB7CiAgICAgIGlmICh0aGlzLmlzRmFrZSAhPSBvdGhlclNlbGVjdGlvbi5pc0Zha2UpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzRmFrZSAmJiB0aGlzLmZha2VTZWxlY3Rpb25MYWJlbCAhPSBvdGhlclNlbGVjdGlvbi5mYWtlU2VsZWN0aW9uTGFiZWwpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnJhbmdlQ291bnQgIT0gb3RoZXJTZWxlY3Rpb24ucmFuZ2VDb3VudCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnJhbmdlQ291bnQgPT09IDApIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmFuY2hvci5pc0VxdWFsKG90aGVyU2VsZWN0aW9uLmFuY2hvcikgfHwgIXRoaXMuZm9jdXMuaXNFcXVhbChvdGhlclNlbGVjdGlvbi5mb2N1cykpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciBfaXRlcmF0b3I0ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5fcmFuZ2VzKSwKICAgICAgICAgIF9zdGVwNDsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3I0LnMoKTsgIShfc3RlcDQgPSBfaXRlcmF0b3I0Lm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciB0aGlzUmFuZ2UgPSBfc3RlcDQudmFsdWU7CiAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCiAgICAgICAgICB2YXIgX2l0ZXJhdG9yNSA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG90aGVyU2VsZWN0aW9uLl9yYW5nZXMpLAogICAgICAgICAgICAgIF9zdGVwNTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjUucygpOyAhKF9zdGVwNSA9IF9pdGVyYXRvcjUubigpKS5kb25lOykgewogICAgICAgICAgICAgIHZhciBvdGhlclJhbmdlID0gX3N0ZXA1LnZhbHVlOwoKICAgICAgICAgICAgICBpZiAodGhpc1JhbmdlLmlzRXF1YWwob3RoZXJSYW5nZSkpIHsKICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjUuZShlcnIpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2l0ZXJhdG9yNS5mKCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I0LmYoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrcyB3aGV0aGVyIHRoaXMgc2VsZWN0aW9uIGlzIHNpbWlsYXIgdG8gZ2l2ZW4gc2VsZWN0aW9uLiBTZWxlY3Rpb25zIGFyZSBzaW1pbGFyIGlmIHRoZXkgaGF2ZSBzYW1lIGRpcmVjdGlvbnMsIHNhbWUKICAgICAqIG51bWJlciBvZiByYW5nZXMsIGFuZCBhbGwge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9yYW5nZX5SYW5nZSNnZXRUcmltbWVkIHRyaW1tZWR9IHJhbmdlcyBmcm9tIG9uZSBzZWxlY3Rpb24gYXJlCiAgICAgKiBlcXVhbCB0byBhbnkgdHJpbW1lZCByYW5nZSBmcm9tIG90aGVyIHNlbGVjdGlvbi4KICAgICAqCiAgICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9zZWxlY3Rpb25+U2VsZWN0aW9ufG1vZHVsZTplbmdpbmUvdmlldy9kb2N1bWVudHNlbGVjdGlvbn5Eb2N1bWVudFNlbGVjdGlvbn0gb3RoZXJTZWxlY3Rpb24KICAgICAqIFNlbGVjdGlvbiB0byBjb21wYXJlIHdpdGguCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gYHRydWVgIGlmIHNlbGVjdGlvbnMgYXJlIHNpbWlsYXIsIGBmYWxzZWAgb3RoZXJ3aXNlLgogICAgICovCgogIH0sIHsKICAgIGtleTogImlzU2ltaWxhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNTaW1pbGFyKG90aGVyU2VsZWN0aW9uKSB7CiAgICAgIGlmICh0aGlzLmlzQmFja3dhcmQgIT0gb3RoZXJTZWxlY3Rpb24uaXNCYWNrd2FyZCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdmFyIG51bU9mUmFuZ2VzQSA9IGNvdW50KHRoaXMuZ2V0UmFuZ2VzKCkpOwogICAgICB2YXIgbnVtT2ZSYW5nZXNCID0gY291bnQob3RoZXJTZWxlY3Rpb24uZ2V0UmFuZ2VzKCkpOyAvLyBJZiBzZWxlY3Rpb25zIGhhdmUgZGlmZmVyZW50IG51bWJlciBvZiByYW5nZXMsIHRoZXkgY2Fubm90IGJlIHNpbWlsYXIuCgogICAgICBpZiAobnVtT2ZSYW5nZXNBICE9IG51bU9mUmFuZ2VzQikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyBJZiBib3RoIHNlbGVjdGlvbnMgaGF2ZSBubyByYW5nZXMsIHRoZXkgYXJlIHNpbWlsYXIuCgoKICAgICAgaWYgKG51bU9mUmFuZ2VzQSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gLy8gQ2hlY2sgaWYgZWFjaCByYW5nZSBpbiBvbmUgc2VsZWN0aW9uIGhhcyBhIHNpbWlsYXIgcmFuZ2UgaW4gb3RoZXIgc2VsZWN0aW9uLgoKCiAgICAgIHZhciBfaXRlcmF0b3I2ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5nZXRSYW5nZXMoKSksCiAgICAgICAgICBfc3RlcDY7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yNi5zKCk7ICEoX3N0ZXA2ID0gX2l0ZXJhdG9yNi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgcmFuZ2VBID0gX3N0ZXA2LnZhbHVlOwogICAgICAgICAgcmFuZ2VBID0gcmFuZ2VBLmdldFRyaW1tZWQoKTsKICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlOwoKICAgICAgICAgIHZhciBfaXRlcmF0b3I3ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIob3RoZXJTZWxlY3Rpb24uZ2V0UmFuZ2VzKCkpLAogICAgICAgICAgICAgIF9zdGVwNzsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjcucygpOyAhKF9zdGVwNyA9IF9pdGVyYXRvcjcubigpKS5kb25lOykgewogICAgICAgICAgICAgIHZhciByYW5nZUIgPSBfc3RlcDcudmFsdWU7CiAgICAgICAgICAgICAgcmFuZ2VCID0gcmFuZ2VCLmdldFRyaW1tZWQoKTsKCiAgICAgICAgICAgICAgaWYgKHJhbmdlQS5zdGFydC5pc0VxdWFsKHJhbmdlQi5zdGFydCkgJiYgcmFuZ2VBLmVuZC5pc0VxdWFsKHJhbmdlQi5lbmQpKSB7CiAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gLy8gRm9yIGByYW5nZUFgLCBuZWl0aGVyIHJhbmdlIGluIGBvdGhlclNlbGVjdGlvbmAgd2FzIHNpbWlsYXIuIFNvIHNlbGVjdGlvbnMgYXJlIG5vdCBzaW1pbGFyLgoKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3I3LmUoZXJyKTsKICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjcuZigpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0gLy8gVGhlcmUgd2VyZSBubyByYW5nZXMgdGhhdCB3ZXJlbid0IG1hdGNoZWQuIFNlbGVjdGlvbnMgYXJlIHNpbWlsYXIuCgogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I2LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I2LmYoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIHNlbGVjdGVkIGVsZW1lbnQuIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50IEVsZW1lbnR9IGlzIGNvbnNpZGVyZWQgYXMgc2VsZWN0ZWQgaWYgdGhlcmUgaXMgb25seQogICAgICogb25lIHJhbmdlIGluIHRoZSBzZWxlY3Rpb24sIGFuZCB0aGF0IHJhbmdlIGNvbnRhaW5zIGV4YWN0bHkgb25lIGVsZW1lbnQuCiAgICAgKiBSZXR1cm5zIGBudWxsYCBpZiB0aGVyZSBpcyBubyBzZWxlY3RlZCBlbGVtZW50LgogICAgICoKICAgICAqIEByZXR1cm5zIHttb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50fG51bGx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0U2VsZWN0ZWRFbGVtZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTZWxlY3RlZEVsZW1lbnQoKSB7CiAgICAgIGlmICh0aGlzLnJhbmdlQ291bnQgIT09IDEpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuZ2V0Rmlyc3RSYW5nZSgpLmdldENvbnRhaW5lZEVsZW1lbnQoKTsKICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGlzIHNlbGVjdGlvbidzIHJhbmdlcyBhbmQgZGlyZWN0aW9uIHRvIHRoZSBzcGVjaWZpZWQgbG9jYXRpb24gYmFzZWQgb24gdGhlIGdpdmVuCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3NlbGVjdGlvbn5TZWxlY3RhYmxlIHNlbGVjdGFibGV9LgogICAgICoKICAgICAqCQkvLyBTZXRzIHNlbGVjdGlvbiB0byB0aGUgZ2l2ZW4gcmFuZ2UuCiAgICAgKgkJY29uc3QgcmFuZ2UgPSB3cml0ZXIuY3JlYXRlUmFuZ2UoIHN0YXJ0LCBlbmQgKTsKICAgICAqCQlzZWxlY3Rpb24uc2V0VG8oIHJhbmdlICk7CiAgICAgKgogICAgICoJCS8vIFNldHMgc2VsZWN0aW9uIHRvIGdpdmVuIHJhbmdlcy4KICAgICAqIAkJY29uc3QgcmFuZ2VzID0gWyB3cml0ZXIuY3JlYXRlUmFuZ2UoIHN0YXJ0MSwgZW5kMiApLCB3cml0ZXIuY3JlYXRlUmFuZ2UoIHN0YXIyLCBlbmQyICkgXTsKICAgICAqCQlzZWxlY3Rpb24uc2V0VG8oIHJhbmdlICk7CiAgICAgKgogICAgICoJCS8vIFNldHMgc2VsZWN0aW9uIHRvIHRoZSBvdGhlciBzZWxlY3Rpb24uCiAgICAgKgkJY29uc3Qgb3RoZXJTZWxlY3Rpb24gPSB3cml0ZXIuY3JlYXRlU2VsZWN0aW9uKCk7CiAgICAgKgkJc2VsZWN0aW9uLnNldFRvKCBvdGhlclNlbGVjdGlvbiApOwogICAgICoKICAgICAqCSAJLy8gU2V0cyBzZWxlY3Rpb24gdG8gY29udGVudHMgb2YgRG9jdW1lbnRTZWxlY3Rpb24uCiAgICAgKgkJc2VsZWN0aW9uLnNldFRvKCBlZGl0b3IuZWRpdGluZy52aWV3LmRvY3VtZW50LnNlbGVjdGlvbiApOwogICAgICoKICAgICAqIAkJLy8gU2V0cyBjb2xsYXBzZWQgc2VsZWN0aW9uIGF0IHRoZSBnaXZlbiBwb3NpdGlvbi4KICAgICAqCQljb25zdCBwb3NpdGlvbiA9IHdyaXRlci5jcmVhdGVQb3NpdGlvbkF0KCByb290LCBwYXRoICk7CiAgICAgKgkJc2VsZWN0aW9uLnNldFRvKCBwb3NpdGlvbiApOwogICAgICoKICAgICAqIAkJLy8gU2V0cyBjb2xsYXBzZWQgc2VsZWN0aW9uIGF0IHRoZSBwb3NpdGlvbiBvZiBnaXZlbiBpdGVtIGFuZCBvZmZzZXQuCiAgICAgKgkJc2VsZWN0aW9uLnNldFRvKCBwYXJhZ3JhcGgsIG9mZnNldCApOwogICAgICoKICAgICAqIENyZWF0ZXMgYSByYW5nZSBpbnNpZGUgYW4ge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnQgZWxlbWVudH0gd2hpY2ggc3RhcnRzIGJlZm9yZSB0aGUgZmlyc3QgY2hpbGQgb2YKICAgICAqIHRoYXQgZWxlbWVudCBhbmQgZW5kcyBhZnRlciB0aGUgbGFzdCBjaGlsZCBvZiB0aGF0IGVsZW1lbnQuCiAgICAgKgogICAgICoJCXNlbGVjdGlvbi5zZXRUbyggcGFyYWdyYXBoLCAnaW4nICk7CiAgICAgKgogICAgICogQ3JlYXRlcyBhIHJhbmdlIG9uIGFuIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvaXRlbX5JdGVtIGl0ZW19IHdoaWNoIHN0YXJ0cyBiZWZvcmUgdGhlIGl0ZW0gYW5kIGVuZHMganVzdCBhZnRlciB0aGUgaXRlbS4KICAgICAqCiAgICAgKgkJc2VsZWN0aW9uLnNldFRvKCBwYXJhZ3JhcGgsICdvbicgKTsKICAgICAqCiAgICAgKiAJCS8vIENsZWFycyBzZWxlY3Rpb24uIFJlbW92ZXMgYWxsIHJhbmdlcy4KICAgICAqCQlzZWxlY3Rpb24uc2V0VG8oIG51bGwgKTsKICAgICAqCiAgICAgKiBgU2VsZWN0aW9uI3NldFRvKClgIG1ldGhvZCBhbGxvdyBwYXNzaW5nIGFkZGl0aW9uYWwgb3B0aW9ucyAoYGJhY2t3YXJkYCwgYGZha2VgIGFuZCBgbGFiZWxgKSBhcyB0aGUgbGFzdCBhcmd1bWVudC4KICAgICAqCiAgICAgKgkJLy8gU2V0cyBzZWxlY3Rpb24gYXMgYmFja3dhcmQuCiAgICAgKgkJc2VsZWN0aW9uLnNldFRvKCByYW5nZSwgeyBiYWNrd2FyZDogdHJ1ZSB9ICk7CiAgICAgKgogICAgICogRmFrZSBzZWxlY3Rpb24gZG9lcyBub3QgcmVuZGVyIGFzIGJyb3dzZXIgbmF0aXZlIHNlbGVjdGlvbiBvdmVyIHNlbGVjdGVkIGVsZW1lbnRzIGFuZCBpcyBoaWRkZW4gdG8gdGhlIHVzZXIuCiAgICAgKiBUaGlzIHdheSwgbm8gbmF0aXZlIHNlbGVjdGlvbiBVSSBhcnRpZmFjdHMgYXJlIGRpc3BsYXllZCB0byB0aGUgdXNlciBhbmQgc2VsZWN0aW9uIG92ZXIgZWxlbWVudHMgY2FuIGJlCiAgICAgKiByZXByZXNlbnRlZCBpbiBvdGhlciB3YXksIGZvciBleGFtcGxlIGJ5IGFwcGx5aW5nIHByb3BlciBDU1MgY2xhc3MuCiAgICAgKgogICAgICogQWRkaXRpb25hbGx5IGZha2UncyBzZWxlY3Rpb24gbGFiZWwgY2FuIGJlIHByb3ZpZGVkLiBJdCB3aWxsIGJlIHVzZWQgdG8gZGVzY3JpYmUgZmFrZSBzZWxlY3Rpb24gaW4gRE9NCiAgICAgKiAoYW5kIGJlICBwcm9wZXJseSBoYW5kbGVkIGJ5IHNjcmVlbiByZWFkZXJzKS4KICAgICAqCiAgICAgKgkJLy8gQ3JlYXRlcyBmYWtlIHNlbGVjdGlvbiB3aXRoIGxhYmVsLgogICAgICoJCXNlbGVjdGlvbi5zZXRUbyggcmFuZ2UsIHsgZmFrZTogdHJ1ZSwgbGFiZWw6ICdmb28nIH0gKTsKICAgICAqCiAgICAgKiBAZmlyZXMgY2hhbmdlCiAgICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9zZWxlY3Rpb25+U2VsZWN0YWJsZX0gc2VsZWN0YWJsZQogICAgICogQHBhcmFtIHtOdW1iZXJ8J2JlZm9yZSd8J2VuZCd8J2FmdGVyJ3wnb24nfCdpbid9IFtwbGFjZU9yT2Zmc2V0XSBTZXRzIHBsYWNlIG9yIG9mZnNldCBvZiB0aGUgc2VsZWN0aW9uLgogICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXQogICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5iYWNrd2FyZF0gU2V0cyB0aGlzIHNlbGVjdGlvbiBpbnN0YW5jZSB0byBiZSBiYWNrd2FyZC4KICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuZmFrZV0gU2V0cyB0aGlzIHNlbGVjdGlvbiBpbnN0YW5jZSB0byBiZSBtYXJrZWQgYXMgYGZha2VgLgogICAgICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLmxhYmVsXSBMYWJlbCBmb3IgdGhlIGZha2Ugc2VsZWN0aW9uLgogICAgICovCgogIH0sIHsKICAgIGtleTogInNldFRvIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRUbyhzZWxlY3RhYmxlLCBwbGFjZU9yT2Zmc2V0LCBvcHRpb25zKSB7CiAgICAgIGlmIChzZWxlY3RhYmxlID09PSBudWxsKSB7CiAgICAgICAgdGhpcy5fc2V0UmFuZ2VzKFtdKTsKCiAgICAgICAgdGhpcy5fc2V0RmFrZU9wdGlvbnMocGxhY2VPck9mZnNldCk7CiAgICAgIH0gZWxzZSBpZiAoc2VsZWN0YWJsZSBpbnN0YW5jZW9mIFNlbGVjdGlvbiB8fCBzZWxlY3RhYmxlIGluc3RhbmNlb2YgRG9jdW1lbnRTZWxlY3Rpb24pIHsKICAgICAgICB0aGlzLl9zZXRSYW5nZXMoc2VsZWN0YWJsZS5nZXRSYW5nZXMoKSwgc2VsZWN0YWJsZS5pc0JhY2t3YXJkKTsKCiAgICAgICAgdGhpcy5fc2V0RmFrZU9wdGlvbnMoewogICAgICAgICAgZmFrZTogc2VsZWN0YWJsZS5pc0Zha2UsCiAgICAgICAgICBsYWJlbDogc2VsZWN0YWJsZS5mYWtlU2VsZWN0aW9uTGFiZWwKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChzZWxlY3RhYmxlIGluc3RhbmNlb2YgUmFuZ2UpIHsKICAgICAgICB0aGlzLl9zZXRSYW5nZXMoW3NlbGVjdGFibGVdLCBwbGFjZU9yT2Zmc2V0ICYmIHBsYWNlT3JPZmZzZXQuYmFja3dhcmQpOwoKICAgICAgICB0aGlzLl9zZXRGYWtlT3B0aW9ucyhwbGFjZU9yT2Zmc2V0KTsKICAgICAgfSBlbHNlIGlmIChzZWxlY3RhYmxlIGluc3RhbmNlb2YgUG9zaXRpb24pIHsKICAgICAgICB0aGlzLl9zZXRSYW5nZXMoW25ldyBSYW5nZShzZWxlY3RhYmxlKV0pOwoKICAgICAgICB0aGlzLl9zZXRGYWtlT3B0aW9ucyhwbGFjZU9yT2Zmc2V0KTsKICAgICAgfSBlbHNlIGlmIChzZWxlY3RhYmxlIGluc3RhbmNlb2YgTm9kZSkgewogICAgICAgIHZhciBiYWNrd2FyZCA9ICEhb3B0aW9ucyAmJiAhIW9wdGlvbnMuYmFja3dhcmQ7CiAgICAgICAgdmFyIHJhbmdlOwoKICAgICAgICBpZiAocGxhY2VPck9mZnNldCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAvKioKICAgICAgICAgICAqIHNlbGVjdGlvbi5zZXRUbyByZXF1aXJlcyB0aGUgc2Vjb25kIHBhcmFtZXRlciB3aGVuIHRoZSBmaXJzdCBwYXJhbWV0ZXIgaXMgYSBub2RlLgogICAgICAgICAgICoKICAgICAgICAgICAqIEBlcnJvciB2aWV3LXNlbGVjdGlvbi1zZXR0by1yZXF1aXJlZC1zZWNvbmQtcGFyYW1ldGVyCiAgICAgICAgICAgKi8KICAgICAgICAgIHRocm93IG5ldyBDS0VkaXRvckVycm9yKCd2aWV3LXNlbGVjdGlvbi1zZXR0by1yZXF1aXJlZC1zZWNvbmQtcGFyYW1ldGVyJywgdGhpcyk7CiAgICAgICAgfSBlbHNlIGlmIChwbGFjZU9yT2Zmc2V0ID09ICdpbicpIHsKICAgICAgICAgIHJhbmdlID0gUmFuZ2UuX2NyZWF0ZUluKHNlbGVjdGFibGUpOwogICAgICAgIH0gZWxzZSBpZiAocGxhY2VPck9mZnNldCA9PSAnb24nKSB7CiAgICAgICAgICByYW5nZSA9IFJhbmdlLl9jcmVhdGVPbihzZWxlY3RhYmxlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmFuZ2UgPSBuZXcgUmFuZ2UoUG9zaXRpb24uX2NyZWF0ZUF0KHNlbGVjdGFibGUsIHBsYWNlT3JPZmZzZXQpKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuX3NldFJhbmdlcyhbcmFuZ2VdLCBiYWNrd2FyZCk7CgogICAgICAgIHRoaXMuX3NldEZha2VPcHRpb25zKG9wdGlvbnMpOwogICAgICB9IGVsc2UgaWYgKGlzSXRlcmFibGUoc2VsZWN0YWJsZSkpIHsKICAgICAgICAvLyBXZSBhc3N1bWUgdGhhdCB0aGUgc2VsZWN0YWJsZSBpcyBhbiBpdGVyYWJsZSBvZiByYW5nZXMuCiAgICAgICAgLy8gQXJyYXkuZnJvbSgpIGlzIHVzZWQgdG8gcHJldmVudCBzZXR0aW5nIHJhbmdlcyB0byB0aGUgb2xkIGl0ZXJhYmxlCiAgICAgICAgdGhpcy5fc2V0UmFuZ2VzKHNlbGVjdGFibGUsIHBsYWNlT3JPZmZzZXQgJiYgcGxhY2VPck9mZnNldC5iYWNrd2FyZCk7CgogICAgICAgIHRoaXMuX3NldEZha2VPcHRpb25zKHBsYWNlT3JPZmZzZXQpOwogICAgICB9IGVsc2UgewogICAgICAgIC8qKgogICAgICAgICAqIENhbm5vdCBzZXQgc2VsZWN0aW9uIHRvIGdpdmVuIHBsYWNlLgogICAgICAgICAqCiAgICAgICAgICogQGVycm9yIHZpZXctc2VsZWN0aW9uLXNldHRvLW5vdC1zZWxlY3RhYmxlCiAgICAgICAgICovCiAgICAgICAgdGhyb3cgbmV3IENLRWRpdG9yRXJyb3IoJ3ZpZXctc2VsZWN0aW9uLXNldHRvLW5vdC1zZWxlY3RhYmxlJywgdGhpcyk7CiAgICAgIH0KCiAgICAgIHRoaXMuZmlyZSgnY2hhbmdlJyk7CiAgICB9CiAgICAvKioKICAgICAqIE1vdmVzIHtAbGluayAjZm9jdXN9IHRvIHRoZSBzcGVjaWZpZWQgbG9jYXRpb24uCiAgICAgKgogICAgICogVGhlIGxvY2F0aW9uIGNhbiBiZSBzcGVjaWZpZWQgaW4gdGhlIHNhbWUgZm9ybSBhcyB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3ZpZXd+VmlldyNjcmVhdGVQb3NpdGlvbkF0IHZpZXcuY3JlYXRlUG9zaXRpb25BdCgpfQogICAgICogcGFyYW1ldGVycy4KICAgICAqCiAgICAgKiBAZmlyZXMgY2hhbmdlCiAgICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9pdGVtfkl0ZW18bW9kdWxlOmVuZ2luZS92aWV3L3Bvc2l0aW9uflBvc2l0aW9ufSBpdGVtT3JQb3NpdGlvbgogICAgICogQHBhcmFtIHtOdW1iZXJ8J2VuZCd8J2JlZm9yZSd8J2FmdGVyJ30gW29mZnNldF0gT2Zmc2V0IG9yIG9uZSBvZiB0aGUgZmxhZ3MuIFVzZWQgb25seSB3aGVuCiAgICAgKiBmaXJzdCBwYXJhbWV0ZXIgaXMgYSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2l0ZW1+SXRlbSB2aWV3IGl0ZW19LgogICAgICovCgogIH0sIHsKICAgIGtleTogInNldEZvY3VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGb2N1cyhpdGVtT3JQb3NpdGlvbiwgb2Zmc2V0KSB7CiAgICAgIGlmICh0aGlzLmFuY2hvciA9PT0gbnVsbCkgewogICAgICAgIC8qKgogICAgICAgICAqIENhbm5vdCBzZXQgc2VsZWN0aW9uIGZvY3VzIGlmIHRoZXJlIGFyZSBubyByYW5nZXMgaW4gc2VsZWN0aW9uLgogICAgICAgICAqCiAgICAgICAgICogQGVycm9yIHZpZXctc2VsZWN0aW9uLXNldGZvY3VzLW5vLXJhbmdlcwogICAgICAgICAqLwogICAgICAgIHRocm93IG5ldyBDS0VkaXRvckVycm9yKCd2aWV3LXNlbGVjdGlvbi1zZXRmb2N1cy1uby1yYW5nZXMnLCB0aGlzKTsKICAgICAgfQoKICAgICAgdmFyIG5ld0ZvY3VzID0gUG9zaXRpb24uX2NyZWF0ZUF0KGl0ZW1PclBvc2l0aW9uLCBvZmZzZXQpOwoKICAgICAgaWYgKG5ld0ZvY3VzLmNvbXBhcmVXaXRoKHRoaXMuZm9jdXMpID09ICdzYW1lJykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGFuY2hvciA9IHRoaXMuYW5jaG9yOwoKICAgICAgdGhpcy5fcmFuZ2VzLnBvcCgpOwoKICAgICAgaWYgKG5ld0ZvY3VzLmNvbXBhcmVXaXRoKGFuY2hvcikgPT0gJ2JlZm9yZScpIHsKICAgICAgICB0aGlzLl9hZGRSYW5nZShuZXcgUmFuZ2UobmV3Rm9jdXMsIGFuY2hvciksIHRydWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuX2FkZFJhbmdlKG5ldyBSYW5nZShhbmNob3IsIG5ld0ZvY3VzKSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZmlyZSgnY2hhbmdlJyk7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrcyB3aGV0aGVyIHRoaXMgb2JqZWN0IGlzIG9mIHRoZSBnaXZlbiB0eXBlLgogICAgICoKICAgICAqCQlzZWxlY3Rpb24uaXMoICdzZWxlY3Rpb24nICk7IC8vIC0+IHRydWUKICAgICAqCQlzZWxlY3Rpb24uaXMoICd2aWV3OnNlbGVjdGlvbicgKTsgLy8gLT4gdHJ1ZQogICAgICoKICAgICAqCQlzZWxlY3Rpb24uaXMoICdtb2RlbDpzZWxlY3Rpb24nICk7IC8vIC0+IGZhbHNlCiAgICAgKgkJc2VsZWN0aW9uLmlzKCAnZWxlbWVudCcgKTsgLy8gLT4gZmFsc2UKICAgICAqCQlzZWxlY3Rpb24uaXMoICdyYW5nZScgKTsgLy8gLT4gZmFsc2UKICAgICAqCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZSNpcyBDaGVjayB0aGUgZW50aXJlIGxpc3Qgb2YgdmlldyBvYmplY3RzfSB3aGljaCBpbXBsZW1lbnQgdGhlIGBpcygpYCBtZXRob2QuCiAgICAgKgogICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKICAgICAqIEByZXR1cm5zIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogImlzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpcyh0eXBlKSB7CiAgICAgIHJldHVybiB0eXBlID09PSAnc2VsZWN0aW9uJyB8fCB0eXBlID09PSAndmlldzpzZWxlY3Rpb24nOwogICAgfQogICAgLyoqCiAgICAgKiBSZXBsYWNlcyBhbGwgcmFuZ2VzIHRoYXQgd2VyZSBhZGRlZCB0byB0aGUgc2VsZWN0aW9uIHdpdGggZ2l2ZW4gYXJyYXkgb2YgcmFuZ2VzLiBMYXN0IHJhbmdlIG9mIHRoZSBhcnJheQogICAgICogaXMgdHJlYXRlZCBsaWtlIHRoZSBsYXN0IGFkZGVkIHJhbmdlIGFuZCBpcyB1c2VkIHRvIHNldCB7QGxpbmsgI2FuY2hvciBhbmNob3J9IGFuZCB7QGxpbmsgI2ZvY3VzIGZvY3VzfS4KICAgICAqIEFjY2VwdHMgYSBmbGFnIGRlc2NyaWJpbmcgaW4gd2hpY2ggd2F5IHRoZSBzZWxlY3Rpb24gaXMgbWFkZS4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHBhcmFtIHtJdGVyYWJsZS48bW9kdWxlOmVuZ2luZS92aWV3L3JhbmdlflJhbmdlPn0gbmV3UmFuZ2VzIEl0ZXJhYmxlIG9iamVjdCBvZiByYW5nZXMgdG8gc2V0LgogICAgICogQHBhcmFtIHtCb29sZWFufSBbaXNMYXN0QmFja3dhcmQ9ZmFsc2VdIEZsYWcgZGVzY3JpYmluZyBpZiBsYXN0IGFkZGVkIHJhbmdlIHdhcyBzZWxlY3RlZCBmb3J3YXJkIC0gZnJvbSBzdGFydCB0byBlbmQKICAgICAqIChgZmFsc2VgKSBvciBiYWNrd2FyZCAtIGZyb20gZW5kIHRvIHN0YXJ0IChgdHJ1ZWApLiBEZWZhdWx0cyB0byBgZmFsc2VgLgogICAgICovCgogIH0sIHsKICAgIGtleTogIl9zZXRSYW5nZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRSYW5nZXMobmV3UmFuZ2VzKSB7CiAgICAgIHZhciBpc0xhc3RCYWNrd2FyZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIC8vIE5ldyByYW5nZXMgc2hvdWxkIGJlIGNvcGllZCB0byBwcmV2ZW50IHJlbW92aW5nIHRoZW0gYnkgc2V0dGluZyB0aGVtIHRvIGBbXWAgZmlyc3QuCiAgICAgIC8vIE9ubHkgYXBwbGllcyB0byBzaXR1YXRpb25zIHdoZW4gc2VsZWN0aW9uIGlzIHNldCB0byB0aGUgc2FtZSBzZWxlY3Rpb24gb3Igc2FtZSBzZWxlY3Rpb24ncyByYW5nZXMuCiAgICAgIG5ld1JhbmdlcyA9IEFycmF5LmZyb20obmV3UmFuZ2VzKTsKICAgICAgdGhpcy5fcmFuZ2VzID0gW107CgogICAgICB2YXIgX2l0ZXJhdG9yOCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG5ld1JhbmdlcyksCiAgICAgICAgICBfc3RlcDg7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yOC5zKCk7ICEoX3N0ZXA4ID0gX2l0ZXJhdG9yOC5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgcmFuZ2UgPSBfc3RlcDgudmFsdWU7CgogICAgICAgICAgdGhpcy5fYWRkUmFuZ2UocmFuZ2UpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yOC5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yOC5mKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuX2xhc3RSYW5nZUJhY2t3YXJkID0gISFpc0xhc3RCYWNrd2FyZDsKICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGlzIHNlbGVjdGlvbiBpbnN0YW5jZSB0byBiZSBtYXJrZWQgYXMgYGZha2VgLiBBIGZha2Ugc2VsZWN0aW9uIGRvZXMgbm90IHJlbmRlciBhcyBicm93c2VyIG5hdGl2ZSBzZWxlY3Rpb24KICAgICAqIG92ZXIgc2VsZWN0ZWQgZWxlbWVudHMgYW5kIGlzIGhpZGRlbiB0byB0aGUgdXNlci4gVGhpcyB3YXksIG5vIG5hdGl2ZSBzZWxlY3Rpb24gVUkgYXJ0aWZhY3RzIGFyZSBkaXNwbGF5ZWQgdG8KICAgICAqIHRoZSB1c2VyIGFuZCBzZWxlY3Rpb24gb3ZlciBlbGVtZW50cyBjYW4gYmUgcmVwcmVzZW50ZWQgaW4gb3RoZXIgd2F5LCBmb3IgZXhhbXBsZSBieSBhcHBseWluZyBwcm9wZXIgQ1NTIGNsYXNzLgogICAgICoKICAgICAqIEFkZGl0aW9uYWxseSBmYWtlJ3Mgc2VsZWN0aW9uIGxhYmVsIGNhbiBiZSBwcm92aWRlZC4gSXQgd2lsbCBiZSB1c2VkIHRvIGRlc2NyaWJlIGZha2Ugc2VsZWN0aW9uIGluIERPTSAoYW5kIGJlCiAgICAgKiBwcm9wZXJseSBoYW5kbGVkIGJ5IHNjcmVlbiByZWFkZXJzKS4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSBPcHRpb25zLgogICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5mYWtlXSBJZiBzZXQgdG8gdHJ1ZSBzZWxlY3Rpb24gd2lsbCBiZSBtYXJrZWQgYXMgYGZha2VgLgogICAgICogQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLmxhYmVsPScnXSBGYWtlIHNlbGVjdGlvbiBsYWJlbC4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfc2V0RmFrZU9wdGlvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRGYWtlT3B0aW9ucygpIHsKICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwogICAgICB0aGlzLl9pc0Zha2UgPSAhIW9wdGlvbnMuZmFrZTsKICAgICAgdGhpcy5fZmFrZVNlbGVjdGlvbkxhYmVsID0gb3B0aW9ucy5mYWtlID8gb3B0aW9ucy5sYWJlbCB8fCAnJyA6ICcnOwogICAgfQogICAgLyoqCiAgICAgKiBBZGRzIGEgcmFuZ2UgdG8gdGhlIHNlbGVjdGlvbi4gQWRkZWQgcmFuZ2UgaXMgY29waWVkLiBUaGlzIG1lYW5zIHRoYXQgcGFzc2VkIHJhbmdlIGlzIG5vdCBzYXZlZCBpbiB0aGUKICAgICAqIHNlbGVjdGlvbiBpbnN0YW5jZSBhbmQgeW91IGNhbiBzYWZlbHkgb3BlcmF0ZSBvbiBpdC4KICAgICAqCiAgICAgKiBBY2NlcHRzIGEgZmxhZyBkZXNjcmliaW5nIGluIHdoaWNoIHdheSB0aGUgc2VsZWN0aW9uIGlzIG1hZGUgLSBwYXNzZWQgcmFuZ2UgbWlnaHQgYmUgc2VsZWN0ZWQgZnJvbQogICAgICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9yYW5nZX5SYW5nZSNzdGFydCBzdGFydH0gdG8ge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9yYW5nZX5SYW5nZSNlbmQgZW5kfQogICAgICogb3IgZnJvbSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3JhbmdlflJhbmdlI2VuZCBlbmR9IHRvIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvcmFuZ2V+UmFuZ2Ujc3RhcnQgc3RhcnR9LgogICAgICogVGhlIGZsYWcgaXMgdXNlZCB0byBzZXQge0BsaW5rICNhbmNob3IgYW5jaG9yfSBhbmQge0BsaW5rICNmb2N1cyBmb2N1c30gcHJvcGVydGllcy4KICAgICAqCiAgICAgKiBUaHJvd3Mge0BsaW5rIG1vZHVsZTp1dGlscy9ja2VkaXRvcmVycm9yfkNLRWRpdG9yRXJyb3IgQ0tFZGl0b3JFcnJvcn0gYHZpZXctc2VsZWN0aW9uLXJhbmdlLWludGVyc2VjdHNgIGlmIGFkZGVkIHJhbmdlIGludGVyc2VjdHMKICAgICAqIHdpdGggcmFuZ2VzIGFscmVhZHkgc3RvcmVkIGluIFNlbGVjdGlvbiBpbnN0YW5jZS4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQGZpcmVzIGNoYW5nZQogICAgICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvcmFuZ2V+UmFuZ2V9IHJhbmdlCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtpc0JhY2t3YXJkXQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9hZGRSYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZFJhbmdlKHJhbmdlKSB7CiAgICAgIHZhciBpc0JhY2t3YXJkID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKCiAgICAgIGlmICghKHJhbmdlIGluc3RhbmNlb2YgUmFuZ2UpKSB7CiAgICAgICAgLyoqCiAgICAgICAgICogU2VsZWN0aW9uIHJhbmdlIHNldCB0byBhbiBvYmplY3QgdGhhdCBpcyBub3QgYW4gaW5zdGFuY2Ugb2Yge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9yYW5nZX5SYW5nZX0uCiAgICAgICAgICoKICAgICAgICAgKiBAZXJyb3Igdmlldy1zZWxlY3Rpb24tYWRkLXJhbmdlLW5vdC1yYW5nZQogICAgICAgICAqLwogICAgICAgIHRocm93IG5ldyBDS0VkaXRvckVycm9yKCd2aWV3LXNlbGVjdGlvbi1hZGQtcmFuZ2Utbm90LXJhbmdlJywgdGhpcyk7CiAgICAgIH0KCiAgICAgIHRoaXMuX3B1c2hSYW5nZShyYW5nZSk7CgogICAgICB0aGlzLl9sYXN0UmFuZ2VCYWNrd2FyZCA9ICEhaXNCYWNrd2FyZDsKICAgIH0KICAgIC8qKgogICAgICogQWRkcyByYW5nZSB0byBzZWxlY3Rpb24gLSBjcmVhdGVzIGNvcHkgb2YgZ2l2ZW4gcmFuZ2Ugc28gaXQgY2FuIGJlIHNhZmVseSB1c2VkIGFuZCBtb2RpZmllZC4KICAgICAqCiAgICAgKiBUaHJvd3Mge0BsaW5rIG1vZHVsZTp1dGlscy9ja2VkaXRvcmVycm9yfkNLRWRpdG9yRXJyb3IgQ0tFZGl0b3JFcnJvcn0gYHZpZXctc2VsZWN0aW9uLXJhbmdlLWludGVyc2VjdHNgIGlmIGFkZGVkIHJhbmdlIGludGVyc2VjdHMKICAgICAqIHdpdGggcmFuZ2VzIGFscmVhZHkgc3RvcmVkIGluIHNlbGVjdGlvbiBpbnN0YW5jZS4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvcmFuZ2V+UmFuZ2V9IHJhbmdlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3B1c2hSYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3B1c2hSYW5nZShyYW5nZSkgewogICAgICB2YXIgX2l0ZXJhdG9yOSA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuX3JhbmdlcyksCiAgICAgICAgICBfc3RlcDk7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yOS5zKCk7ICEoX3N0ZXA5ID0gX2l0ZXJhdG9yOS5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgc3RvcmVkUmFuZ2UgPSBfc3RlcDkudmFsdWU7CgogICAgICAgICAgaWYgKHJhbmdlLmlzSW50ZXJzZWN0aW5nKHN0b3JlZFJhbmdlKSkgewogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogVHJ5aW5nIHRvIGFkZCBhIHJhbmdlIHRoYXQgaW50ZXJzZWN0cyB3aXRoIGFub3RoZXIgcmFuZ2UgZnJvbSBzZWxlY3Rpb24uCiAgICAgICAgICAgICAqCiAgICAgICAgICAgICAqIEBlcnJvciB2aWV3LXNlbGVjdGlvbi1yYW5nZS1pbnRlcnNlY3RzCiAgICAgICAgICAgICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L3JhbmdlflJhbmdlfSBhZGRlZFJhbmdlIFJhbmdlIHRoYXQgd2FzIGFkZGVkIHRvIHRoZSBzZWxlY3Rpb24uCiAgICAgICAgICAgICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L3JhbmdlflJhbmdlfSBpbnRlcnNlY3RpbmdSYW5nZSBSYW5nZSBmcm9tIHNlbGVjdGlvbiB0aGF0IGludGVyc2VjdHMgd2l0aCBgYWRkZWRSYW5nZWAuCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB0aHJvdyBuZXcgQ0tFZGl0b3JFcnJvcigndmlldy1zZWxlY3Rpb24tcmFuZ2UtaW50ZXJzZWN0cycsIHRoaXMsIHsKICAgICAgICAgICAgICBhZGRlZFJhbmdlOiByYW5nZSwKICAgICAgICAgICAgICBpbnRlcnNlY3RpbmdSYW5nZTogc3RvcmVkUmFuZ2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I5LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I5LmYoKTsKICAgICAgfQoKICAgICAgdGhpcy5fcmFuZ2VzLnB1c2gobmV3IFJhbmdlKHJhbmdlLnN0YXJ0LCByYW5nZS5lbmQpKTsKICAgIH0KICAgIC8qKgogICAgICogRmlyZWQgd2hlbmV2ZXIgc2VsZWN0aW9uIHJhbmdlcyBhcmUgY2hhbmdlZCB0aHJvdWdoIHtAbGluayB+U2VsZWN0aW9uIFNlbGVjdGlvbiBBUEl9LgogICAgICoKICAgICAqIEBldmVudCBjaGFuZ2UKICAgICAqLwoKICB9XSk7CgogIHJldHVybiBTZWxlY3Rpb247Cn0oKTsKCmV4cG9ydCB7IFNlbGVjdGlvbiBhcyBkZWZhdWx0IH07Cm1peChTZWxlY3Rpb24sIEVtaXR0ZXJNaXhpbik7Ci8qKgogKiBBbiBlbnRpdHkgdGhhdCBpcyB1c2VkIHRvIHNldCBzZWxlY3Rpb24uCiAqCiAqIFNlZSBhbHNvIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvc2VsZWN0aW9uflNlbGVjdGlvbiNzZXRUb30KICoKICogQHR5cGVkZWYgewogKiAgICBtb2R1bGU6ZW5naW5lL3ZpZXcvc2VsZWN0aW9uflNlbGVjdGlvbnwKICogICAgbW9kdWxlOmVuZ2luZS92aWV3L2RvY3VtZW50c2VsZWN0aW9ufkRvY3VtZW50U2VsZWN0aW9ufAogKiAgICBtb2R1bGU6ZW5naW5lL3ZpZXcvcG9zaXRpb25+UG9zaXRpb258CiAqICAgIEl0ZXJhYmxlLjxtb2R1bGU6ZW5naW5lL3ZpZXcvcmFuZ2V+UmFuZ2U+fAogKiAgICBtb2R1bGU6ZW5naW5lL3ZpZXcvcmFuZ2V+UmFuZ2V8CiAqICAgIG1vZHVsZTplbmdpbmUvdmlldy9pdGVtfkl0ZW18CiAqICAgIG51bGwKICogfSBtb2R1bGU6ZW5naW5lL3ZpZXcvc2VsZWN0aW9uflNlbGVjdGFibGUKICov"},{"version":3,"sources":["/home/ekeberat/Yandex.Disk/Projelerim/BenimProjelerim/websitem/websitem-web/node_modules/@ckeditor/ckeditor5-engine/src/view/selection.js"],"names":["CKEditorError","Range","Position","mix","EmitterMixin","Node","count","isIterable","DocumentSelection","Selection","selectable","placeOrOffset","options","_ranges","_lastRangeBackward","_isFake","_fakeSelectionLabel","setTo","length","range","anchor","end","start","clone","focus","rangeCount","isCollapsed","editableElement","first","isBefore","last","isAfter","firstRange","getFirstRange","lastRange","getLastRange","otherSelection","isFake","fakeSelectionLabel","isEqual","thisRange","found","otherRange","isBackward","numOfRangesA","getRanges","numOfRangesB","rangeA","getTrimmed","rangeB","getContainedElement","_setRanges","_setFakeOptions","fake","label","backward","undefined","_createIn","_createOn","_createAt","fire","itemOrPosition","offset","newFocus","compareWith","pop","_addRange","type","newRanges","isLastBackward","Array","from","_pushRange","storedRange","isIntersecting","addedRange","intersectingRange","push"],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAEA,OAAOA,aAAP,MAA0B,6CAA1B;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,GAAP,MAAgB,mCAAhB;AACA,OAAOC,YAAP,MAAyB,4CAAzB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,KAAP,MAAkB,qCAAlB;AACA,OAAOC,UAAP,MAAuB,0CAAvB;AACA,OAAOC,iBAAP,MAA8B,qBAA9B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IACqBC,S;AACpB;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACC,uBAAyD;AAAA,QAA5CC,UAA4C,uEAA/B,IAA+B;AAAA,QAAzBC,aAAyB;AAAA,QAAVC,OAAU;;AAAA;;AACxD;AACF;AACA;AACA;AACA;AACA;AACE,SAAKC,OAAL,GAAe,EAAf;AAEA;AACF;AACA;AACA;AACA;AACA;;AACE,SAAKC,kBAAL,GAA0B,KAA1B;AAEA;AACF;AACA;AACA;AACA;AACA;;AACE,SAAKC,OAAL,GAAe,KAAf;AAEA;AACF;AACA;AACA;AACA;AACA;;AACE,SAAKC,mBAAL,GAA2B,EAA3B;AAEA,SAAKC,KAAL,CAAYP,UAAZ,EAAwBC,aAAxB,EAAuCC,OAAvC;AACA;AAED;AACD;AACA;AACA;AACA;AACA;;;;;SACC,eAAa;AACZ,aAAO,KAAKG,OAAZ;AACA;AAED;AACD;AACA;AACA;AACA;AACA;;;;SACC,eAAyB;AACxB,aAAO,KAAKC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","sourcesContent":["/**\n * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module engine/view/selection\n */\n\nimport CKEditorError from '@ckeditor/ckeditor5-utils/src/ckeditorerror';\nimport Range from './range';\nimport Position from './position';\nimport mix from '@ckeditor/ckeditor5-utils/src/mix';\nimport EmitterMixin from '@ckeditor/ckeditor5-utils/src/emittermixin';\nimport Node from './node';\nimport count from '@ckeditor/ckeditor5-utils/src/count';\nimport isIterable from '@ckeditor/ckeditor5-utils/src/isiterable';\nimport DocumentSelection from './documentselection';\n\n/**\n * Class representing an arbirtary selection in the view.\n * See also {@link module:engine/view/documentselection~DocumentSelection}.\n *\n * New selection instances can be created via the constructor or one these methods:\n *\n * * {@link module:engine/view/view~View#createSelection `View#createSelection()`},\n * * {@link module:engine/view/upcastwriter~UpcastWriter#createSelection `UpcastWriter#createSelection()`}.\n *\n * A selection can consist of {@link module:engine/view/range~Range ranges} that can be set by using\n * the {@link module:engine/view/selection~Selection#setTo `Selection#setTo()`} method.\n */\nexport default class Selection {\n\t/**\n\t * Creates new selection instance.\n\t *\n\t * **Note**: The selection constructor is available as a factory method:\n\t *\n\t * * {@link module:engine/view/view~View#createSelection `View#createSelection()`},\n\t * * {@link module:engine/view/upcastwriter~UpcastWriter#createSelection `UpcastWriter#createSelection()`}.\n\t *\n\t * \t\t// Creates empty selection without ranges.\n\t *\t\tconst selection = writer.createSelection();\n\t *\n\t *\t\t// Creates selection at the given range.\n\t *\t\tconst range = writer.createRange( start, end );\n\t *\t\tconst selection = writer.createSelection( range );\n\t *\n\t *\t\t// Creates selection at the given ranges\n\t * \t\tconst ranges = [ writer.createRange( start1, end2 ), writer.createRange( star2, end2 ) ];\n\t *\t\tconst selection = writer.createSelection( ranges );\n\t *\n\t *\t\t// Creates selection from the other selection.\n\t *\t\tconst otherSelection = writer.createSelection();\n\t *\t\tconst selection = writer.createSelection( otherSelection );\n\t *\n\t *\t\t// Creates selection from the document selection.\n\t *\t\tconst selection = writer.createSelection( editor.editing.view.document.selection );\n\t *\n\t * \t\t// Creates selection at the given position.\n\t *\t\tconst position = writer.createPositionFromPath( root, path );\n\t *\t\tconst selection = writer.createSelection( position );\n\t *\n\t *\t\t// Creates collapsed selection at the position of given item and offset.\n\t *\t\tconst paragraph = writer.createContainerElement( 'paragraph' );\n\t *\t\tconst selection = writer.createSelection( paragraph, offset );\n\t *\n\t *\t\t// Creates a range inside an {@link module:engine/view/element~Element element} which starts before the\n\t *\t\t// first child of that element and ends after the last child of that element.\n\t *\t\tconst selection = writer.createSelection( paragraph, 'in' );\n\t *\n\t *\t\t// Creates a range on an {@link module:engine/view/item~Item item} which starts before the item and ends\n\t *\t\t// just after the item.\n\t *\t\tconst selection = writer.createSelection( paragraph, 'on' );\n\t *\n\t * `Selection`'s constructor allow passing additional options (`backward`, `fake` and `label`) as the last argument.\n\t *\n\t *\t\t// Creates backward selection.\n\t *\t\tconst selection = writer.createSelection( range, { backward: true } );\n\t *\n\t * Fake selection does not render as browser native selection over selected elements and is hidden to the user.\n\t * This way, no native selection UI artifacts are displayed to the user and selection over elements can be\n\t * represented in other way, for example by applying proper CSS class.\n\t *\n\t * Additionally fake's selection label can be provided. It will be used to describe fake selection in DOM\n\t * (and be  properly handled by screen readers).\n\t *\n\t *\t\t// Creates fake selection with label.\n\t *\t\tconst selection = writer.createSelection( range, { fake: true, label: 'foo' } );\n\t *\n\t * @param {module:engine/view/selection~Selectable} [selectable=null]\n\t * @param {Number|'before'|'end'|'after'|'on'|'in'} [placeOrOffset] Offset or place when selectable is an `Item`.\n\t * @param {Object} [options]\n\t * @param {Boolean} [options.backward] Sets this selection instance to be backward.\n\t * @param {Boolean} [options.fake] Sets this selection instance to be marked as `fake`.\n\t * @param {String} [options.label] Label for the fake selection.\n\t */\n\tconstructor( selectable = null, placeOrOffset, options ) {\n\t\t/**\n\t\t * Stores all ranges that are selected.\n\t\t *\n\t\t * @protected\n\t\t * @member {Array.<module:engine/view/range~Range>}\n\t\t */\n\t\tthis._ranges = [];\n\n\t\t/**\n\t\t * Specifies whether the last added range was added as a backward or forward range.\n\t\t *\n\t\t * @protected\n\t\t * @member {Boolean}\n\t\t */\n\t\tthis._lastRangeBackward = false;\n\n\t\t/**\n\t\t * Specifies whether selection instance is fake.\n\t\t *\n\t\t * @private\n\t\t * @member {Boolean}\n\t\t */\n\t\tthis._isFake = false;\n\n\t\t/**\n\t\t * Fake selection's label.\n\t\t *\n\t\t * @private\n\t\t * @member {String}\n\t\t */\n\t\tthis._fakeSelectionLabel = '';\n\n\t\tthis.setTo( selectable, placeOrOffset, options );\n\t}\n\n\t/**\n\t * Returns true if selection instance is marked as `fake`.\n\t *\n\t * @see #setTo\n\t * @returns {Boolean}\n\t */\n\tget isFake() {\n\t\treturn this._isFake;\n\t}\n\n\t/**\n\t * Returns fake selection label.\n\t *\n\t * @see #setTo\n\t * @returns {String}\n\t */\n\tget fakeSelectionLabel() {\n\t\treturn this._fakeSelectionLabel;\n\t}\n\n\t/**\n\t * Selection anchor. Anchor may be described as a position where the selection starts. Together with\n\t * {@link #focus focus} they define the direction of selection, which is important\n\t * when expanding/shrinking selection. Anchor is always the start or end of the most recent added range.\n\t * It may be a bit unintuitive when there are multiple ranges in selection.\n\t *\n\t * @see #focus\n\t * @type {module:engine/view/position~Position}\n\t */\n\tget anchor() {\n\t\tif ( !this._ranges.length ) {\n\t\t\treturn null;\n\t\t}\n\t\tconst range = this._ranges[ this._ranges.length - 1 ];\n\t\tconst anchor = this._lastRangeBackward ? range.end : range.start;\n\n\t\treturn anchor.clone();\n\t}\n\n\t/**\n\t * Selection focus. Focus is a position where the selection ends.\n\t *\n\t * @see #anchor\n\t * @type {module:engine/view/position~Position}\n\t */\n\tget focus() {\n\t\tif ( !this._ranges.length ) {\n\t\t\treturn null;\n\t\t}\n\t\tconst range = this._ranges[ this._ranges.length - 1 ];\n\t\tconst focus = this._lastRangeBackward ? range.start : range.end;\n\n\t\treturn focus.clone();\n\t}\n\n\t/**\n\t * Returns whether the selection is collapsed. Selection is collapsed when there is exactly one range which is\n\t * collapsed.\n\t *\n\t * @type {Boolean}\n\t */\n\tget isCollapsed() {\n\t\treturn this.rangeCount === 1 && this._ranges[ 0 ].isCollapsed;\n\t}\n\n\t/**\n\t * Returns number of ranges in selection.\n\t *\n\t * @type {Number}\n\t */\n\tget rangeCount() {\n\t\treturn this._ranges.length;\n\t}\n\n\t/**\n\t * Specifies whether the {@link #focus} precedes {@link #anchor}.\n\t *\n\t * @type {Boolean}\n\t */\n\tget isBackward() {\n\t\treturn !this.isCollapsed && this._lastRangeBackward;\n\t}\n\n\t/**\n\t * {@link module:engine/view/editableelement~EditableElement EditableElement} instance that contains this selection, or `null`\n\t * if the selection is not inside an editable element.\n\t *\n\t * @type {module:engine/view/editableelement~EditableElement|null}\n\t */\n\tget editableElement() {\n\t\tif ( this.anchor ) {\n\t\t\treturn this.anchor.editableElement;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns an iterable that contains copies of all ranges added to the selection.\n\t *\n\t * @returns {Iterable.<module:engine/view/range~Range>}\n\t */\n\t* getRanges() {\n\t\tfor ( const range of this._ranges ) {\n\t\t\tyield range.clone();\n\t\t}\n\t}\n\n\t/**\n\t * Returns copy of the first range in the selection. First range is the one which\n\t * {@link module:engine/view/range~Range#start start} position {@link module:engine/view/position~Position#isBefore is before} start\n\t * position of all other ranges (not to confuse with the first range added to the selection).\n\t * Returns `null` if no ranges are added to selection.\n\t *\n\t * @returns {module:engine/view/range~Range|null}\n\t */\n\tgetFirstRange() {\n\t\tlet first = null;\n\n\t\tfor ( const range of this._ranges ) {\n\t\t\tif ( !first || range.start.isBefore( first.start ) ) {\n\t\t\t\tfirst = range;\n\t\t\t}\n\t\t}\n\n\t\treturn first ? first.clone() : null;\n\t}\n\n\t/**\n\t * Returns copy of the last range in the selection. Last range is the one which {@link module:engine/view/range~Range#end end}\n\t * position {@link module:engine/view/position~Position#isAfter is after} end position of all other ranges (not to confuse\n\t * with the last range added to the selection). Returns `null` if no ranges are added to selection.\n\t *\n\t * @returns {module:engine/view/range~Range|null}\n\t */\n\tgetLastRange() {\n\t\tlet last = null;\n\n\t\tfor ( const range of this._ranges ) {\n\t\t\tif ( !last || range.end.isAfter( last.end ) ) {\n\t\t\t\tlast = range;\n\t\t\t}\n\t\t}\n\n\t\treturn last ? last.clone() : null;\n\t}\n\n\t/**\n\t * Returns copy of the first position in the selection. First position is the position that\n\t * {@link module:engine/view/position~Position#isBefore is before} any other position in the selection ranges.\n\t * Returns `null` if no ranges are added to selection.\n\t *\n\t * @returns {module:engine/view/position~Position|null}\n\t */\n\tgetFirstPosition() {\n\t\tconst firstRange = this.getFirstRange();\n\n\t\treturn firstRange ? firstRange.start.clone() : null;\n\t}\n\n\t/**\n\t * Returns copy of the last position in the selection. Last position is the position that\n\t * {@link module:engine/view/position~Position#isAfter is after} any other position in the selection ranges.\n\t * Returns `null` if no ranges are added to selection.\n\t *\n\t * @returns {module:engine/view/position~Position|null}\n\t */\n\tgetLastPosition() {\n\t\tconst lastRange = this.getLastRange();\n\n\t\treturn lastRange ? lastRange.end.clone() : null;\n\t}\n\n\t/**\n\t * Checks whether, this selection is equal to given selection. Selections are equal if they have same directions,\n\t * same number of ranges and all ranges from one selection equal to a range from other selection.\n\t *\n\t * @param {module:engine/view/selection~Selection|module:engine/view/documentselection~DocumentSelection} otherSelection\n\t * Selection to compare with.\n\t * @returns {Boolean} `true` if selections are equal, `false` otherwise.\n\t */\n\tisEqual( otherSelection ) {\n\t\tif ( this.isFake != otherSelection.isFake ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( this.isFake && this.fakeSelectionLabel != otherSelection.fakeSelectionLabel ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( this.rangeCount != otherSelection.rangeCount ) {\n\t\t\treturn false;\n\t\t} else if ( this.rangeCount === 0 ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( !this.anchor.isEqual( otherSelection.anchor ) || !this.focus.isEqual( otherSelection.focus ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor ( const thisRange of this._ranges ) {\n\t\t\tlet found = false;\n\n\t\t\tfor ( const otherRange of otherSelection._ranges ) {\n\t\t\t\tif ( thisRange.isEqual( otherRange ) ) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( !found ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Checks whether this selection is similar to given selection. Selections are similar if they have same directions, same\n\t * number of ranges, and all {@link module:engine/view/range~Range#getTrimmed trimmed} ranges from one selection are\n\t * equal to any trimmed range from other selection.\n\t *\n\t * @param {module:engine/view/selection~Selection|module:engine/view/documentselection~DocumentSelection} otherSelection\n\t * Selection to compare with.\n\t * @returns {Boolean} `true` if selections are similar, `false` otherwise.\n\t */\n\tisSimilar( otherSelection ) {\n\t\tif ( this.isBackward != otherSelection.isBackward ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst numOfRangesA = count( this.getRanges() );\n\t\tconst numOfRangesB = count( otherSelection.getRanges() );\n\n\t\t// If selections have different number of ranges, they cannot be similar.\n\t\tif ( numOfRangesA != numOfRangesB ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// If both selections have no ranges, they are similar.\n\t\tif ( numOfRangesA == 0 ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Check if each range in one selection has a similar range in other selection.\n\t\tfor ( let rangeA of this.getRanges() ) {\n\t\t\trangeA = rangeA.getTrimmed();\n\n\t\t\tlet found = false;\n\n\t\t\tfor ( let rangeB of otherSelection.getRanges() ) {\n\t\t\t\trangeB = rangeB.getTrimmed();\n\n\t\t\t\tif ( rangeA.start.isEqual( rangeB.start ) && rangeA.end.isEqual( rangeB.end ) ) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// For `rangeA`, neither range in `otherSelection` was similar. So selections are not similar.\n\t\t\tif ( !found ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// There were no ranges that weren't matched. Selections are similar.\n\t\treturn true;\n\t}\n\n\t/**\n\t * Returns the selected element. {@link module:engine/view/element~Element Element} is considered as selected if there is only\n\t * one range in the selection, and that range contains exactly one element.\n\t * Returns `null` if there is no selected element.\n\t *\n\t * @returns {module:engine/view/element~Element|null}\n\t */\n\tgetSelectedElement() {\n\t\tif ( this.rangeCount !== 1 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.getFirstRange().getContainedElement();\n\t}\n\n\t/**\n\t * Sets this selection's ranges and direction to the specified location based on the given\n\t * {@link module:engine/view/selection~Selectable selectable}.\n\t *\n\t *\t\t// Sets selection to the given range.\n\t *\t\tconst range = writer.createRange( start, end );\n\t *\t\tselection.setTo( range );\n\t *\n\t *\t\t// Sets selection to given ranges.\n\t * \t\tconst ranges = [ writer.createRange( start1, end2 ), writer.createRange( star2, end2 ) ];\n\t *\t\tselection.setTo( range );\n\t *\n\t *\t\t// Sets selection to the other selection.\n\t *\t\tconst otherSelection = writer.createSelection();\n\t *\t\tselection.setTo( otherSelection );\n\t *\n\t *\t \t// Sets selection to contents of DocumentSelection.\n\t *\t\tselection.setTo( editor.editing.view.document.selection );\n\t *\n\t * \t\t// Sets collapsed selection at the given position.\n\t *\t\tconst position = writer.createPositionAt( root, path );\n\t *\t\tselection.setTo( position );\n\t *\n\t * \t\t// Sets collapsed selection at the position of given item and offset.\n\t *\t\tselection.setTo( paragraph, offset );\n\t *\n\t * Creates a range inside an {@link module:engine/view/element~Element element} which starts before the first child of\n\t * that element and ends after the last child of that element.\n\t *\n\t *\t\tselection.setTo( paragraph, 'in' );\n\t *\n\t * Creates a range on an {@link module:engine/view/item~Item item} which starts before the item and ends just after the item.\n\t *\n\t *\t\tselection.setTo( paragraph, 'on' );\n\t *\n\t * \t\t// Clears selection. Removes all ranges.\n\t *\t\tselection.setTo( null );\n\t *\n\t * `Selection#setTo()` method allow passing additional options (`backward`, `fake` and `label`) as the last argument.\n\t *\n\t *\t\t// Sets selection as backward.\n\t *\t\tselection.setTo( range, { backward: true } );\n\t *\n\t * Fake selection does not render as browser native selection over selected elements and is hidden to the user.\n\t * This way, no native selection UI artifacts are displayed to the user and selection over elements can be\n\t * represented in other way, for example by applying proper CSS class.\n\t *\n\t * Additionally fake's selection label can be provided. It will be used to describe fake selection in DOM\n\t * (and be  properly handled by screen readers).\n\t *\n\t *\t\t// Creates fake selection with label.\n\t *\t\tselection.setTo( range, { fake: true, label: 'foo' } );\n\t *\n\t * @fires change\n\t * @param {module:engine/view/selection~Selectable} selectable\n\t * @param {Number|'before'|'end'|'after'|'on'|'in'} [placeOrOffset] Sets place or offset of the selection.\n\t * @param {Object} [options]\n\t * @param {Boolean} [options.backward] Sets this selection instance to be backward.\n\t * @param {Boolean} [options.fake] Sets this selection instance to be marked as `fake`.\n\t * @param {String} [options.label] Label for the fake selection.\n\t */\n\tsetTo( selectable, placeOrOffset, options ) {\n\t\tif ( selectable === null ) {\n\t\t\tthis._setRanges( [] );\n\t\t\tthis._setFakeOptions( placeOrOffset );\n\t\t} else if ( selectable instanceof Selection || selectable instanceof DocumentSelection ) {\n\t\t\tthis._setRanges( selectable.getRanges(), selectable.isBackward );\n\t\t\tthis._setFakeOptions( { fake: selectable.isFake, label: selectable.fakeSelectionLabel } );\n\t\t} else if ( selectable instanceof Range ) {\n\t\t\tthis._setRanges( [ selectable ], placeOrOffset && placeOrOffset.backward );\n\t\t\tthis._setFakeOptions( placeOrOffset );\n\t\t} else if ( selectable instanceof Position ) {\n\t\t\tthis._setRanges( [ new Range( selectable ) ] );\n\t\t\tthis._setFakeOptions( placeOrOffset );\n\t\t} else if ( selectable instanceof Node ) {\n\t\t\tconst backward = !!options && !!options.backward;\n\t\t\tlet range;\n\n\t\t\tif ( placeOrOffset === undefined ) {\n\t\t\t\t/**\n\t\t\t\t * selection.setTo requires the second parameter when the first parameter is a node.\n\t\t\t\t *\n\t\t\t\t * @error view-selection-setto-required-second-parameter\n\t\t\t\t */\n\t\t\t\tthrow new CKEditorError( 'view-selection-setto-required-second-parameter', this );\n\t\t\t} else if ( placeOrOffset == 'in' ) {\n\t\t\t\trange = Range._createIn( selectable );\n\t\t\t} else if ( placeOrOffset == 'on' ) {\n\t\t\t\trange = Range._createOn( selectable );\n\t\t\t} else {\n\t\t\t\trange = new Range( Position._createAt( selectable, placeOrOffset ) );\n\t\t\t}\n\n\t\t\tthis._setRanges( [ range ], backward );\n\t\t\tthis._setFakeOptions( options );\n\t\t} else if ( isIterable( selectable ) ) {\n\t\t\t// We assume that the selectable is an iterable of ranges.\n\t\t\t// Array.from() is used to prevent setting ranges to the old iterable\n\t\t\tthis._setRanges( selectable, placeOrOffset && placeOrOffset.backward );\n\t\t\tthis._setFakeOptions( placeOrOffset );\n\t\t} else {\n\t\t\t/**\n\t\t\t * Cannot set selection to given place.\n\t\t\t *\n\t\t\t * @error view-selection-setto-not-selectable\n\t\t\t */\n\t\t\tthrow new CKEditorError( 'view-selection-setto-not-selectable', this );\n\t\t}\n\n\t\tthis.fire( 'change' );\n\t}\n\n\t/**\n\t * Moves {@link #focus} to the specified location.\n\t *\n\t * The location can be specified in the same form as {@link module:engine/view/view~View#createPositionAt view.createPositionAt()}\n\t * parameters.\n\t *\n\t * @fires change\n\t * @param {module:engine/view/item~Item|module:engine/view/position~Position} itemOrPosition\n\t * @param {Number|'end'|'before'|'after'} [offset] Offset or one of the flags. Used only when\n\t * first parameter is a {@link module:engine/view/item~Item view item}.\n\t */\n\tsetFocus( itemOrPosition, offset ) {\n\t\tif ( this.anchor === null ) {\n\t\t\t/**\n\t\t\t * Cannot set selection focus if there are no ranges in selection.\n\t\t\t *\n\t\t\t * @error view-selection-setfocus-no-ranges\n\t\t\t */\n\t\t\tthrow new CKEditorError( 'view-selection-setfocus-no-ranges', this );\n\t\t}\n\n\t\tconst newFocus = Position._createAt( itemOrPosition, offset );\n\n\t\tif ( newFocus.compareWith( this.focus ) == 'same' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst anchor = this.anchor;\n\n\t\tthis._ranges.pop();\n\n\t\tif ( newFocus.compareWith( anchor ) == 'before' ) {\n\t\t\tthis._addRange( new Range( newFocus, anchor ), true );\n\t\t} else {\n\t\t\tthis._addRange( new Range( anchor, newFocus ) );\n\t\t}\n\n\t\tthis.fire( 'change' );\n\t}\n\n\t/**\n\t * Checks whether this object is of the given type.\n\t *\n\t *\t\tselection.is( 'selection' ); // -> true\n\t *\t\tselection.is( 'view:selection' ); // -> true\n\t *\n\t *\t\tselection.is( 'model:selection' ); // -> false\n\t *\t\tselection.is( 'element' ); // -> false\n\t *\t\tselection.is( 'range' ); // -> false\n\t *\n\t * {@link module:engine/view/node~Node#is Check the entire list of view objects} which implement the `is()` method.\n\t *\n\t * @param {String} type\n\t * @returns {Boolean}\n\t */\n\tis( type ) {\n\t\treturn type === 'selection' || type === 'view:selection';\n\t}\n\n\t/**\n\t * Replaces all ranges that were added to the selection with given array of ranges. Last range of the array\n\t * is treated like the last added range and is used to set {@link #anchor anchor} and {@link #focus focus}.\n\t * Accepts a flag describing in which way the selection is made.\n\t *\n\t * @private\n\t * @param {Iterable.<module:engine/view/range~Range>} newRanges Iterable object of ranges to set.\n\t * @param {Boolean} [isLastBackward=false] Flag describing if last added range was selected forward - from start to end\n\t * (`false`) or backward - from end to start (`true`). Defaults to `false`.\n\t */\n\t_setRanges( newRanges, isLastBackward = false ) {\n\t\t// New ranges should be copied to prevent removing them by setting them to `[]` first.\n\t\t// Only applies to situations when selection is set to the same selection or same selection's ranges.\n\t\tnewRanges = Array.from( newRanges );\n\n\t\tthis._ranges = [];\n\n\t\tfor ( const range of newRanges ) {\n\t\t\tthis._addRange( range );\n\t\t}\n\n\t\tthis._lastRangeBackward = !!isLastBackward;\n\t}\n\n\t/**\n\t * Sets this selection instance to be marked as `fake`. A fake selection does not render as browser native selection\n\t * over selected elements and is hidden to the user. This way, no native selection UI artifacts are displayed to\n\t * the user and selection over elements can be represented in other way, for example by applying proper CSS class.\n\t *\n\t * Additionally fake's selection label can be provided. It will be used to describe fake selection in DOM (and be\n\t * properly handled by screen readers).\n\t *\n\t * @private\n\t * @param {Object} [options] Options.\n\t * @param {Boolean} [options.fake] If set to true selection will be marked as `fake`.\n\t * @param {String} [options.label=''] Fake selection label.\n\t */\n\t_setFakeOptions( options = {} ) {\n\t\tthis._isFake = !!options.fake;\n\t\tthis._fakeSelectionLabel = options.fake ? options.label || '' : '';\n\t}\n\n\t/**\n\t * Adds a range to the selection. Added range is copied. This means that passed range is not saved in the\n\t * selection instance and you can safely operate on it.\n\t *\n\t * Accepts a flag describing in which way the selection is made - passed range might be selected from\n\t * {@link module:engine/view/range~Range#start start} to {@link module:engine/view/range~Range#end end}\n\t * or from {@link module:engine/view/range~Range#end end} to {@link module:engine/view/range~Range#start start}.\n\t * The flag is used to set {@link #anchor anchor} and {@link #focus focus} properties.\n\t *\n\t * Throws {@link module:utils/ckeditorerror~CKEditorError CKEditorError} `view-selection-range-intersects` if added range intersects\n\t * with ranges already stored in Selection instance.\n\t *\n\t * @private\n\t * @fires change\n\t * @param {module:engine/view/range~Range} range\n\t * @param {Boolean} [isBackward]\n\t */\n\t_addRange( range, isBackward = false ) {\n\t\tif ( !( range instanceof Range ) ) {\n\t\t\t/**\n\t\t\t * Selection range set to an object that is not an instance of {@link module:engine/view/range~Range}.\n\t\t\t *\n\t\t\t * @error view-selection-add-range-not-range\n\t\t\t */\n\t\t\tthrow new CKEditorError(\n\t\t\t\t'view-selection-add-range-not-range',\n\t\t\t\tthis\n\t\t\t);\n\t\t}\n\n\t\tthis._pushRange( range );\n\t\tthis._lastRangeBackward = !!isBackward;\n\t}\n\n\t/**\n\t * Adds range to selection - creates copy of given range so it can be safely used and modified.\n\t *\n\t * Throws {@link module:utils/ckeditorerror~CKEditorError CKEditorError} `view-selection-range-intersects` if added range intersects\n\t * with ranges already stored in selection instance.\n\t *\n\t * @private\n\t * @param {module:engine/view/range~Range} range\n\t */\n\t_pushRange( range ) {\n\t\tfor ( const storedRange of this._ranges ) {\n\t\t\tif ( range.isIntersecting( storedRange ) ) {\n\t\t\t\t/**\n\t\t\t\t * Trying to add a range that intersects with another range from selection.\n\t\t\t\t *\n\t\t\t\t * @error view-selection-range-intersects\n\t\t\t\t * @param {module:engine/view/range~Range} addedRange Range that was added to the selection.\n\t\t\t\t * @param {module:engine/view/range~Range} intersectingRange Range from selection that intersects with `addedRange`.\n\t\t\t\t */\n\t\t\t\tthrow new CKEditorError(\n\t\t\t\t\t'view-selection-range-intersects',\n\t\t\t\t\tthis,\n\t\t\t\t\t{ addedRange: range, intersectingRange: storedRange }\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis._ranges.push( new Range( range.start, range.end ) );\n\t}\n\n\t/**\n\t * Fired whenever selection ranges are changed through {@link ~Selection Selection API}.\n\t *\n\t * @event change\n\t */\n}\n\nmix( Selection, EmitterMixin );\n\n/**\n * An entity that is used to set selection.\n *\n * See also {@link module:engine/view/selection~Selection#setTo}\n *\n * @typedef {\n *    module:engine/view/selection~Selection|\n *    module:engine/view/documentselection~DocumentSelection|\n *    module:engine/view/position~Position|\n *    Iterable.<module:engine/view/range~Range>|\n *    module:engine/view/range~Range|\n *    module:engine/view/item~Item|\n *    null\n * } module:engine/view/selection~Selectable\n */\n"]}]}